---
name: مقدمة في علم التشفير
goal: فهم إنشاء محفظة بيتكوين من منظور تشفيري
objectives:
  - تبسيط مصطلحات التشفير المتعلقة ببيتكوين.
  - إتقان إنشاء محفظة بيتكوين.
  - فهم هيكل محفظة بيتكوين.
  - فهم العناوين ومسارات الاشتقاق.
---

# رحلة في علم التشفير

هل أنت متحمس لبيتكوين؟ هل تتساءل كيف تعمل محفظة بيتكوين؟ استعد للانطلاق في رحلة شيقة في علم التشفير! سيقوم خبيرنا، لويك، بإرشادك خلال تفاصيل إنشاء محفظة بيتكوين، وكشف أسرار المصطلحات التقنية المخيفة مثل التجزئة، واشتقاق المفتاح، والمنحنيات البيضاوية.

لن يزودك هذا التدريب فقط بالمعرفة اللازمة لفهم هيكل محفظة بيتكوين، بل سيجهزك أيضًا للغوص بعمق في عالم التشفير المثير. فهل أنت مستعد للانطلاق في هذه الرحلة؟ انضم إلينا وحوّل فضولك إلى خبرة!

+++

# المقدمة

## مقدمة في علم التشفير

### هل هذا التدريب مناسب لك؟ نعم!

![مقدمة بواسطة روجزي](https://youtu.be/ul8zU5QWIXg)

نرحب بك في دورة التدريب الجديدة بعنوان "Crypto 301: مقدمة في علم التشفير ومحفظة HD"، التي يقودها الخبير نفسه، لويك موريل. ستغمرك هذه الدورة في عالم التشفير الساحر، الذي يعد العلم الأساسي في الرياضيات والذي يضمن تشفير وأمان بياناتك.

في حياتنا اليومية، وخاصة في عالم بيتكوين، يلعب التشفير دورًا حاسمًا. المفاهيم المتعلقة بالتشفير مثل المفاتيح الخاصة والعامة، والعناوين، ومسارات الاشتقاق، والبذرة، والعشوائية هي في قلب استخدام وإنشاء محفظة بيتكوين. طوال هذه الدورة، سيرشدك لويك بالتفصيل حول كيفية إنشاء المفاتيح الخاصة وكيفية ربطها بالعناوين. سيخصص لويك أيضًا ساعة لشرح التفاصيل الرياضية للمنحنيات البيضاوية، هذا المنحنى الرياضي المعقد. بالإضافة إلى ذلك، ستفهم لماذا يعد استخدام HMAC SHA512 مهمًا لتأمين محفظتك وما الفرق بين البذرة والعبارة المذكرة.

الهدف النهائي لهذا التدريب هو تمكينك من فهم العمليات التقنية لإنشاء محفظة HD والأساليب التشفيرية المستخدمة. على مر السنين، تطورت محافظ بيتكوين لتصبح أكثر سهولة في الاستخدام وأكثر أمانًا وموحدة بفضل مواصفات BIPs المحددة. سيساعدك لويك على فهم هذه المواصفات لفهم الخيارات التي اتخذها مطورو بيتكوين وعلماء التشفير. مثل جميع التدريبات التي تقدمها جامعتنا، هذا التدريب مجاني تمامًا ومفتوح المصدر. هذا يعني أنه يمكنك أخذه واستخدامه كما تشاء. نتطلع إلى استلام ملاحظاتك في نهاية هذه الدورة المثيرة.

### الكلمة لك، أستاذنا!

![مقدمة بواسطة لويك](https://youtu.be/mwuxXLk4Kws)

مرحبًا بالجميع، أنا لويك موريل، مرشدك في هذا الاستكشاف التقني للتشفير المستخدم في محافظ بيتكوين.

تبدأ رحلتنا بالغوص في أعماق وظائف التجزئة التشفيرية. سنحلل سويًا كيفية عمل SHA256 الأساسية ونستكشف مختلف الخوارزميات المخصصة للاشتقاق.

سنواصل مغامرتنا بفك رموز عالم التوقيعات الرقمية الغامض. ستكتشف كيف ينطبق سحر المنحنيات البيضاوية على هذه التوقيعات، وسنسلط الضوء على كيفية حساب المفتاح العام من المفتاح الخاص. وبالطبع، سنتناول أيضًا عملية التوقيع بالمفتاح الخاص.
بعد ذلك، سنعود في الزمن لنرى تطور محافظ البيتكوين، وسنغوص في مفهوم الانحراف والأرقام العشوائية. سنستعرض العبارة الذاكرية المشهورة، ونتعمق أيضًا في موضوع كلمات المرور. ستتاح لك حتى الفرصة لتجربة شيء فريد من نوعه من خلال إنشاء بذرة من خلال رمي النرد 128 مرة!

بفضل هذه الأسس القوية، سنكون جاهزين للجزء الحاسم: إنشاء محفظة البيتكوين. من ولادة البذرة والمفتاح الرئيسي، إلى دراسة المفاتيح الموسعة، واشتقاق أزواج المفاتيح الفرعية، سيتم تحليل كل خطوة. سنناقش أيضًا هيكل المحفظة ومسارات الاشتقاق.

وفي الختام، سنختتم رحلتنا بدراسة عناوين البيتكوين. سنشرح كيفية إنشائها وكيفية أداء دور أساسي في عمل محافظ البيتكوين.

انضم إلي في هذه الرحلة المثيرة، واستعد لاستكشاف عالم التشفير كما لم تفعل من قبل. اترك تصوراتك السابقة خارج الباب وافتح عقلك لطريقة جديدة لفهم البيتكوين وهيكله الأساسي.

# وظائف الهاش

## مقدمة لوظائف الهاش الرمزية المتعلقة بالبيتكوين

![2.1 - وظائف الهاش الرمزية](https://youtu.be/dvnGArYvVr8)

مرحبًا بك في جلسة اليوم المخصصة لغوص عميق في عالم الهاش الرمزي، الذي يعد حجر الزاوية الأساسي الأساسي لأمان بروتوكول البيتكوين. تخيل الهاش الرمزي كروبوت فك تشفير رمزي فائق الكفاءة يحول المعلومات بجميع الأحجام إلى بصمة رقمية فريدة وثابتة تسمى "هاش". خلال استكشافنا، سنصف ملف تعريف وظائف الهاش الرمزي، مسلطين الضوء على استخدامها في بروتوكول البيتكوين، وتحديد الأهداف المحددة التي يجب تحقيقها هذه الوظائف الرمزية.

![صورة](assets/image/section1/0.JPG)

يتطلب وصف ملف تعريف وظائف الهاش الرمزي فهم خاصيتين أساسيتين: عدم قابليتها للعكس ومقاومتها للتزوير. يشبه كل وظيفة هاش رمزية فريدة من نوعها فنانًا، ينتج "هاش" مميز لكل إدخال. حتى الفرشاة التي تنحرف قليلاً تغير بشكل كبير اللوحة النهائية، أي الهاش. تعمل هذه الوظائف كحراس رقميين، يتحققون من سلامة البرامج المحملة. خاصية حاسمة أخرى يتمتعون بها هي مقاومتهم للتصادمات. بالتأكيد، في عالم الهاش، التصادمات لا تمكن من الحدوث، ولكن وظيفة هاش رمزية ممتازة تقللها بشكل كبير. فمن الكأن كل هاش هو منزل في مدينة واسعة؛ على الرغم من العدد الهائل من المنازل، تضمن وظيفة هاش جيدة أن لكل منزل عنوان فريد.

![صورة](assets/image/section1/1.JPG)

دعنا نبحر الآن في مياه هاشات قديمة. يُعتبر SHA0 وSHA1 وMD5 الآن آثارًا قديمة في محيط الهاش الرمزي. غالبًا ما يتم تجنبها لأنها فقدت مقاومتها للتصادمات. يشرح مبدأ الأدراج لماذا، على الرغم من جهودنا الجادة، فإن تجنب التصادم غير ممكن بسبب قيود حجم الإخراج. من المهم أيضًا أن نلاحظ أن مقاومة الصورة الثانية تعتمد على مقاومة التصادمات. لكي تعتبر وظيفة هاش آمنة حقًا، يجب أن تقاوم التصادمات والصورة الثانية والصورة الأولى.

عنصر رئيسي في بروتوكول البيتكوين، وظيفة هاش SHA-256 هي قائد السفينة. تستخدم وظائف أخرى مثل SHA-512 للاشتقاق مع HMAC و PBKDF. بالإضافة إلى ذلك، يتم استخدام RIPMD160 لتقليل بصمة إلى 160 بت. عندما نتحدث عن HASH256 و HASH160، فإننا نشير إلى استخدام الهاش المزدوج مع SHA-256 و RIPMD. يعتبر استخدام HASH160 مفيدًا بشكل خاص حيث يسمح بأمان SHA-256 مع تقليل حجم البصمة.
لتلخيص الأمر، فإن الهدف النهائي لوظيفة التجزئة العملية هو تحويل المعلومات غير المحددة الحجم إلى بصمة ثابتة الحجم. ولكي تعتبر آمنة، يجب أن تتمتع بعدة قوى: عدم القابلية للعكس، ومقاومة التزوير، ومقاومة التصادم، ومقاومة الصورة الثانية.

في نهاية هذا الاستكشاف، قمنا بفك رموز وظائف التجزئة العملية، وأبرزنا استخدامها في بروتوكول بيتكوين، وفحصنا أهدافها المحددة. تعلمنا أنه من أجل اعتبارها آمنة، يجب أن تكون وظائف التجزئة مقاومة للصورة الأولى، والصورة الثانية، والتصادم، والتزوير. كما تناولنا مجموعة متنوعة من وظائف التجزئة المختلفة المستخدمة في بروتوكول بيتكوين. في جلستنا القادمة، سنتعمق في جوهر وظيفة التجزئة SHA256 ونكتشف الرياضيات الرائعة التي تمنحها خصائصها الفريدة.

## العملية الداخلية لـ SHA256

مرحبًا بك في استكمال رحلتنا المثيرة عبر المتاهات التشفيرية لوظيفة التجزئة. اليوم، سنكشف أسرار SHA256، وهي عملية معقدة ولكنها بارعة قدمناها في مناقشتنا السابقة حول وظائف التجزئة. دعنا نخوض خطوة أخرى في هذا المتاهة، بدءًا من التجهيز المسبق لـ SHA256. تخيل التجهيز المسبق كتحضير طبق لذيذ، حيث نضيف "بتات التعبئة" لجعل حجم مكوننا الرئيسي، المدخل، يصل إلى مضاعف مثالي من 512 بت. كل ذلك بهدف توليد بصمة 256 بت لذيذة من مكون ذو حجم متغير.

في هذه الوصفة التشفيرية، نلعب مع البتات، حيث يكون لدينا حجم رسالة أولية نسميها M. يتم احتجاز بت واحد للفاصل، في حين يتم استخدام P بت للتعبئة. بالإضافة إلى ذلك، نحجز 64 بت للمرحلة الثانية من التجهيز. يجب أن يكون المجموع مضاعفًا لـ 512 بت. إنها تشبه قليلاً التأكد من أن جميع المكونات تمتزج بشكل مثالي في طبقنا.

ننتقل الآن إلى المرحلة الثانية من التجهيز، والتي تنطوي على إضافة التمثيل الثنائي لحجم الرسالة الأولية، بالبتات. لهذا، نستخدم 64 بت محجوزة من الخطوة السابقة. نضيف أصفارًا لتجعل 64 بت لدينا متوازنة مع مدخلنا. ثم، ندمج الرسالة الأولية، بتات التعبئة، وتعبئة الحجم، مثل المكونات في الخلاط، للحصول على مدخلنا المتوازن.

الآن، نستعد للخطوات الأولى لمعالجة وظيفة SHA-256. مثل أي وصفة جيدة، نحتاج إلى بعض المكونات الأساسية، التي نسميها الثوابت ومتجهات البدء. متجهات البدء، من A إلى H، هي أول 32 بت من الأجزاء العشرية للجذور التربيعية لأول 8 أعداد أولية. الثوابت K، من 0 إلى 63، تمثل أول 32 بت من الأجزاء العشرية للجذور التكعيبية لأول 64 عدد أولي.

في إطار وظيفة الضغط، نستخدم عمليات محددة مثل XOR وAND وNOT. نعالج البتات واحدًا تلو الآخر وفقًا لترتيبها، باستخدام عامل XOR وجدول حقيقة. يتم استخدام عامل AND لإرجاع 1 فقط إذا كانت كل من المشغلين مساويتين لـ 1، ويتم استخدام عامل NOT لإرجاع القيمة المعاكسة للمشغل. نستخدم أيضًا عملية SHR لتحريك البتات إلى اليمين بعدد محدد.


أخيرًا، بعد فصل الإدخال المتوازن إلى كتل مختلفة من رسائل بت 512، نقوم بإجراء 64 جولة من الحسابات في وظيفة الضغط. مثل سباق الدراجات، كل لفة تحسن موقعنا. نضيف الحالة الوسيطة إلى الحالة الأولية لوظيفة الضغط بناءً على القسمة على 2^32. الإضافات في وظيفة الضغط هي إضافات القسمة على 2^32 للحفاظ على حجم المجاميع بحجم 32 بت.

لختام، نود أن نؤكد على الدور الحاسم للحسابات التي تتم في صناديق CH، MAJ، σ0، وσ1. هذه العمليات، بين غيرها، هي الحراس الذين يضمنون قوة وقوة وظيفة التجزئة SHA256 ضد الهجمات، مما يجعلها الخيار المفضل لتأمين العديد من الأنظمة الرقمية، خاصة داخل بروتوكول بيتكوين. من الواضح أن الجمال في SHA256، على الرغم من تعقيدها، يكمن في قوتها في العثور على الإدخال من الهاش، بينما التحقق من الهاش لإدخال معين هو عملية بسيطة ميكانيكية.

## الخوارزميات المستخدمة للاشتقاق

![الخوارزميات المستخدمة للاشتقاق](https://youtu.be/ZF1_BMsOJXc)

خوارزميات الاشتقاق HMAC و PBKDF2 هي مكونات رئيسية في آلية الأمان لبروتوكول بيتكوين. تمنع هذه الخوارزميات مجموعة متنوعة من الهجمات المحتملة وتضمن سلامة محافظ بيتكوين.

تُستخدم HMAC و PBKDF2 كأدوات تشفيرية لمهام مختلفة في بيتكوين. يُستخدم HMAC بشكل أساسي لمكافحة هجمات تمديد الطول عند استخراج المحافظ المحددة بشكل تسلسلي (HD)، بينما يُستخدم PBKDF2 لتحويل عبارة تذكيرية إلى بذرة.

يأخذ HMAC رسالة ومفتاحًا كإدخالات ويولد إخراجًا ثابت الحجم. لضمان التوحيد، يتم ضبط المفتاح بناءً على حجم الكتلة المستخدمة في وظيفة التجزئة. في سياق استخراج المحفظة المحددة بشكل تسلسلي، يتم استخدام HMAC-SHA-512. يعمل الأخير بكتل بحجم 1024 بت (128 بايت) ويضبط المفتاح وفقًا لذلك. يستخدم الثوابت OPAD (0x5c) و IPAD (0x36)، وتُكرر حسب الحاجة لتعزيز الأمان.

ينطوي عملية HMAC-SHA-512 على دمج نتيجة SHA-512 المطبقة على المفتاح XOR OPAD والمفتاح XOR IPAD مع الرسالة. عند استخدام كتل بحجم 1024 بت (128 بايت)، يتم تعبئة المفتاح الإدخال بالأصفار إذا لزم الأمر، ثم يتم إجراء XOR مع IPAD و OPAD. يتم دمج المفتاح المعدل بعد ذلك مع الرسالة.

استخدام الملح، من خلال دمج مصدر إضافي للعشوائية، يزيد من أمان المفاتيح المشتقة. بدونه، يمكن أن يعرض الهجوم المحفظة بأكملها ويسرق جميع البيتكوين.
يتم استخدام PBKDF2 لتحويل عبارة تذكيرية إلى بذرة. يقوم هذا الخوارزمية بأداء 2048 جولة باستخدام HMAC SHA512. بفضل هذه الخوارزميات المشتقة، يمكن أن تنتج مدخلات مختلفة نتائج فريدة وثابتة، مما يقلل من مشكلة هجمات تمديد الطول المحتملة على وظائف عائلة SHA-2. تستغل هجمات تمديد الطول خاصية محددة في بعض وظائف التجزئة الهاش الكريبتوغرافية. في مثل هجوم، يمكن للمهاجم الذي يمتلك بالفعل التجزئة لرسالة غير معروفة استخدامها لحساب التجزئة لرسالة أطول، وهي تمديد للرسالة الأصلية. وغالبًا ما يكون ذلك ممكنًا دون معرفة محتوى الرسالة الأصلية، مما يمكن أن يؤدي إلى ثغرات أمان كبيرة إذا تم استخدام هذا النوع من وظائف التجزئة لمهام مثل التحقق من النزاهة.
![صورة](assets/image/section1/16.JPG)

في الختام، تلعب خوارزميات HMAC و PBKDF2 أدوارًا أساسية في أمان استنباط محفظة HD في بروتوكول Bitcoin. يتم استخدام HMAC-SHA-512 للحماية من هجمات تمديد الطول، بينما يسمح PBKDF2 بتحويل العبارة التذكيرية إلى بذرة. يضيف رمز السلسلة مصدرًا إضافيًا للعشوائية في استنباط المفتاح، مما يضمن قوة النظام.

# التوقيع الرقمي

## التوقيع الرقمي والمنحنيات البيضاوية

![التوقيع الرقمي والمنحنيات البيضاوية](https://youtu.be/gOjYiPkx4z8)

في عالم العملات الرقمية، يعد أمان المعاملات أمرًا بالغ الأهمية. في جوهر بروتوكول Bitcoin، يتم استخدام التواقيع الرقمية كبراهين رياضية تثبت ملكية مفتاح خاص مرتبط بمفتاح عام محدد. تعتمد هذه التقنية لحماية البيانات بشكل أساسي على مجال رائع في علم التشفير يسمى التشفير بالمنحنيات البيضاوية (ECC).

![صورة](assets/image/section2/0.JPG)

يعد التشفير بالمنحنيات البيضاوية هو العمود الفقري لأمان معاملات Bitcoin. هذه المنحنيات البيضاوية، التي تشبه المنحنيات الرياضية التي درسناها في المدرسة، مفيدة في مجموعة متنوعة من التطبيقات التشفيرية، بدءًا من تبادل المفاتيح إلى التشفير غير المتماثل إلى إنشاء التوقيع الرقمي. التفصيل المثير للاهتمام الذي يميز المنحنيات البيضاوية هو تماثلها: أي خط غير عمودي يقاطع نقطتين على المنحنى سيقاطع نقطة ثالثة.

الآن دعنا نتعمق قليلاً: يستخدم بروتوكول Bitcoin منحنى بيضاوي محدد يسمى SecP256K1 لأداء عملياته التشفيرية. يمكن تصور هذا المنحنى، الذي يعرف على مجموعة محدودة من الأعداد الصحيحة الإيجابية بواجهة عدد أولي من 256 بت، على أنه سحابة من النقاط بدلاً من منحنى تقليدي. إن هذا التصميم الفريد هو ما يسمح لـ Bitcoin بتأمين معاملاته بشكل فعال.

![صورة](assets/image/section2/1.JPG)

أما بالنسبة لاختيار منحنى secp256k1 لـ Bitcoin، فمن المثير للاهتمام أنه تم تفضيله على منحنى secp256r1. يتم تعريف هذا المنحنى بواسطة المعاملات a=0 و b=7، ومعادلته هي y² = x³ + 7 بواجهة n، حيث يمثل n العدد الأولي الذي يحدد ترتيب المنحنى.

عندما نتحدث عن الثوابت المستخدمة في نظام Bitcoin، نشير عمومًا إلى المعاملات المحددة لخوارزمية التوقيع الرقمي بالمنحنيات البيضاوية (ECDSA) ونظام المنحنيات البيضاوية المستخدم في Bitcoin، وهو منحنى secp256k1. فيما يلي هذه المعاملات:
- الحقل الأساسي (p): يستخدم بيتكوين منحنىً فوق حقل أساسي، لذا فإن p هو أول رقم يستخدم لتعريف هذا الحقل. بالنسبة لمنحنى secp256k1، يكون p مساويًا لـ `p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F` بالنظام السداسي عشر أو p = 2^256 - 2^32 - 2^9 - 2^8 - 2^7 - 2^6 - 2^4 -1 بالنظام العشري.
- ترتيب المنحنى (n): هذا هو عدد النقاط على المنحنى، بما في ذلك النقطة في اللانهاية. بالنسبة لـ secp256k1، يكون n مساويًا لـ `n = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE BAAEDCE6 AF48A03B BFD25E8C D0364141` بالنظام السداسي عشر أو n = 2^256 - 432420386565659656852420866394968145599 بالنظام العشري.
- نقطة المُولِّد (G): النقطة الأساسية، أو المُولِّد، هي النقطة على المنحنى التي يتم توليد جميع المفاتيح العامة الأخرى منها. لها إحداثيات x و y محددة، وعادة ما تُمثَّل بالنظام السداسي عشر. بالنسبة لـ secp256k1، تكون إحداثيات G على النحو التالي، بالنظام السداسي عشر:
  - `Gx = 79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798`
  - `Gy = 483ADA77 26A3C465 5DA4FBFC 0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8`

![image](assets/image/section2/2.JPG)

يرجى ملاحظة أن جميع القيم السداسي عشر عادة ما تُمثَّل بالنظام السداسي عشر، بينما القيم العشرية تكون بالنظام العشري. بالإضافة إلى ذلك، يتم تنفيذ جميع العمليات على هذه الثوابت بالقسمة على p لإحداثيات النقاط على المنحنى وبالقسمة على n لعمليات المفتاح والتوقيع.

إذاً، أين يتم تخزين هذه البتكوين المشهورة؟ ليس في محفظة بتكوين كما قد يعتقد البعض. في الواقع، تخزن محفظة بتكوين المفاتيح الخاصة اللازمة لإثبات ملكية البتكوين. أما البتكوين نفسها، فتُسجَّل على سلسلة الكتل، وهي قاعدة بيانات لامركزية تحفظ جميع المعاملات.

في نظام بتكوين، وحدة الحساب هي البتكوين (لاحظ الحرف الصغير "b"). يمكن تقسيمها إلى ثمانية أماكن عشرية، وأصغر وحدة هي الساتوشي. تُمثِّل UTXOs، أو "مخرجات المعاملات غير المنفقة"، المخرجات غير المنفقة التي تنتمي إلى مستخدم. لإنفاق هذه البتكوين، يجب على الشخص إثبات ملكيته للمفتاح الخاص المقابل للمفتاح العام المرتبط بكل UTXO.

لضمان أمان المعاملات، يعتمد بتكوين على اثنين من بروتوكولات التوقيع الرقمي: ECDSA (خوارزمية توقيع الأرقام النقطية على المنحنى البيضاوي) وسنور. يعتبر ECDSA بروتوكول توقيع مدمج في بتكوين منذ إطلاقه في عام 2009، بينما تمت إضافة توقيعات سنور مؤخرًا في نوفمبر 2021. على الرغم من أن كلا البروتوكولين يستندان إلى علم التشفير بالمنحنى البيضاوي ويستخدمان آليات رياضية مماثلة، إلا أنهما يختلفان بشكل رئيسي من حيث هيكل التوقيع.

قبل التعمق في هذه الآليات التوقيع، من المهم فهم ما هو المنحنى البيضاوي. يتم تعريف المنحنى البيضاوي بالمعادلة y² = x³ + ax + b. كل نقطة على هذا المنحنى لها تناظر مميز يكمن في أهميتها في علم التشفير.
في النهاية، يتم الاعتراف بمنحنيات البيضاوية المختلفة كآمنة للاستخدام التشفيري. ربما يكون المنحنى secp256r1 هو الأكثر شهرة. ومع ذلك، اختار ساتوشي ناكاموتو منحنى مختلفًا لبيتكوين وهو secp256k1.

في الجزء التالي من هذه الدورة، سنلقي نظرة أقرب على المفتاح العام والمفتاح الخاص لفهم شامل للتشفير على المنحنيات البيضاوية وخوارزمية التوقيع الرقمي. سيكون هذا الوقت لتوحيد معرفتك وفهم كيفية تكامل كل هذه المعلومات لضمان أمان بروتوكول بيتكوين.

## حساب المفتاح العام من المفتاح الخاص

![حساب المفتاح العام من المفتاح الخاص](https://youtu.be/NJENwFU889Y)

في الجزء التالي من هذه الدورة، سنتعمق في آليات المفاتيح العامة والخاصة، وهما عنصران حاسمان في بروتوكول بيتكوين. ترتبط هذه المفاتيح بشكل جوهري بخوارزمية التوقيع الرقمي على المنحنيات البيضاوية (ECDSA). فهمهما سيمنحنا نظرة عميقة في كيفية تأمين بيتكوين للمعاملات على منصته.

![صورة](assets/image/section2/3.JPG)
![صورة](assets/image/section2/4.JPG)

لنبدأ، دعنا نغوص في عالم خوارزمية ECDSA. يستخدم بيتكوين هذه الخوارزمية لربط المفتاح الخاص والعام. في هذا النظام، يكون المفتاح الخاص عبارة عن رقم عشوائي أو شبه عشوائي مكون من 256 بت. إجمالي عدد الاحتمالات للمفتاح الخاص هو نظرياً 2^256، ولكن في الواقع، فإنه أقل بقليل من ذلك. لكي نكون دقيقين، بعض المفاتيح الخاصة المكونة من 256 بت ليست صالحة لبيتكوين.

![صورة](assets/image/section2/5.JPG)

لكي يكون متوافقًا مع بيتكوين، يجب أن يكون المفتاح الخاص بين 1 و n-1، حيث يمثل n ترتيب المنحنى البيضاوي. هذا يعني أن إجمالي عدد الاحتمالات للمفتاح الخاص في بيتكوين يكاد يكون مساويًا لـ 1.158 × 10^77. لوضع هذا في الاعتبار، فإنه يقريبًا نفس عدد الذرات الموجودة في الكون المرئي. ثم يتم استخدام المفتاح الخاص الفريد لاستنتاج المفتاح العام المكون من 512 بت.

![صورة](assets/image/section2/6.JPG)

المفتاح العام، المعبر عنه بـ K، هو نقطة على المنحنى البيضاوي تم استنتاجها من المفتاح الخاص باستخدام عمليات النقاط على المنحنى. من المهم أن نلاحظ أن وظيفة ECDSA ليست قابلة للعكس، مما يعني أنه من المستحيل استرداد المفتاح الخاص من المفتاح العام. هذه الخاصية غير القابلة للعكس هي أساس أمان محفظة بيتكوين.

يتكون المفتاح العام من نقطتين مكونتين من 256 بت، مما يجعل إجمالي عدد البتات 512 بت. ومع ذلك، يمكن ضغطه إلى رقم مكون من 264 بت. النقطة G هي النقطة البدء لحساب جميع المفاتيح العامة للمستخدمين في النظام.

![صورة](assets/image/section2/7.JPG)

خاصية ملحوظة للمنحنيات البيضاوية هي أن خطًا يتقاطع مع المنحنى في نقطتين سيتقاطع أيضًا مع نقطة ثالثة تسمى نقطة O. يتم استخدام هذه الخاصية لتحديد النقطة U، وهي عكس النقطة O. يتم إضافة نقطة إلى نفسها عن طريق رسم خط مماس للمنحنى في تلك النقطة، مما يؤدي إلى نقطة فريدة جديدة تسمى j. ضرب النقطة بعدد n يعادل إضافة تلك النقطة إلى نفسها n مرة.

![صورة](assets/image/section2/8.JPG)
هذه العمليات على نقاط من منحنى بيضاوي هي الأساس لحساب المفاتيح العامة. من المعروف أنه من السهل حساب المفتاح العام عند معرفة المفتاح الخاص. ومع ذلك، فإن معرفة المفتاح العام لا يسمح بحساب المفتاح الخاص، مما يضمن أمان نظام البيتكوين. في الواقع، يعتمد أمان المفاتيح العامة والخاصة على مشكلة اللوغاريتم التفاضلي المتقطع، وهي مسألة رياضية معقدة.

في درسنا القادم، سنستكشف كيفية تحقيق التوقيع الرقمي باستخدام خوارزمية ECDSA بمفتاح خاص لفتح البيتكوين. ترقبوا هذا الاستكشاف المثير لعالم العملات الرقمية والتشفير.

## التوقيع بالمفتاح الخاص

عملية التوقيع الرقمي هي طريقة رئيسية لإثبات أنك حامل المفتاح الخاص دون الكشف عنه. يتم تحقيق ذلك باستخدام خوارزمية ECDSA، والتي تنطوي على تحديد عدد فريد (nonce)، وحساب عدد محدد V، وإنشاء توقيع رقمي مكون من جزأين، S1 و S2. من المهم دائمًا استخدام nonce فريد لتجنب هجمات الأمان. مثال سيء على ما يمكن أن يحدث عند عدم اتباع هذه القاعدة هو حالة اختراق جهاز بلاي ستيشن 3، الذي تم اختراقه بسبب إعادة استخدام nonce.

تحديدًا، للتحقق من توقيع رقمي باستخدام خوارزمية ECDSA (خوارزمية توقيع المنحنى البيضاوي الرقمي)، يتضمن الخطوات التالية عادة:

1. التحقق من أن قيم التوقيع، S1 و S2، في النطاق [1، n-1]. إذا لم يكن الأمر كذلك، فإن التوقيع غير صالح.
2. حساب العكس المضاعف لـ S2 mod n. سنسمي هذا العكس u. عادة ما يتم حسابه على النحو التالي: u = (S2)^-1 mod n.
3. حساب H، وهو قيمة التجزئة للرسالة الموقعة.
4. حساب u1 = H _ u mod n و u2 = S1 _ u mod n.
5. حساب النقطة P على المنحنى البيضاوي باستخدام u1 و u2 والمفتاح العام K: P = u1*G + u2*K، حيث G هو نقطة مولد المنحنى.
6. إذا كانت P هي النقطة في اللانهاية، فإن التوقيع غير صالح.
7. حساب I = الإحداثي x لـ P mod n.
8. التوقيع صالح إذا كان I يساوي S1.

من المهم أن نلاحظ أن كل برنامج قد يستخدم تعبيرات مختلفة وقد يتم دمج بعض الخطوات أو إعادة ترتيبها، ولكن المنطق الأساسي يبقى هو نفسه. كما لاحظ أن جميع العمليات الحسابية تتم في المجال المحدد بواسطة المنحنى البيضاوي (mod n، حيث n هو ترتيب المنحنى). كمذكرة، فإن منحنى secp256k1 (المستخدم في البيتكوين) لديه n = 2^256 - 432420386565659656852420866394968145599.
عندما يتعلق الأمر بإنشاء المفاتيح العامة والخاصة، فمن الضروري أن تتعرف على المنحنى البيضاوي ونقطة المولد. للحصول على مفتاح عام، يجب اختيار عدد عشوائي كمفتاح خاص، يُسمى غالبًا "nonce"، واستخدامه في معادلة المنحنى البيضاوي.
المنحنى البيضاوي هو أداة قوية لتوليد المفاتيح العامة والخاصة الآمنة. على سبيل المثال ، للحصول على المفتاح العام 3G ، يتم رسم مستقيم مماس لنقطة G ، وحساب العكس المضاد لـ -G للحصول على 2G ، ثم إضافة G و 2G. لإجراء عملية معينة ، يجب أن تثبت أنك تعرف الرقم 3 عن طريق فتح البتكوين المرتبطة بالمفتاح العام 3G.

لإنشاء توقيع رقمي وإثبات أنك تعرف المفتاح الخاص المرتبط بالمفتاح العام 3G ، يتعين عليك أولاً حساب قيمة عشوائية ، ثم النقطة V المرتبطة بهذه القيمة (في المثال المعطى ، هي 4G). ثم ، يتم حساب النقطة T عن طريق إضافة المفتاح العام 3G والنقطة V ، مما يعطي 7G.

![صورة](assets/image/section2/12.JPG)

التحقق من التوقيع الرقمي هو خطوة حاسمة في استخدام خوارزمية ECDSA ، والتي تسمح بتأكيد صحة رسالة موقعة دون الحاجة إلى المفتاح الخاص للمرسل. هنا كيف يعمل بالتفصيل:

في مثالنا ، لدينا قيمتان مهمتان: T و V. T هو قيمة عددية (7 في هذا المثال) ، و V هو نقطة على المنحنى البيضاوي (ممثلة بـ 4G هنا). تتم إنتاج هذه القيم أثناء إنشاء التوقيع الرقمي ومن ثم يتم إرسالها مع الرسالة لتمكين التحقق.

عندما يتلقى المحقق الرسالة ، سيتلقى أيضًا هاتين القيمتين ، T و V.

فيما يلي الخطوات التي سيراها المحقق للتحقق من صحة التوقيع:

1. سيقوم أولاً بحساب تجزئة الرسالة ، والتي سنسميها H.
2. ثم ، سيقوم بحساب u1 و u2. للقيام بذلك ، سيستخدم الصيغ التالية:
   - u1 = H * (S2)^-1 mod n
   - u2 = T * (S2)^-1 mod n'

# العبارة الذاكرية

## تطور محافظ بيتكوين

![تطور محافظ بيتكوين](https://youtu.be/6tmu1R9cXyk)

تلعب المحفظة التحديدية التسلسلية ، أو المعروفة بشكل أكثر شيوعًا باسم المحفظة HD ، دورًا بارزًا في نظام العملات المشفرة. قد يبدو مصطلح "المحفظة" مضللاً لأولئك الجدد في هذا المجال ، حيث لا يعني حمل الأموال أو العملة. بل يشير إلى مجموعة من المفاتيح الخاصة التشفيرية المشتقة من مفتاح رئيس واحد ، بفضل عملية حسابية بديهية. هذه المفاتيح الخاصة ، التي تتمتع بطول ثابت يبلغ 256 بتًا ، هي جوهر ملكية العملة المشفرة ، وتُشار إليها في بعض الأحيان بالاسم الأكثر خشونة "مجرد مجموعة من المفاتيح" (JBOC).

![صورة](assets/image/section3/0.JPG)

ومع ذلك ، يتم تعويض تعقيد إدارة هذه المفاتيح بمجموعة من البروتوكولات ، المعروفة باسم اقتراحات تحسين بيتكوين (BIPs). هذه الاقتراحات التحديثية هي في قلب وظيفة وأمان المحافظ HD. على سبيل المثال ، [BIP32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki) ، الذي تم إطلاقه في عام 2012 ، غير طريقة توليد وتخزين هذه المفاتيح ، وقدم مفهوم المفاتيح المشتقة بشكل تحديد وتسلسلي. هذا يبسط كثيرًا عملية حفظ هذه المفاتيح ، مع الحفاظ على مستوى أمانها.

![صورة](assets/image/section3/1.JPG)
بعد ذلك، قدمت [BIP39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) ابتكارًا رائدًا: عبارة تذكيرية مكونة من 24 كلمة. جعل هذا النظام من الممكن تحويل سلسلة معقدة وصعبة الحفظ من الأرقام إلى سلسلة من الكلمات العادية، وهي أسهل بكثير للحفظ والتخزين. بالإضافة إلى ذلك، اقترح [BIP38](https://github.com/bitcoin/bips/blob/master/bip-0038.mediawiki) إضافة عبارة سرية إضافية لتعزيز أمان المفاتيح الفردية. أدت هذه التحسينات المتتالية إلى BIP43 و BIP44، التي قامت بتوحيد هيكل وتسلسل الـ HD wallets، مما جعلها أكثر إمكانية الوصول وسهولة الاستخدام للجمهور العام.
في الأقسام التالية، سنقوم بالتعمق في كيفية عمل محافظ HD. سنغطي مبادئ استنباط المفاتيح، وندرس المفاهيم الأساسية للانحراف وتوليد الأرقام العشوائية، وهي أمور ضرورية لضمان أمان محفظتك HD.
تلعب المحفظة التسلسلية التحديدية، المعروفة بالمحفظة HD، دورًا بارزًا في نظام العملات المشفرة. قد يبدو مصطلح "محفظة" مضللاً للأشخاص الجدد في هذا المجال، حيث لا يعني حمل الأموال أو العملة. بل يشير إلى مجموعة من المفاتيح الخاصة المشفرة المشتقة من مفتاح رئيسي واحد، بفضل عملية حسابية بديهية. هذه المفاتيح الخاصة، التي تتكون من 256 بت، هي جوهر ملكية العملة المشفرة، وتُشار إليها أحيانًا بالاسم الأقل دقة "مجرد مجموعة من المفاتيح" (JBOC).

![صورة](assets/image/section3/0.JPG)

ومع ذلك، يتم تعويض تعقيد إدارة هذه المفاتيح من خلال مجموعة من البروتوكولات، المعروفة باسم اقتراحات تحسين بيتكوين (BIPs). هذه الاقتراحات التحديثية هي في قلب وظائف وأمان محافظ HD. على سبيل المثال، غيرت [BIP32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)، التي تم إطلاقها في عام 2012، الطريقة التي يتم بها إنشاء وتخزين هذه المفاتيح، وقدمت مفهوم المفاتيح المشتقة بشكل محدد وتسلسلي. وهذا يبسط بشكل كبير عملية حفظ هذه المفاتيح، مع الحفاظ على مستوى أمانها.![صورة](assets/image/section3/1.JPG)

في الختام، من الضروري أن نسلط الضوء على الدور المركزي لـ BIP32 و BIP39 في تصميم وأمان محافظ HD. تتيح هذه البروتوكولات إنشاء مفاتيح متعددة من بذرة واحدة، والتي يفترض أن تكون عشوائية أو شبه عشوائية. اليوم، يتم اعتماد هذه المعايير من قبل غالبية محافظ العملات المشفرة، سواء كانت مخصصة لعملة مشفرة واحدة أو تدعم أنواعًا متعددة من العملات.

آمل أن يكون هذا المقدمة قد ساعدتك على فهم أساسيات محافظ HD وخصائصها المختلفة. هدفنا هو مساعدتك في اتقان هذه المفاهيم الأساسية والتنقل بكفاءة أكبر في عالم العملات المشفرة المعقد. لذا، استمر معنا حيث نستكشف المعقدات والتفاصيل الدقيقة لهذا العالم الشيق في الدروس القادمة.

## الانحراف والأرقام العشوائية

![الانحراف والأرقام العشوائية](https://youtu.be/k18yH18w2TE)
أهمية أمان المفتاح الخاص في نظام البيتكوين لا يمكن إنكاره. فهي في الواقع الركن الأساسي الذي يضمن أمان عمليات البيتكوين. لتجنب أي ضعف مرتبط بالتنبؤية، يجب أن يتم إنشاء هذه المفاتيح بطريقة عشوائية حقًا، وهو ما يمكن أن يصبح تمرينًا مرهقًا بسرعة بالنسبة للمستخدم. إحدى الحلول لهذه المشكلة هي المحفظة التحديدية والتسلسلية، أو محفظة HD. تسمح هذه الطريقة بتوليد أزواج مفاتيح فرعية تحديدية وتسلسلية من قطعة واحدة من المعلومات في قاعدة المحفظة. هنا يصبح العشوائية أمرًا ضروريًا لضمان أمان المفاتيح المشتقة.
![صورة](assets/image/section3/2.JPG)

توليد الأرقام العشوائية هو في الواقع عنصر حاسم في علم التشفير، لضمان سلامة المفاتيح الخاصة. لمنع أي ضعف مرتبط بالتنبؤية، يجب أن يتم إنتاج المفتاح الخاص بشكل عشوائي. استخدام زوج مفتاح جديد لكل عملية تعزز الأمان، على الرغم من أنه يعقد عملية النسخ الاحتياطي ويحافظ جزئيًا على السرية. بشكل ملخص، فإن أمان المفاتيح الخاصة هو أولوية مطلقة، تتطلب توليدًا صارمًا وعشوائيًا. توفر محافظ HD حلاً لتسهيل توليد وإدارة المفاتيح مع الحفاظ على مستوى عالٍ من الأمان.

ومع ذلك، يشكل توليد الأرقام العشوائية على الكمبيوتر تحديًا كبيرًا، حيث أن النتائج المحصل عليها ليست عشوائية حقًا. ولهذا السبب، من الضروري استخدام مولد أرقام عشوائية (RNG). تختلف أنواع RNG، بدءًا من مولدات الأرقام العشوائية الشبه عشوائية (PRNG) إلى مولدات الأرقام العشوائية الحقيقية (TRNG)، بالإضافة إلى PRNGs التي تدمج مصدر العشوائية.

![صورة](assets/image/section3/3.JPG)

في حالة البيتكوين، يتم إنشاء المفاتيح الخاصة من قطعة واحدة من المعلومات في قاعدة المحفظة. تتيح هذه المعلومات توليد أزواج مفاتيح فرعية تحديدية وتسلسلية. العشوائية هي أساس أي محفظة HD، على الرغم من عدم وجود معيار لتوليد هذا الرقم العشوائي. ولذلك، يعد توليد الأرقام العشوائية مصدر قلق كبير لتأمين عمليات البيتكوين.

تكمن أهمية مرحلة التحقق من توليد المفتاح في ضمان أمان وأصالة توليد الأرقام العشوائية، وهو خطوة أساسية في منع أي ضعف مرتبط بالتنبؤية. يوصى بشدة باستخدام محافظ مفتوحة المصدر لتمكين هذا التحقق.

ومع ذلك، من المهم أن نلاحظ أن بعض المحافظ الأجهزة قد تكون "مغلقة المصدر"، مما يجعل من المستحيل التحقق من توليد الرقم العشوائي. يمكن أن يكون حلاً ممكنًا توليد عبارة ذاكرية خاصة باستخدام النرد، على الرغم من أن هذا النهج قد يشكل بعض المخاطر.

![صورة](assets/image/section3/4.JPG)

يمكن أن يساعد استخدام عبارة سرية تم إنشاؤها عشوائيًا في التخفيف من هذه المخاطر.

مثال على تطبيق هذه الطريقة هو خيار "رمي النرد" المقدم من CoinKit لتوليد عبارات ذاكرية. يمكن أيضًا استخدام قطعة معلومات أولية كبيرة جدًا وتقليل هذه المعلومات إلى 256 بت باستخدام وظيفة التجزئة SHA-256، التي تستطيع توليد رقم عشوائي جيد. من المهم أن نذكر أن وظيفة التجزئة SHA-256 تقاوم التصادمات والتزوير وهجمات الصورة الأولى والصورة الثانية.

في النهاية، تلعب العشوائية دورًا مركزيًا في علم التشفير وعلوم الحاسوب، والقدرة على توليد العشوائية بشكل آمن أمر حاسم لضمان أمان المفاتيح الخاصة وعمليات البيتكوين. العشوائية، التي تكمن في قلب محفظة البيتكوين HD، ضرورية لأمانها. في درسنا القادم، سنستمر في استكشاف هذا الموضوع، ونتعمق في كيفية مساهمة العشوائية في أمان محافظ HD.

## العبارة الذاكرية

![العبارة الذاكرية](https://youtu.be/uJERqH9Xp7I)

أمان محفظة البيتكوين يشكل قلقًا كبيرًا لجميع مستخدميها. وسيلة أساسية لضمان نسخ احتياطي للمحفظة هي توليد عبارة ذاكرية بناءً على العشوائية والتحقق من الامتثال.
الانتروبي هو أساس أمان محفظة HD. توجد عدة طرق لتوليد هذه الانتروبي، بما في ذلك من خلال مولدات الأرقام العشوائية الشبه عشوائية (PRNGs)، مولدات الأرقام العشوائية الحقيقية (TRNGs)، أو يدويًا. من الضروري أن تكون هذه الانتروبي عشوائية أو شبه عشوائية لضمان أمان المحفظة.

من ناحية أخرى، يضمن الفحص البايتي التحقق من دقة عبارة الاسترداد. بدون هذا الفحص البايتي، يمكن أن يؤدي خطأ في العبارة إلى إنشاء محفظة مختلفة وبالتالي فقدان الأموال. يتم الحصول على الفحص البايتي عن طريق تمرير الانتروبي من خلال وظيفة SHA256 واسترداد أول 8 بايت من الهاش.

توجد معايير مختلفة لعبارة الذاكرة النصية اعتمادًا على حجم الانتروبي. الاعتيار الأكثر استخدامًا لعبارة الاسترداد المؤلفة من 24 كلمة هو انتروبي بحجم 256 بايت. يتم تحديد حجم الفحص البايتي عن طريق قسمة حجم الانتروبي على 32.

على سبيل المثال، يولد انتروبي بحجم 256 بايت فحص بايتي بحجم 8 بايت. يؤدي اتحاد الانتروبي والفحص البايتي إلى أحجام مقابلة بحجم 128 بايت، 160 بايت، إلخ. اعتمادًا على حجم الانتروبي، ستتكون عبارة الاسترداد من 12 كلمة لـ 128 بايت، 15 كلمة لـ 160 بايت، و 24 كلمة لـ 256 بايت.

لتحويل البتات إلى عبارات، يتم ربط كل قطعة بكلمة من قائمة تحتوي على 2048 كلمة. من المهم أن نلاحظ أنه لا توجد كلمة لها نفس ترتيب الأحرف الأولى الأربعة.

من الضروري أن يتم نسخ عبارة الاسترداد المؤلفة من 24 كلمة للحفاظ على سلامة محفظة البيتكوين. الاعتيارين الأكثر استخدامًا يعتمدان على انتروبي بحجم 128 أو 256 بايت واتحاد 12 أو 24 كلمة. إضافة عبارة سرية هي خيار إضافي لتعزيز أمان المحفظة.

في الختام، توليد عبارة ذاكرة نصية لتأمين محفظة البيتكوين هو عملية حاسمة. من المهم الالتزام بمعايير عبارة الذاكرة النصية اعتمادًا على حجم الانتروبي. يعتبر نسخ عبارة الاسترداد المؤلفة من 24 كلمة أمرًا ضروريًا لمنع أي فقدان للأموال. شكرًا لاهتمامك ونتطلع إلى دورتنا التالية في عالم العملات المشفرة.

## العبارة السرية

العبارة السرية هي كلمة مرور إضافية يمكن دمجها في محفظة البيتكوين لزيادة أمانها. استخدامها اختياري ويتوقف على تقدير المستخدم. من خلال إضافة معلومات تعسفية تسمح، جنبًا إلى جنب مع عبارة الذاكرة النصية، بحساب بذرة المحفظة، تعزز العبارة السرية أمانها.

لتشتق مفاتيح محفظة HD، يتطلب الأمر كل من عبارة الذاكرة النصية والعبارة السرية. العبارة السرية مجانية ويمكن أن تصل إلى حجم شبه لانهائي. لا تتضمن في عبارة الذاكرة النصية، التي هي موحدة ويجب أن تتبع قيود معينة للحجم والفحص البايتي والترميز. لا يمكن للمهاجم الوصول إلى بيتكوينات المستخدم بدون معرفة العبارة السرية. تلعب العبارة السرية دورًا في بناء وحساب جميع مفاتيح المحفظة.

يتم استخدام وظيفة pbkdf2 لتوليد البذرة من العبارة السرية. تسمح هذه البذرة بتشتيت جميع أزواج المفاتيح الفرعية للمحفظة. إذا تم تغيير العبارة السرية، فإن محفظة البيتكوين تصبح مختلفة تمامًا.
العبارة السرية هي أداة أساسية لتعزيز أمان محافظ البيتكوين. يمكن أن تمكّن تطبيق استراتيجيات أمان مختلفة. على سبيل المثال، يمكن استخدامها لإنشاء نسخ وتسهيل عمليات النسخ الاحتياطي للعبارة الذاكرية. يمكن أيضًا تحسين أمان المحفظة عن طريق التخفيف من المخاطر المرتبطة بتوليد عشوائي للعبارة الذاكرية.
يجب أن تكون العبارة السرية فعالة ، طويلة (20 إلى 40 حرفًا) ومتنوعة (باستخدام الأحرف الكبيرة والأحرف الصغيرة والأرقام والرموز). يجب ألا تكون مرتبطة مباشرة بالمستخدم أو بيئته. من الأفضل استخدام تسلسل عشوائي من الأحرف بدلاً من كلمة بسيطة كعبارة سرية.

![صورة](assets/image/section3/9.JPG)

العبارة السرية أكثر أمانًا من كلمة مرور بسيطة. العبارة السرية المثالية طويلة ومتنوعة وعشوائية. يمكن أن تعزز أمان المحفظة أو البرنامج الساخن. يمكن أيضًا استخدامها لإنشاء نسخ احتياطية متكررة وآمنة.

من الضروري العناية بنسخ احتياطية للعبارة السرية لتجنب فقدان الوصول إلى المحفظة. العبارة السرية هي خيار لمحفظة HD. يمكن إنشاؤها بشكل عشوائي باستخدام النرد أو مولد رقم عشوائي آخر. لا يُنصح بحفظ العبارة السرية أو العبارة الذاكرية في الذاكرة.

في الدرس التالي، سنستكشف بالتفصيل عملية البذرة والزوج الأول من المفاتيح التي يتم إنشاؤها منها. لا تتردد في متابعة هذا الدورة لمواصلة التعلم. نتطلع إلى رؤيتك قريبًا.

# إنشاء محافظ البيتكوين

## إنشاء البذرة والمفتاح الرئيسي

![إنشاء البذرة والمفتاح الرئيسي](https://youtu.be/56yAt_JDWhY)

في هذا الجزء من الدورة، سنستكشف خطوات استنباط محفظة تحديدية بيانيًا (HD Wallet)، والتي تسمح بإنشاء وإدارة المفاتيح الخاصة والعامة بطريقة تسلسلية.

![صورة](assets/image/section4/0.JPG)

تعتمد محفظة HD على عنصرين أساسيين: العبارة الذاكرية والعبارة السرية (كلمة مرور إضافية اختيارية). معًا، يشكلون البذرة، وهي تسلسلة أبجدية رقمية تحتوي على 512 بت تعمل كأساس لاستنباط مفاتيح المحفظة. من هذه البذرة، يمكن استنباط جميع أزواج المفاتيح الفرعية لمحفظة البيتكوين. البذرة هي المفتاح الذي يمنح الوصول إلى جميع البيتكوين المرتبطة بالمحفظة، سواء استخدمت عبارة سرية أم لا.

للحصول على البذرة، يتم استخدام وظيفة pbkdf2 (وظيفة استنباط المفتاح المعتمدة على كلمة المرور 2) مع العبارة الذاكرية والعبارة السرية. ناتج pbkdf2 هو بذرة تحتوي على 512 بت. يتم تحديد المفتاح الخاص الرئيسي ورمز السلسلة الرئيسي باستخدام خوارزمية HMAC SHA-512 (الكود المصادق عليه بناءً على الهاش الآمن بطول 512 بت). تتطلب هذه الخوارزمية رسالة ومفتاحًا لتوليد نتيجة. يتم حساب المفتاح الخاص الرئيسي من البذرة وعبارة "Bitcoin SEED". تكون هذه العبارة متطابقة لجميع استنباطات محفظة HD، مما يضمن التوافق بين المحافظ.

![صورة](assets/image/section4/1.JPG)

في البداية، لم يتم تنفيذ وظيفة SHA-512 في بروتوكول البيتكوين، ولهذا السبب يتم استخدام HMAC SHA-512. استخدام HMAC SHA-512 مع عبارة "Bitcoin SEED" يقيد المستخدم بتوليد محفظة محددة للبيتكوين. نتيجة HMAC SHA-512 هي رقم مكون من 512 بت، ينقسم إلى جزئين: أقصى 256 بت يمثل المفتاح الخاص الرئيسي، بينما أقصى 256 بت يمثل رمز السلسلة الرئيسي.
المفتاح الخاص الرئيسي هو المفتاح الأصلي لجميع المفاتيح المستقبلية في المحفظة، بينما يشارك المفتاح السلسلة الرئيسي في استنتاج المفاتيح الفرعية. من المهم أن نلاحظ أنه من المستحيل استنتاج زوج مفتاح فرعي دون معرفة سلسلة الأكواد المقابلة لزوج الأصل. تضيف سلسلة الأكواد مصدرًا للعشوائية في عملية الاستنتاج.
يتكون زوج المفتاح في المحفظة من مفتاح خاص ومفتاح عام وسلسلة أكواد. تسمح سلسلة الأكواد بإدخال العشوائية في استنتاج المفاتيح الفرعية وتعزل كل زوج مفتاح لمنع تسرب أي معلومات.

![صورة](assets/image/section4/2.JPG)

من المهم التأكيد على أن المفتاح الخاص الرئيسي هو أول مفتاح خاص يتم استنتاجه من البذرة ولا يوجد له أي ارتباط بالمفاتيح الموسعة للمحفظة. لذلك، تعتبر البذرة العنصر الأساسي لاستنتاج جميع مفاتيح المحفظة. تختلف عن العبارة المذكورة والعبارة السرية، التي تستخدم لإنشاء البذرة.

في الدرس القادم، سنستكشف بالتفصيل المفاتيح الموسعة، مثل xPub و xPRV و zPub، ونفهم لماذا يتم استخدامها وكيفية بنائها.

## المفاتيح الموسعة

![المفاتيح الموسعة](https://youtu.be/TRz760E_zUY)

في هذا الجزء من الدرس، سندرس المفاتيح الموسعة (xPub و zPub و yPub) وبادئاتها، التي تلعب دورًا هامًا في استنتاج المفاتيح الفرعية في محفظة HD (المحفظة التفاضلية التسلسلية الهرمية).

![صورة](assets/image/section4/3.JPG)

تتميز المفاتيح الموسعة عن المفاتيح الرئيسية. تولد المحفظة التفاضلية التسلسلية التهجينية عبارة مذكرة وبذرة للحصول على المفتاح الرئيسي وسلسلة الأكواد الرئيسية. تُستخدم المفاتيح الموسعة لاستنتاج المفاتيح الفرعية وتتطلب كل من المفتاح الأصلي وسلسلة الأكواد المقابلة. يجمع المفتاح الموسع هاتين القطعتين من المعلومات لتبسيط عملية الاستنتاج.

تتم تحديد المفاتيح الموسعة بواسطة بادئات محددة (XPRV و XPUB و YPUB و ZPUB) تشير إلى ما إذا كان مفتاحًا خاصًا موسعًا أو عامًا، بالإضافة إلى هدفه المحدد. يتضمن البيانات الوصفية المرتبطة بالمفتاح الموسع الإصدار (البادئة) والعمق وبصمة المفتاح العام والفهرس والحمولة (سلسلة الأكواد والمفتاح الأصلي).

![صورة](assets/image/section4/4.JPG)

تتكون الحمولة من سلسلة الأكواد (32 بايتًا) والمفتاح الأصلي (33 بايتًا). هذه العناصر ضرورية لاستنتاج المفاتيح الفرعية. يتم إنشاء المفتاح الخاص من رقم عشوائي أو شبه عشوائي، بينما يتم إنشاء المفتاح العام باستخدام خوارزمية ECDSA (خوارزمية توقيع الأرقام الرقمية بالمنحنى البيضاوي).

يتم تعيين زوج من المفاتيح الموسعة بسلسلة أكواد فريدة، مما يسمح بالاستنتاجات المحددة. من خلال دمج المفتاح الأصلي مع سلسلة الأكواد، يتم الحصول على مفتاح خاص أو عام موسع.

![صورة](assets/image/section4/5.JPG)

يمكن استنتاج المفاتيح العامة الموسعة فقط من المفاتيح العامة الفرعية العادية، بينما يمكن استنتاج المفاتيح الخاصة الموسعة من المفاتيح العامة والخاصة الفرعية، سواء من خلال الاستنتاج العادي أو الاستنتاج المقاوم. يسمح استخدام المفاتيح الموسعة بالبادئة XPUB بالاستنتاج عناوين جديدة دون العودة إلى المفاتيح الخاصة المقابلة، مما يوفر أمانًا أفضل. توفر البيانات الوصفية المرتبطة بالمفاتيح الموسعة معلومات مهمة حول دورها وموقعها في التسلسل الهرمي للمفاتيح.

تتميز المفاتيح العامة المضغوطة بحجم 33 بايتًا، بينما تبلغ مفاتيح العام غير المضغوطة 512 بت. تحتفظ المفاتيح العامة المضغوطة بنفس المعلومات الموجودة في المفاتيح غير المضغوطة، ولكن بحجم أصغر. تبلغ حجم المفاتيح الموسعة 82 بايتًا وتتمثل بادئتها في القاعدة 58 من خلال التحويل السداسي عشري. يتم حساب الفحص باستخدام وظيفة التجزئة HASH256. 

![صورة](assets/image/section4/6.JPG)
تبدأ الاشتقاقات المقواة من الفهارس التي تكون قوى العدد 2 (2^31). تسمح المفاتيح العامة الموسعة فقط بالاشتقاق من المفاتيح العامة للأطفال العاديين، بينما تسمح المفاتيح الخاصة الموسعة بالاشتقاق من أي مفتاح فرعي. يجدر بالذكر أن البادئات الأكثر استخدامًا هي xpub و zpub، والتي تتوافق على التوالي مع معايير الإرث و segwit v1 و segwit v0.

في درسنا القادم، سنستكشف اشتقاق أزواج المفاتيح الفرعية باستخدام المعرفة المكتسبة حول المفاتيح الموسعة ومفتاح المحفظة الرئيسي.

في الختام، تلعب المفاتيح الموسعة دورًا أساسيًا في علم التشفير وعمل المحافظ ذات الهيكل التسلسلي المحدد. فهم استخدامها وحسابها أمر بالغ الأهمية لضمان أمان المعاملات وحماية الأصول الرقمية. تسمح البادئات والبيانات الوصفية المرتبطة بالمفاتيح الموسعة باستخدام فعال واشتقاق دقيق للمفاتيح الفرعية الضرورية.

## اشتقاق أزواج المفاتيح الفرعية

![اشتقاق أزواج المفاتيح الفرعية](https://youtu.be/FXhI-GmE9Aw)

بعد ذلك، سنناقش حساب البذرة والمفتاح الرئيسي، وهما العناصر الأساسية الأولى للتنظيم التسلسلي واشتقاق محفظة HD (المحفظة التسلسلية التحديدية). تتم إنشاء البذرة، التي تتراوح طولها بين 128 و 256 بت، عشوائيًا أو من عبارة سرية. تلعب دورًا تحديدًا في اشتقاق جميع المفاتيح الأخرى. المفتاح الرئيسي هو أول مفتاح يتم اشتقاقه من البذرة، ويسمح بالاشتقاق من جميع أزواج المفاتيح الفرعية الأخرى.

يلعب سلسلة المفاتيح الرئيسية دورًا هامًا في استعادة المحفظة من البذرة. يجب ملاحظة أن جميع المفاتيح المشتقة من نفس البذرة ستحتوي على نفس سلسلة المفاتيح الرئيسية.

![صورة](assets/image/section4/7.JPG)

توفر المحفظة التسلسلية التحديدية والتسلسلية (HD wallet) إدارة أكثر كفاءة للمفاتيح وهياكل المحافظ. تسمح المفاتيح الموسعة بالاشتقاق من زوج مفتاح فرعي من زوج مفتاح أصلي باستخدام الحسابات الرياضية والخوارزميات المحددة.

هناك أنواع مختلفة من أزواج المفاتيح الفرعية، بما في ذلك المفاتيح المقواة والمفاتيح العادية. تسمح المفتاح العام الموسع فقط بالاشتقاق من المفاتيح العامة للأطفال العاديين، بينما يسمح المفتاح الخاص الموسع بالاشتقاق من جميع المفاتيح الفرعية، سواء كانت عامة أو خاصة، سواء في الوضع العادي أو المقوى. كل زوج مفتاح له مؤشر يميزه عن الآخر.

![صورة](assets/image/section4/8.JPG)

يستخدم اشتقاق المفاتيح الفرعية وظيفة HMAC-SHA512 باستخدام المفتاح الأصلي المتصل بالفهرس وسلسلة المفاتيح المرتبطة بزوج المفاتيح. تحتوي المفاتيح الفرعية العادية على فهرس يتراوح من 0 إلى 2 إلى قوة 31 ناقص 1، بينما تحتوي المفاتيح الفرعية المقواة على فهرس يتراوح من 2 إلى قوة 31 إلى 2 إلى قوة 32 ناقص 1.

![صورة](assets/image/section4/9.JPG)
![صورة](assets/image/section4/10.JPG)

هناك نوعان من أزواج المفاتيح الفرعية: الأزواج المقواة والأزواج العادية. يستخدم عملية اشتقاق أزواج المفاتيح العامة لإنشاء شروط الإنفاق، بينما يستخدم المفاتيح الخاصة للتوقيع. تسمح المفتاح العام الموسع فقط بالاشتقاق من المفاتيح العامة للأطفال العاديين، بينما يسمح المفتاح الخاص الموسع بالاشتقاق من جميع المفاتيح الفرعية، سواء كانت عامة أو خاصة، في الوضع العادي أو المقوى.

![صورة](assets/image/section4/11.JPG)
![صورة](assets/image/section4/12.JPG)

يستخدم الاشتقاق المقوى المفتاح الخاص الأصلي، بينما يستخدم الاشتقاق العادي المفتاح العام الأصلي. يتم استخدام وظيفة HMAC-SHA512 للاشتقاق المقوى، بينما يستخدم الاشتقاق العادي تجزئة 512 بت. يتم الحصول على المفتاح العام الفرعي عن طريق ضرب المفتاح الخاص الفرعي بمولد المنحنى البيضاوي.

![صورة](assets/image/section4/13.JPG)
هيكل المحفظة ومسارات الاشتقاق

في هذا الفصل، سندرس هيكل شجرة الاشتقاق في المحفظة التحليلية التسلسلية (HD Wallet). لقد استكشفنا بالفعل حساب البذرة والمفتاح الرئيسي واشتقاق أزواج المفاتيح الفرعية. الآن، سنركز على تنظيم المفاتيح داخل المحفظة.

تستخدم المحفظة التحليلية التسلسلية طبقات العمق لتنظيم المفاتيح. كل اشتقاق من زوج أصلي إلى زوج فرعي يتوافق مع طبقة عمق. يتوافق العمق 0 مع المفتاح الرئيسي ورمز السلسلة الرئيسية.

- يتم استخدام العمق 1 لاشتقاق المفاتيح الفرعية لغرض محدد، والذي يتم تحديده بواسطة الفهرس. الأغراض متوافقة مع BIP 84 ومعايير Segwit v0/v1.

- يسمح العمق 2 بتمييز الحسابات للعملات المشفرة أو الشبكات المختلفة. يسمح هذا بتنظيم المحفظة بناءً على مصادر الأموال المختلفة.

- يتم استخدام العمق 3 لتنظيم المحفظة إلى حسابات مختلفة، مما يوفر هيكلًا أكثر وضوحًا وتنظيمًا.

- يتوافق العمق 4 مع سلاسل الخارجية والداخلية، والتي تستخدم لعناوين تهدف إلى الاتصال العام. يرتبط الفهرس 0 بالسلسلة الخارجية، بينما يرتبط الفهرس 1 بالسلسلة الداخلية. لكل حساب سلسلتان: السلسلة الخارجية (0) والسلسلة الداخلية (1). يتم أيضًا استخدام العمق 4 لإدارة أنواع البرامج في حالة المحافظ متعددة التوقيع.

- يتم استخدام العمق 5 لعناوين الاستلام في محفظة قياسية. في القسم التالي، سندرس اشتقاق أزواج المفاتيح الفرعية بمزيد من التفصيل.

بالنسبة لكل طبقة عمق، نستخدم الفهارس لتمييز أزواج المفاتيح الفرعية. يتم استخدام الفهارس المقواة مع علامة الفاصلة للاشتقاقات المعينة. يتم استخدام المفتاح العام في السنة كإدخال لوظيفة HMAC. يشير الفهرس في مسار الاشتقاق إلى القيمة المستخدمة في وظيفة HMAC.
يتوافق الفهرس بدون علامة الفاصلة مع الفهرس الفعلي المستخدم، بينما يتوافق الفهرس مع علامة الفاصلة مع الفهرس الفعلي + 2^31. تستخدم الاشتقاقات المعززة الفهارس من 2^31 إلى 2^32-1. على سبيل المثال، يتوافق الفهرس 44' مع الفهرس الفعلي 2^31 + 44.
لإنشاء عنوان استلام محدد، نشتق زوجًا من المفاتيح الفرعية من المفتاح الرئيسي ورمز السلسلة الرئيسي. ثم، نستخدم الفهرس للتمييز بين أزواج مختلفة من المفاتيح الفرعية في نفس العمق.

المفاتيح الموسعة، مثل XPUB، تسمح لك بمشاركة محفظتك مع عدة أشخاص. يتم استخدام مسار الاشتقاق للتمييز بين السلسلة الخارجية (العناوين المقصودة للاتصال) والسلسلة الداخلية (عناوين التغيير).

من المهم أن نلاحظ أن أعماقًا مختلفة تستخدم في محفظة التحليل التسلسلية التبعية اعتمادًا على المعايير المختلفة. يسمح اشتقاق المفاتيح الأصلية إلى المفاتيح الفرعية بالانتقال من عمق إلى آخر. استخدام فروع مختلفة في محفظة التحليل التسلسلية التبعية يشير إلى المعايير المختلفة المتبعة.

في الفصل التالي، سندرس عناوين الاستلام، مزايا استخدامها، والخطوات المشاركة في بنائها.

ما هو عنوان بيتكوين؟

عناوين بيتكوين
في هذا الفصل، سنستكشف عناوين الاستلام، التي تلعب دورًا حاسمًا في نظام البيتكوين. تتيح لك هذه العناوين استلام الأموال على عملة وتتم إنشاؤها من أزواج المفاتيح الخاصة والعامة. على الرغم من وجود نوع نصي يسمى Pay2PublicKey يسمح بقفل البيتكوين على مفتاح عام، يفضل المستخدمون عمومًا استخدام عناوين الاستلام بدلاً من هذا النص.

عندما يرغب المستلم في استلام البيتكوين، يقدم عنوان استلام للمرسل بدلاً من مفتاحه العام. يعد العنوان في الواقع هاشًا للمفتاح العام، بتنسيق محدد. يتم استخلاص المفتاح العام من المفتاح الخاص الفرعي باستخدام عمليات رياضية مثل جمع النقاط وضاعفها على المنحنيات البيضاوية.

من المهم أن نلاحظ أنه ليس من الممكن عكس العملية من عنوان إلى المفتاح العام، ولا من المفتاح العام إلى المفتاح الخاص. يساعد استخدام العنوان في تقليل حجم معلومات المفتاح العام، والتي تبلغ في البداية 512 بت. يمكن ضغط المفتاح العام عن طريق الاحتفاظ فقط بقيمة x وإضافة بادئة، ولكن هذه التقنية لم تكن معروفة في ذلك الوقت من إنشاء البيتكوين. لذلك، استخدام العنوان لا يوفر مساحة في الكتل.

## كيفية إنشاء عنوان بيتكوين؟

في هذا الفصل، سنناقش بناء عنوان استلام لعمليات بيتكوين. يعد عنوان الاستلام تمثيلًا أبجديًا رقميًا للمفتاح العام المضغوط. يتم تحويل المفتاح العام إلى عنوان استلام من خلال عدة خطوات.

إحدى الميزات المفيدة لعناوين الاستلام هي وجود فحص تجزئة، والذي يسمح بكشف الأخطاء. لهذا الغرض، نستخدم تقنية فحص BCH (Bose-Chaudhuri-Hocquenghem)، والتي تضمن كشف الأخطاء بدقة. تساهم هذه التقنية أيضًا في تقليل عدد الأحرف المطلوبة لتمثيل عنوان، مما يجعل استخدامه أسهل.

لبدء بناء عنوان، نحتاج إلى ضغط المفتاح العام المقابل. يشغل المفتاح العام الخام 520 بت، ولكن بفضل تماثل المنحنى البيضاوي المستخدم، يمكن أن يكون لمنحنى بيضاوي إحداثي x مرتبط بقيمتين ممكنتين لـ y: إيجابية أو سلبية. في شبكة البيتكوين، نعمل مع مجموعة محدودة من الأعداد الصحيحة الإيجابية بدلاً من مجموعة الأعداد الحقيقية. لتمثيل مفتاح عام من x، نضيف بادئة تشير إلى قيمة y (زوجي أو فردي). يقلص ضغط المفتاح العام حجمه من 520 إلى 264 بت. تتوافق زوجية y في مجموعة محدودة من الأعداد الصحيحة مع زوجية y في مجموعة الأعداد الحقيقية.

لنأخذ مثالًا على المفتاح العام الخاص بساتوشي ناكاموتو، مع بادئة 0,3 تشير إلى قيمة فردية لـ y. يمكننا بعد ذلك المضي قدمًا إلى الخطوة الثانية في بناء عنوان من المفاتيح العامة المضغوطة. يمكن حساب عنوانين اثنين لكل مفتاح عام. للقيام بذلك، نستخدم وظيفة SHA256 للحصول على هاش المفتاح العام. ثم، نطبق وظيفة ripemd160 على نتيجة SHA256 للحصول على سلسلة من الأحرف. يتم ترميز هذه السلسلة بتنسيق ثنائي في مجموعات من 5 بت، يتم إضافة بيانات تعريفية إليها لحساب الفحص التجزئة باستخدام برنامج BCH.


في حالة العناوين القديمة، نستخدم تجزئة SHA256 المزدوجة لإنشاء العنوان التحقق منه. ومع ذلك، بالنسبة لعناوين Segwit V0 و V1، نعتمد على تقنية BCH للكشف عن الأخطاء وضمانها. يمكن لبرنامج BCH أن يقترح ويصحح الأخطاء بإحتمالية خطأ منخفضة جدًا. حاليًا، يتم استخدام برنامج BCH للكشف عن الأخطاء واقتراح التعديلات، ولكنه لا يقوم تلقائيًا بإجراء التعديلات نيابة عن المستخدم. يستند حساب العنوان التحقق باستخدام رمز BCH إلى حسابات تشين-شوفاج الجبرية.

![صورة](assets/image/section5/7.JPG)

يتطلب برنامج BCH العديد من المعلومات الدخل، بما في ذلك HRP (جزء قابل للقراءة بشرية) الذي يحتاج إلى التوسع. ينطوي التوسيع على ترميز كل حرف في القاعدة 2، وأخذ أول ثلاثة بت من كل حرف عن طريق إدراج فاصل 0، ثم دمج آخر خمسة بت من كل حرف. الأحرف الزرقاء المحولة إلى القاعدة 10 تتوافق مع الرقم 3 و 3 في العشرية، بينما الأحرف الخمسة البرتقالية الأخرى تتوافق مع الرقمين 2 و 3 في القاعدة 10. يسمح توسيع HRP في القاعدة 10 بعزل آخر خمسة بت من كل حرف، مما يعزز العنوان التحقق.

![صورة](assets/image/section5/8.JPG)

تُمثل النسخة Segwit V0 بالرمز 00 و"الحمولة" باللون الأسود، في القاعدة 10. يلي ذلك ستة أحرف محجوزة للعنوان التحقق. يتم ثم تقديم المدخل الذي يحتوي على البيانات الوصفية إلى برنامج BCH للحصول على العنوان التحقق في القاعدة 10. يسمح دمج النسخة والحمولة والعنوان التحقق ببناء العنوان. يتم ثم تحويل الأحرف في القاعدة 10 إلى أحرف bech32 باستخدام جدول تعيين. تتضمن أبجدية bech32 جميع الأحرف الأبجدية والرقمية، باستثناء 1 و b و i و o، لتجنب الارتباك.

![صورة](assets/image/section5/9.JPG)
![صورة](assets/image/section5/10.JPG)

لبناء عنوان يبدأ بـ bc1q، نحتاج إلى تطبيق وظيفة تجزئة (H160) على مفتاح عام مضغوط، ثم إضافة العنوان التحقق، النسخة (q)، HRP (bc)، والفاصل (1). بالمقابل، تبدأ عناوين Taproot بـ bc1p لأن النسخة (Segwit V1) تتوافق مع 0+1=1، ومن هنا يتم استخدام الحرف p. يتم ثم تحويل كل هذه العناصر إلى BCH32، وهو النسخة الخاصة ببيتكوين من القاعدة 32.

وهكذا، قمنا بالمرور عبر خطوات بناء عنوان استلام، واستخدام تقنية BCH للكشف عن الأخطاء، وبناء عنوان يبدأ بـ bc1q أو bc1p باستخدام النسخة BCH32 من القاعدة 32 الخاصة ببيتكوين.

## ملخص عن التشفير لمحافظ بيتكوين

![ملخص التدريب](https://youtu.be/NkAYoVUMvOs)

طوال هذا التدريب، قمنا بدراسة مفصلة لمحفظة التحديد الهرمية (HD) مع BIP32. تلعب الانتروبي دورًا مركزيًا في هذا النوع من المحافظ، حيث يتم استخدامها لإنشاء عبارة تذكيرية من رقم عشوائي. باستخدام قائمة الكلمات المقدمة في BIP39 والتي تحتوي على 2048 كلمة، يمكن ترميز العبارة التذكيرية هذه إلى سلسلة من الكلمات سهلة الحفظ. العبارة التذكيرية، جنبًا إلى جنب مع عبارة سرية اختيارية، ضرورية لإنشاء بذرة المحفظة. تعمل العبارة السرية كملح تشفيري يضيف طبقة إضافية من الحماية للمحفظة.

![صورة](assets/image/section5/11.JPG)
تُستخدم وظيفة pbkdf2 لإنشاء البذرة من عبارة المفتاح الذاكري وعبارة المرور، باستخدام hmacha512 و 2048 تكرارًا. يتم استخراج المفتاح الرئيسي ورمز السلسلة الرئيسي من هذه البذرة باستخدام وظيفة hmacha512 مرة أخرى باستخدام عبارة "بذرة بيتكوين". المفتاح الخاص الرئيسي ورمز السلسلة الرئيسي هما أعلى عناصر في هرم محفظة HD.
![صورة](assets/image/section5/12.JPG)

تعتمد استحداث مفتاح فرعي على عدة عوامل، بما في ذلك المفتاح الأصلي ورمز السلسلة المقابل. يتم الحصول على مفتاح موسع عن طريق دمج مفتاح أصلي مع رمز السلسلة الخاص به، بينما يكون المفتاح الرئيسي مفتاحًا منفصلاً. لاستحداث عنوان، يتم تجزئة المفتاح العمومي المضغوط أولاً باستخدام SHA256 و RIPMD160، ثم يتم حساب الفحص. يتم استخدام تجزئة SHA256 المزدوجة لحساب الفحص في حالة المعيار القديم، بينما يتم استخدام برنامج BCH (Bose-Chaudhuri-Hocquenghem) لحساب الفحص في حالة المعيار segwit. ثم يتم استخدام تمثيل بتنسيق القاعدة 58 للمعيار القديم، بينما يتم استخدام تمثيل بتنسيق bech32 للمعيار segwit، للحصول على عنوان محفظة HD.

![صورة](assets/image/section5/13.JPG)

للختام، قمنا بدراسة تفصيلية لوظائف التجزئة وخصائصها، بالإضافة إلى التوقيعات الرقمية والمنحنيات البيضاوية. ثم استكشفنا عالم المحافظ الهرمية المحددة تلقائيًا (HD) مع BIP32، باستخدام العشوائية وعبارة المرور لإنشاء بذرة المحفظة. تعلمنا أيضًا كيفية استحداث المفاتيح الفرعية والحصول على عنوان المحفظة HD. آمل أن تكون هذه المعلومات مفيدة لك، وأشجعك الآن على المتابعة إلى التقييم لاختبار المعرفة التي اكتسبتها خلال دورة Crypto 301. شكرًا لاهتمامك.

# اذهب أبعد

## إنشاء بذرة من 128 قرعة للنرد!

![إنشاء بذرة من 128 قرعة للنرد!](https://youtu.be/lUw-1kk75Ok)

إن إنشاء عبارة مفتاح ذاكرة مؤقتة هو خطوة حاسمة في تأمين محفظة العملات الرقمية الخاصة بك. هناك عدة طرق لإنشاء عبارة مفتاح ذاكرة مؤقتة، ومع ذلك، سنركز على طريقة الإنشاء اليدوي باستخدام النرد. من المهم أن نلاحظ أن هذه الطريقة غير مناسبة لمحفظة ذات قيمة عالية. يُوصى باستخدام برامج مفتوحة المصدر أو محفظة عتادية لإنشاء عبارة المفتاح الذاكري المؤقتة. لإنشاء عبارة مفتاح ذاكرة مؤقتة، سنستخدم النرد لإنشاء معلومات ثنائية. الهدف هو فهم عملية إنشاء عبارة المفتاح الذاكري المؤقتة.

**الخطوة 1 - التحضير:**
تأكد من وجود توزيعة لينكس ذات طابع ذاكرة مؤقتة، مثل Tails OS، مثبتة على محرك أقراص USB لزيادة الأمان. يجب ملاحظة أنه لا ينبغي استخدام هذا البرنامج التعليمي لإنشاء محفظة أساسية.

**الخطوة 2 - إنشاء رقم ثنائي عشوائي:**
سنستخدم النرد لإنشاء معلومات ثنائية. قم بقرع النرد 128 مرة وقم بتسجيل كل نتيجة (1 للأعداد الفردية، 0 للأعداد الزوجية).

**الخطوة 3 - تنظيم الأرقام الثنائية:**
قم بتنظيم الأرقام الثنائية المحصل عليها في صفوف من 11 أرقام لتسهيل الحسابات اللاحقة. يجب أن تحتوي الصف الثاني عشر على 7 أرقام فقط.

**الخطوة 4 - حساب الفحص:**
آخر 4 أرقام للصف الثاني عشر تتوافق مع الفحص. لحساب هذا الفحص، نحتاج إلى استخدام وحدة نهاية من توزيعة لينكس. من المستحسن استخدام [TailOs](https://tails.boum.org/index.fr.html)، وهي توزيعة بدون ذاكرة يمكن تشغيلها من محرك أقراص USB. بمجرد أن تكون في الوحدة النهائية، أدخل الأمر `echo <binary number> | shasum -a 254 -0`. استبدل `<binary number>` بقائمتك المكونة من 128 صفرًا وواحدًا. الناتج هو تجزئة عشرية عشري عشري. احتفظ بالحرف الأول من هذه التجزئة وقم بتحويله إلى ثنائي. يمكنك استخدام هذا [الجدول](https://www.educative.io/answers/decimal-binary-and-hex-conversion-table) للمساعدة. أضف الفحص الثنائي (4 أرقام) إلى الصف الثاني عشر من ورقتك.

**الخطوة 5 - التحويل إلى عشري:**
للعثور على الكلمات المرتبطة بكل سطر، تحتاج أولاً إلى تحويل كل سلسلة من 11 بت إلى عشري. هنا لا يمكنك استخدام محول عبر الإنترنت لأن هذه البتات تمثل عبارة الذاكرة. لذا ستحتاج إلى التحويل باستخدام آلة حاسبة وخدعة على النحو التالي: يتم ربط كل بت بقوة 2، لذا من اليسار إلى اليمين لدينا 11 رتبة تتوافق مع 1024 و 512 و 256 و 128 و 64 و 32 و 16 و 8 و 4 و 2 و 1. لتحويل سلسلة البتات الخاصة بك إلى عشري، تحتاج فقط إلى جمع الرتب التي تحتوي على 1. على سبيل المثال، بالنسبة لسلسلة 00110111011، يتوافق هذا مع الجمع التالي: 256 + 128 + 32 + 16 + 8 + 2 + 1 = 443. يمكنك الآن تحويل كل سطر إلى عشري. وقبل الانتقال إلى الترميز إلى كلمات، تحتاج إلى إضافة +1 إلى جميع الأسطر لأن فهرس قائمة الكلمات BIP39 يبدأ من 1 وليس 0.

**الخطوة 8 - إنشاء عبارة الذاكرة:**
ابدأ بطباعة [قائمة الكلمات المكونة من 2048 كلمة](https://seedxor.com/files/wordlist.pdf) للتحويل بين أرقامك العشرية وكلمات BIP39. غرابة هذه القائمة هي أنه لا يوجد كلمة لها نفس الحروف الأولى الأربعة مشتركة مع جميع الكلمات الأخرى في هذا القاموس. ثم، لكل سطر، ابحث عن الكلمة المرتبطة بالرقم العشري.

**الخطوة 9 - اختبار عبارة الذاكرة:**
قم بفحص عبارة الذاكرة الخاصة بك على Sparrow Wallet عن طريق إنشاء محفظة منها. إذا حصلت على خطأ في الفحص السليم، فمن المحتمل أنك comitted خطأ في الحساب. قم بتصحيح هذا الخطأ عن طريق العودة إلى الخطوة 4 واختباره مرة أخرى على Sparrow Wallet. هنا تذهب! لقد قمت للتو بإنشاء محفظة بيتكوين جديدة من 128 رمية للنرد.

إن إنشاء عبارة ذاكرة هو عملية مهمة لتأمين محفظة العملة الرقمية الخاصة بك. من المستحسن استخدام طرق أكثر أمانًا، مثل استخدام برامج مفتوحة المصدر أو محافظ الأجهزة، لإنشاء عبارة الذاكرة. ومع ذلك، إكمال هذه الورشة يساعد في فهم أفضل لكيفية إنشاء محفظة بيتكوين من رقم عشوائي.

## الاستنتاج والنهاية

### الشكر واستمرار الحفر في حفرة الأرنب

نود أن نشكركم بصدق على حضور تدريب Crypto 301. نأمل أن يكون هذا الخبرة غنية وتعليمية بالنسبة لك. لقد تناولنا العديد من المواضيع المثيرة، بدءًا من الرياضيات إلى علم التشفير إلى آلية عمل بروتوكول بيتكوين.
إذا كنت ترغب في التعمق أكثر في الموضوع، لدينا مصدر إضافي يمكننا أن نقدمه لك. لقد أجرينا مقابلة حصرية مع ثيو بانتاميس ولويك موريل، خبيرين مشهورين في مجال التشفير. تستكشف هذه المقابلة جوانب مختلفة من الموضوع وتقدم وجهات نظر مثيرة للاهتمام.

لا تتردد في مشاهدة هذه المقابلة لمواصلة استكشاف مجال التشفير الشيق. نأمل أن تكون مفيدة وملهمة في رحلتك. مرة أخرى، شكرا لمشاركتك والتزامك طوال هذا التدريب.

### ادعمنا

تم توفير هذه الدورة، جنبًا إلى جنب مع جميع المحتوى المتاح في هذه الجامعة، لك مجانًا من قبل مجتمعنا. لدعمنا، يمكنك مشاركتها مع الآخرين، وأن تصبح عضوًا في الجامعة، وحتى المساهمة في تطويرها عبر GitHub. نيابة عن الفريق بأكمله، شكرا لك!

### قيم التدريب

سيتم قريبًا دمج نظام تقييم للتدريب في هذه المنصة التعليمية الجديدة! في الوقت الحالي، شكرا جزيلا لك على اتخاذ الدورة، وإذا كنت استمتعت بها، يرجى النظر في مشاركتها مع الآخرين.
