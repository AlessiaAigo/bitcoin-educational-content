# مقدمة في علم التشفير

الهدف: فهم إنشاء محفظة بيتكوين من وجهة نظر التشفير
الأهداف:
- تبسيط مصطلحات التشفير المرتبطة ببيتكوين.
- إتقان إنشاء محفظة بيتكوين.
- فهم هيكل محفظة بيتكوين.
- فهم العناوين ومسار الاشتقاق.

# رحلة إلى قلب التشفير

هل أنت مفتون ببيتكوين؟ هل تتساءل كيف يعمل محفظة بيتكوين؟ استعد للانطلاق في رحلة شيقة إلى قلب التشفير! سيقوم خبيرنا لويك بإرشادك عبر ألغاز إنشاء محفظة بيتكوين، كاشفًا الأسرار وراء المصطلحات التقنية المرعبة مثل التجزئة، واشتقاق المفاتيح، والمنحنيات البيضاوية.

سوف تزودك هذه الدورة ليس فقط بالمعرفة لفهم هيكل محفظة بيتكوين، ولكنها ستجهزك أيضًا للغوص بعمق في عالم التشفير المثير. إذاً، هل أنت مستعد للشروع في هذه الرحلة؟ انضم إلينا وحوّل فضولك إلى مهارة!

+++

# مقدمة

## مقدمة في علم التشفير

### هل هذه الدورة مناسبة لك؟ نعم!

![مقدمة بواسطة Rogzy](https://youtu.be/ul8zU5QWIXg)

نرحب بكم بكل سرور في دورتنا الجديدة بعنوان "Crypto 301: مقدمة في علم التشفير ومحفظة HD"، التي يديرها الخبير لويك موريل. ستغوص هذه الدورة في عالم التشفير الرائع، هذا العلم الأساسي في الرياضيات الذي يضمن تشفير وأمان بياناتك.

في حياتنا اليومية وخاصة في مجال البيتكوين، يلعب التشفير دورًا حاسمًا. المفاهيم المرتبطة به مثل المفاتيح الخاصة والعامة، والعناوين، ومسارات الاشتقاق، والبذرة والانحراف، هي جوهر استخدام وإنشاء محفظة بيتكوين. من خلال هذه الدورة، سيرشدك لويك بالتفصيل حول كيفية إنشاء المفاتيح الخاصة وكيفية ربطها بالعناوين. سيخصص لويك أيضًا ساعة لشرح التفاصيل الرياضية للمنحنى البيضاوي. بالإضافة إلى ذلك، ستفهم لماذا يعتبر استخدام HMAC SHA512 مهمًا لتأمين محفظتك وما هو الفرق بين البذرة والعبارة المذكورة.
الهدف النهائي لهذا التدريب هو تمكينك من فهم العمليات التقنية لإنشاء محفظة عملات رقمية عالية الدقة والأساليب المشفرة المستخدمة. على مر السنين، تطورت محافظ البيتكوين لتصبح أكثر سهولة في الاستخدام وأكثر أمانًا وموحدة بفضل مقترحات تحسين البيتكوين المحددة. سيساعدك لويك في فهم هذه المقترحات لفهم اختيارات مطوري البيتكوين وعلماء الكريبتوغرافيا. مثل جميع التدريبات التي تقدمها جامعتنا، هذا التدريب مجاني تمامًا ومفتوح المصدر. هذا يعني أنه يمكنك استخدامه وإعادة استخدامه بحرية. نحن نتطلع إلى استقبال تعليقاتكم في نهاية هذه الدورة المثيرة.

### الكلمة للأستاذ!

![intro par loïc](https://youtu.be/mwuxXLk4Kws)

مرحبًا بكم جميعًا، أنا لويك موريل، مرشدكم في هذا الاستكشاف التقني للتشفير المستخدم في محافظ البيتكوين.

رحلتنا تبدأ بغوص في أعماق وظائف التجزئة المشفرة. سنقوم معًا بتفكيك أجزاء الخوارزمية الشهيرة SHA256 واستكشاف مختلف الخوارزميات المخصصة للتجزئة.

سنواصل مغامرتنا بفك رموز عالم التوقيعات الرقمية الغامض. ستكتشف كيف يتم تطبيق سحر المنحنيات البيضاوية على هذه التوقيعات، وسنوضح كيفية حساب المفتاح العام من المفتاح الخاص. وبالطبع، سنناقش عملية التوقيع الرقمي.

ثم، سنعود في الزمن لنرى تطور محافظ البيتكوين، وسنستكشف مفاهيم الانحراف والأرقام العشوائية. سنستعرض العبارة المذكورة بشكل مشهور، مع فتح قوس على العبارة السرية. ستحصل حتى على فرصة فريدة لإنشاء بذرة من خلال إلقاء النرد 128 مرة!

بعد اكتساب هذه الأساسيات القوية، سنكون جاهزين للجزء الحاسم: إنشاء محفظة البيتكوين. من ولادة البذرة والمفتاح الرئيسي، مرورًا بدراسة المفاتيح الموسعة، وصولًا إلى تجزئة أزواج المفاتيح الفرعية، سيتم تحليل كل خطوة. سنناقش أيضًا هيكل المحفظة ومسارات التجزئة.

وفي ختام الأمر، سننهي رحلتنا بدراسة عناوين البيتكوين. سنشرح كيفية إنشائها وكيفية أداء دور أساسي في عمل محافظ البيتكوين.

انطلق معي في هذه الرحلة المثيرة، واستعد لاستكشاف عالم التشفير كما لم تفعل من قبل. اترك تصوراتك عند الباب وافتح عقلك لطريقة جديدة لفهم البيتكوين وهيكله الأساسي.

# وظائف التجزئة

## مقدمة إلى وظائف التجزئة المشفرة المتعلقة بالبيتكوين

مرحبًا بكم في جلستنا اليوم المخصصة للغوص العميق في عالم التشفير لوظائف التجزئة، وهي أساس أمن بروتوكول بيتكوين. تخيل وظيفة التجزئة كروبوت فك تشفير فعال للغاية يحول المعلومات بأحجام مختلفة إلى بصمة رقمية فريدة وثابتة الحجم تسمى "تجزئة" أو "بصمة" أو "ملخص".

باختصار، تأخذ وظيفة التجزئة مدخلاً من رسالة بحجم تعسفي وتحوله إلى بصمة ثابتة الحجم كمخرج.

يتطلب وصف ملامح وظائف التجزئة التشفيرية فهم اثنتين من الصفات الأساسية: عدم القابلية للعكس ومقاومتها للتزوير.

عدم القابلية للعكس أو مقاومة الصورة الأولى هو حقيقة أنه يمكن بسهولة حساب المخرج عند معرفة المدخل، ولكن من المستحيل حساب المدخل عند معرفة المخرج. إنها وظيفة ذات اتجاه واحد.

مقاومة التزوير تأتي من حقيقة أن أدنى تعديل في المدخل سيؤدي إلى مخرج مختلف تمامًا. تسمح هذه الوظائف بالتحقق من سلامة البرامج التي تم تنزيلها.

ميزة أخرى حاسمة لهذه الوظائف هي مقاومتها للتصادمات والصورة الثانية. التصادم هو حقيقة أن مدخلين مختلفين يعطيان نفس المخرج. بالطبع، في عالم التجزئة، التصادمات لا يمكن تجنبها، ولكن وظيفة التجزئة التشفيرية الممتازة تقللها بشكل كبير. يجب أن يكون الخطر ضئيلًا لدرجة يمكن اعتبارها صفر. فهي تشبه كل تجزئة بمنزل في مدينة ضخمة؛ على الرغم من العدد الهائل من المنازل، تضمن وظيفة التجزئة الجيدة أن لكل منزل عنوانًا فريدًا.

مقاومة الصورة الثانية تعتمد على مقاومة التصادمات؛ إذا كان هناك مقاومة للتصادمات، فإن هناك مقاومة للصورة الثانية. بناءً على المعلومات المدخلة المفروضة علينا، يجب أن نجد مدخلًا ثانيًا مختلفًا عن الأولى يعطي تصادمًا في تجزئة الناتج من الوظيفة. مقاومة الصورة الثانية مشابهة لمقاومة التصادمات باستثناء حقيقة أن المدخل مفروض عليه.

لنبحر الآن في أمواج وظائف التجزئة القديمة. يُعتبر SHA0 وSHA1 وMD5 اليوم أغلفة متهالكة في محيط التجزئة التشفيرية. غالبًا ما يُنصح بعدم استخدامها لأنها فقدت مقاومتها للاصطدامات. يشرح مبدأ الأدراج لماذا، على الرغم من أفضل جهودنا، فإن تجنب الاصطدامات أمر مستحيل بسبب قيود حجم الإخراج. لتُعتبر وظيفة تجزئة آمنة حقًا، يجب أن تكون مقاومة للاصطدامات والصورة الثانية والصورة الأولى.
كعنصر رئيسي في بروتوكول بيتكوين، تعتبر وظيفة التجزئة SHA-256 قائد السفينة. تُستخدم وظائف أخرى مثل SHA-512 للاشتقاق باستخدام HMAC و PBKDF. بالإضافة إلى ذلك، يتم استخدام RIPMD160 لتقليل البصمة إلى 160 بتًا. عندما نتحدث عن HASH256 و HASH160، نشير إلى استخدام التجزئة المزدوجة باستخدام SHA-256 و RIPMD.

بالنسبة لـ HASH256، فإنه يتعلق بتجزئة مزدوجة للرسالة باستخدام وظيفة SHA256.
$$
SHA256(SHA256(message))
$$
بالنسبة لـ HASH160، فإنه يتعلق بتجزئة مزدوجة للرسالة باستخدام وظيفة SHA256 ثم RIPMD160.
$$
RIPMD160(SHA256(message))
$$
يعتبر استخدام HASH160 مفيدًا بشكل خاص لأنه يتيح الاستفادة من أمان SHA-256 مع تقليل حجم البصمة.

لتلخيصها، الهدف النهائي لوظيفة التجزئة التشفيرية هو تحويل معلومات ذات حجم تعسفي إلى بصمة ذات حجم ثابت. لتُعترف كآمنة، يجب أن تكون لوظيفة التجزئة عدة خصائص: عدم القابلية للعكس، ومقاومة التزوير، ومقاومة الاصطدامات، ومقاومة الصورة الثانية.

بعد هذا الاستكشاف، قمنا بفك رموز وظائف التجزئة التشفيرية، وأبرزنا استخداماتها في بروتوكول بيتكوين، وفحصنا أهدافها المحددة. تعلمنا أنه لكي تُعتبر آمنة، يجب أن تكون وظائف التجزئة مقاومة للصورة الأولى والصورة الثانية والاصطدامات والتزوير. كما قمنا بتصفح مجموعة متنوعة من وظائف التجزئة المستخدمة في بروتوكول بيتكوين. في جلستنا القادمة، سنغوص في جوهر وظيفة التجزئة SHA256 ونكتشف الرياضيات الساحرة التي تمنحها خصائصها الفريدة.

## آلية عمل SHA256

![آلية عمل SHA256](https://youtu.be/74SWg_ZbUj4)

مرحبًا بك في جزءنا المثير من رحلتنا عبر المتاهات التشفيرية لوظيفة التجزئة. اليوم، سنكشف الستار عن أسرار SHA256، وهي عملية معقدة ولكنها بارعة، قد قدمناها سابقًا.
للتذكير، الهدف من وظيفة التجزئة SHA256 هو أن تأخذ رسالة بأي حجم كمدخل وتولد هاش بطول 256 بت كنتيجة.
### المعالجة المسبقة

لنتقدم خطوة أخرى في هذا المتاهة، بدءًا من المعالجة المسبقة لـ SHA256.

#### بتات التعبئة

الهدف من هذه الخطوة الأولى هو الحصول على رسالة معادلة بمضاعفات 512 بت. للقيام بذلك، سنقوم بإضافة بتات تعبئة إلى الرسالة.

لنفترض أن M هو حجم الرسالة الأصلي.
لنفترض أن 1 هو بت محجوز للفاصل.
لنفترض أن P هو عدد البتات المستخدمة للتعبئة و 64 هو عدد البتات المحجوزة للمرحلة الثانية من المعالجة المسبقة.
يجب أن يكون المجموع مضاعفًا لـ 512 بت، وهذا ما يمثله n.

![image](assets/image/section1/3.JPG)

مثال مع رسالة مدخل بطول 950 بت:

```
الخطوة 1: تحديد الحجم؛ عدد البتات المثالي النهائي.
أول مضاعف لـ 512 > (M + 64 + 1) (باستخدام M = 950) هو 1024.
1024 = 2 * 512
لذلك n = 2.

الخطوة 2: تحديد P، عدد بتات التعبئة اللازمة للوصول إلى الحجم المثالي النهائي.
-> M + 1 + P + 64 = n * 512
-> M + 1 + P + 64 = 2 * 512
-> 940 + 1 + P + 64 = 1024
-> P = 1024 - 1 - 64 - 950
-> P = 9

لذا يجب إضافة 9 بتات تعبئة للحصول على رسالة معادلة بمضاعفات 512.
```

والآن؟
مباشرة بعد الرسالة الأصلية، يجب إضافة الفاصل 1 تليه P والذي في مثالنا هو تسعة 0.

```
الرسالة + 1 000 000 000
```

#### تعبئة الحجم

ننتقل الآن إلى المرحلة الثانية من المعالجة المسبقة، والتي تنطوي على إضافة التمثيل الثنائي لحجم الرسالة الأصلية، بالبتات.

لنستخدم مثالًا مع مدخل بطول 950 بت:

```
التمثيل الثنائي للرقم 950 هو: 11 1011 0110

نستخدم 64 بتًا محجوزة في الخطوة السابقة. نضيف أصفارًا لتكملة 64 بتًا لمدخلنا المعادل. ثم ندمج الرسالة الأصلية وتعبئة البتات وتعبئة الحجم معًا للحصول على مدخلنا المعادل.
```

هذه هي النتيجة:

![image](assets/image/section1/4.JPG)

### المعالجة

#### متطلبات الفهم

##### الثوابت والمتجهات الأولية
في الوقت الحالي، نحن نستعد للخطوات الأولى في معالجة وظيفة SHA-256. كما هو الحال في أي وصفة جيدة، نحتاج إلى بعض المكونات الأساسية، التي نسميها الثوابت ومتجهات البدء.

متجهات البدء، من A إلى H، هي أول 32 بتًا من الأجزاء العشرية للجذور التربيعية لأول 8 أعداد أولية. ستستخدم كقيم أساسية في الخطوات الأولى من المعالجة. قيمها بتنسيق السداسي عشري.

الثوابت K، من 0 إلى 63، تمثل أول 32 بتًا من الأجزاء العشرية للجذور التكعيبية لأول 64 عددًا أوليًا. يتم استخدامها في كل دورة من وظيفة الضغط. قيمها أيضًا بتنسيق السداسي عشري.

![image](assets/image/section1/5.JPG)

##### العمليات المستخدمة

في وظيفة الضغط، نستخدم عمليات محددة مثل XOR وAND وNOT. نعالج البتات واحدًا تلو الآخر وفقًا لترتيبها، باستخدام عملية XOR وجدول حقيقة. يتم استخدام عملية AND لإرجاع 1 فقط إذا كانت العمليات المشغلة متساوية بـ 1، ويتم استخدام عملية NOT لإرجاع القيمة المعاكسة للعملية المشغلة. نستخدم أيضًا عملية SHR لتحريك البتات نحو اليمين بعدد محدد.

جدول الحقيقة:

![image](assets/image/section1/6.JPG)

عمليات تحريك البتات:

![image](assets/image/section1/7.JPG)

#### وظيفة الضغط

قبل تطبيق وظيفة الضغط، نقسم المدخل إلى كتل بحجم 512 بت. سيتم معالجة كل كتلة بشكل مستقل عن الأخرى.

ثم يتم تقسيم كل كتلة من 512 بت إلى قطع W بحجم 32 بت. بالطريقة هذه، يمثل W(0) أول 32 بتًا من كتلة 512 بت. ويمثل W(1) الـ 32 بتًا التالية وهكذا حتى نصل إلى 512 بتًا من الكتلة.

بمجرد تعريف جميع الثوابت K وقطع W، يمكننا معالجة الحسابات التالية لكل قطعة W في كل دورة.

نقوم بإجراء 64 دورة حسابية في وظيفة الضغط. في الدورة الأخيرة، سيكون لدينا في "مخرج الوظيفة" حالة وسيطة سيتم إضافتها إلى الحالة الأولية لوظيفة الضغط.

ثم نكرر كل هذه الخطوات في وظيفة الضغط على الكتلة التالية من 512 بت، حتى الكتلة الأخيرة.

جميع الإضافات في وظيفة الضغط هي إضافات بقسمة 2^32 للحفاظ دائمًا على مجموع بحجم 32 بت.

![image](assets/image/section1/9.JPG)

![image](assets/image/section1/8.JPG)

##### دورة واحدة من وظيفة الضغط

![image](assets/image/section1/11.JPG)

![image](assets/image/section1/10.JPG)
سيتم تنفيذ دورة وظيفة الضغط 64 مرة. سنجد في المدخل قطعنا W وثوابتنا K التي تم تعريفها سابقًا.
المربعات / الصلبان الحمراء تمثل جمعًا بقية 2^32 بت.

سيتم تعيين القيم A و B و C و D و E و F و G و H إلى قيمة 32 بت لتشكيل إجمالي 32 * 8 = 256 بت.
سنجد أيضًا في الناتج سلسلة جديدة A و B و C و D و E و F و G و H. سيتم استخدام هذا الناتج كمدخل في الدورة التالية وهكذا حتى نهاية الدورة 64.

قيم سلسلة المدخلات في الدورة الأولى لوظيفة الضغط تتوافق مع القيم المبدئية المحددة سابقًا.
للتذكير ، تمثل القيم المبدئية البتات الـ 32 الأولى من الأجزاء العشرية لجذور التربيع لأول 8 أعداد أولية.

هنا مثال لدورة:

![صورة](assets/image/section1/12.1.png)

##### الحالة الوسيطة

للتذكير ، يتم تقسيم الرسالة إلى كتل بحجم 512 بت ثم تقسيمها إلى قطع بحجم 32 بت. لكل كتلة من 512 بت ، نقوم بتطبيق 64 دورة من وظيفة الضغط.
الحالة الوسيطة تتوافق مع نهاية الدورة 64 للكتلة. يتم استخدام قيم الناتج من هذه الدورة الـ 64 كقيم ابتدائية للدورة الأولى للكتلة التالية.

![صورة](assets/image/section1/12.2.png)

#### نظرة عامة على وظيفة التجزئة

![صورة](assets/image/section1/13.JPG)

سنلاحظ أن الناتج من الجزء الأول من الرسالة بحجم 512 بت يتوافق مع قيم البدء الخاصة بنا في الجزء الثاني من الرسالة ، وهكذا.

ناتج الدورة الأخيرة ، من الجزء الأخير ، يتوافق مع النتيجة النهائية لوظيفة SHA256.

لنختم ، نود أن نشدد على الدور الحاسم الذي تلعبه العمليات المجراة في صناديق CH و MAJ و σ0 و σ1. هذه العمليات ، بين عمليات أخرى ، هي الحراس الذين يضمنون قوة وظيفة التجزئة SHA256 ضد الهجمات ، مما يجعلها خيارًا مفضلًا لتأمين العديد من الأنظمة الرقمية ، بما في ذلك بروتوكول بيتكوين. لذلك فمن الواضح أن جمالية SHA256 تكمن في قوتها في استعادة المدخلات من الهاش ، بينما يعد التحقق من الهاش لإدخال معين عملية بسيطة ميكانيكيًا.

## الخوارزميات المستخدمة للتشتيت

![الخوارزميات المستخدمة للتشتيت](https://youtu.be/ZF1_BMsOJXc)

خوارزميات التشتيت HMAC و PBKDF2 هي مكونات رئيسية في آلية أمان بروتوكول بيتكوين. تمنع هذه الخوارزميات مجموعة متنوعة من الهجمات المحتملة وتضمن سلامة محافظ بيتكوين.
HMAC و PBKDF2 هما أدوات تشفير تستخدم في مهام مختلفة في بيتكوين. يتم استخدام HMAC بشكل رئيسي لمكافحة هجمات تمديد الطول أثناء استخراج المحافظ المحددة بشكل تسلسلي (HD) ، بينما يتم استخدام PBKDF2 لتحويل عبارة مذكرة إلى بذرة.

#### HMAC-SHA512

يتميز HMAC-SHA512 بوجود إدخالين: رسالة m (الإدخال 1) ومفتاح K المختار بشكل تعسفي من قبل المستخدم (الإدخال 2).
لديه أيضًا إخراج ثابت الحجم: 512 بت

```
لنلاحظ:
- m: رسالة ذات حجم تعسفي مختارة من قبل المستخدم (الإدخال 1)
- K: مفتاح مختار بشكل تعسفي من قبل المستخدم (الإدخال 2)
- K ': المفتاح K المعادل. تم ضبطه ليكون بحجم B للكتل.
- ||: عملية الدمج.
- opad: ثابت محدد بواسطة البايت 0x5c مكرر B مرات.
- ipad: ثابت محدد بواسطة البايت 0x36 مكرر B مرات.
- B: حجم كتلة وظيفة التجزئة المستخدمة.
```

![image](assets/image/section1/14.JPG)

يقوم HMAC-SHA512 ، الذي يأخذ رسالة ومفتاح كإدخالات ، بتوليد إخراج ثابت الحجم. لضمان التوحيد ، يتم ضبط المفتاح بناءً على حجم الكتل المستخدمة في وظيفة التجزئة. في سياق استخراج المحافظ HD ، يتم استخدام HMAC-SHA-512. يعمل هذا الأخير مع كتل بحجم 1024 بت (128 بايت) ويضبط المفتاح وفقًا لذلك. يستخدم الثوابت OPAD (0x5c) و IPAD (0x36) ، المكررة بقدر اللازم لتعزيز الأمان.

ينطوي عملية HMAC-SHA-512 على دمج نتيجة SHA-512 المطبقة على مفتاح XOR OPAD ومفتاح XOR IPAD مع الرسالة. عند استخدام كتل بحجم 1024 بت (128 بايت) ، يتم استكمال المفتاح الإدخال بالأصفار إذا لزم الأمر ، ثم يتم إجراء عملية XOR مع IPAD و OPAD. يتم بعد ذلك دمج المفتاح المعدل هكذا مع الرسالة.

![image](assets/image/section1/15.JPG)

يزيد رمز السلسلة من أمان المفاتيح المشتقة من خلال إدخال مصدر إضافي للانتروبيا. بدونه ، يمكن للهجوم المعلوماتي المتقدم التهديد بالاستيلاء على المحفظة بأكملها وسرقة جميع البيتكوين.

يتم استخدام PBKDF2 لتحويل عبارة مذكرة إلى بذرة. يقوم هذا الخوارزمية بتنفيذ 2048 دورة باستخدام HMAC SHA512. بفضل هذه الخوارزميات المشتقة ، يمكن أن تعطي إدخالين مختلفين نتيجة فريدة وثابتة ، مما يعالج مشكلة هجمات تمديد الطول المحتملة على وظائف عائلة SHA-2.
هجوم التمديد بطول يستغل خاصية محددة في بعض وظائف التجزئة العملية. في مثل هجوم، يمكن للمهاجم الذي يمتلك بالفعل تجزئة لرسالة غير معروفة استخدامها لحساب تجزئة لرسالة أطول، وهي امتداد للرسالة الأصلية. وغالبًا ما يكون ذلك ممكنًا دون معرفة محتوى الرسالة الأصلية، مما يمكن أن يؤدي إلى ثغرات أمنية كبيرة إذا تم استخدام هذا النوع من وظائف التجزئة لمهام مثل التحقق من النزاهة.
![صورة](assets/image/section1/16.JPG)

في الختام، تلعب خوارزميات HMAC و PBKDF2 أدوارًا حاسمة في أمان استخراج محافظ HD في بروتوكول بيتكوين. يتم استخدام HMAC-SHA-512 للحماية من هجمات التمديد بطول، بينما يسمح PBKDF2 بتحويل العبارة المذكورة إلى بذرة. يضيف رمز السلسلة مصدرًا إضافيًا للانحراف الرئيسي، مما يضمن قوة النظام.

# التوقيعات الرقمية

## التوقيعات الرقمية والمنحنيات البيضاوية

![التوقيعات الرقمية والمنحنيات البيضاوية](https://youtu.be/gOjYiPkx4z8)

أين يتم تخزين هذه البتكوين المشهورة؟ ليس في محفظة بتكوين كما قد يعتقد البعض. في الواقع، تحتفظ محفظة بتكوين بالمفاتيح الخاصة اللازمة لإثبات ملكية البتكوين. تُسجل البتكوين نفسها على سلسلة الكتل، وهي قاعدة بيانات موزعة تحتوي على جميع المعاملات.

في نظام بتكوين، الوحدة النقدية هي البتكوين (لاحظ الحرف "b" الصغير). يمكن تقسيمها إلى ثمانية أرقام عشرية، وأصغر وحدة هي الساتوشي. تمثل UTXO، أو "Unspent Transaction Output"، المخرجات غير المنفقة للمعاملات التي تنتمي إلى مفتاح عام مرتبط رياضيًا بمفتاح خاص. لإنفاق هذه البتكوين، يجب أن يتمكن المستخدم من الاستجابة لشرط الإنفاق في المعاملة. يتمثل الشرط النموذجي للإنفاق في إثبات لبقية الشبكة أن المستخدم هو المالك الشرعي للمفتاح العام المرتبط بـ UTXO. للقيام بذلك، سيحتاج إلى إثبات أنه يمتلك المفتاح الخاص المقابل للمفتاح العام المرتبط بكل UTXO دون الكشف عن المفتاح الخاص.

هذا ما يتيحه التوقيع الرقمي. إنه يعمل كدليل رياضي يثبت ملكية المفتاح الخاص المرتبط بمفتاح عام محدد. تعتمد هذه التقنية لحماية البيانات بشكل أساسي على مجال مثير للإعجاب في علم التشفير يُسمى التشفير على المنحنيات البيضاوية (ECC).

يمكن التحقق من التوقيع رياضيًا من قبل الأطراف الأخرى في شبكة بتكوين.

![صورة](assets/image/section2/0.JPG)
لضمان أمان المعاملات، يستخدم بيتكوين اثنين من بروتوكولات التوقيع الرقمي: ECDSA (Elliptic Curve Digital Signature Algorithm) و Schnorr. يعتبر ECDSA بروتوكول توقيع مدمج في بيتكوين منذ إطلاقه في عام 2009، بينما تمت إضافة توقيعات Schnorr مؤخرًا في نوفمبر 2021. على الرغم من أن هذين البروتوكولين يعتمدان على التشفير بواسطة المنحنيات البيضاوية ويستخدمان آليات رياضية مماثلة، إلا أنهما يختلفان بشكل رئيسي من حيث هيكل التوقيع.
في هذا الدرس، سنقدم خوارزمية ECDSA.

### ما هي المنحنى البيضاوي؟

التشفير بواسطة المنحنى البيضاوي هو مجموعة من الخوارزميات التي تستخدم منحنى بيضاوي لخصائصها الهندسية والرياضية المختلفة في العمليات التشفيرية، وتعتمد أمانيتها على صعوبة حساب اللوغاريتم التفاضلي.

المنحنيات البيضاوية مفيدة في مجموعة متنوعة من التطبيقات التشفيرية في بروتوكول بيتكوين، بدءًا من تبادل المفاتيح إلى التشفير غير المتماثل والتوقيعات الرقمية.

للمنحنيات البيضاوية خصائص مثيرة للاهتمام:

- التماثل: أي خط غير عمودي يقطع نقطتين على المنحنى البيضاوي، سيقطع المنحنى في نقطة ثالثة.
- أي خط غير عمودي ومماس للمنحنى في نقطة، سيقطع المنحنى دائمًا في نقطة ثانية فريدة.

يستخدم بروتوكول بيتكوين منحنى بيضاوي محدد يسمى Secp256k1 لأداء العمليات التشفيرية. 

قبل الانغماس في هذه آليات التوقيع بشكل أعمق، من المهم فهم ما هو المنحنى البيضاوي بشكل جيد. يتم تعريف المنحنى البيضاوي بالمعادلة y² = x³ + ax + b. كل نقطة على هذا المنحنى لها تماثل مميز هو مفتاح فائدتها في التشفير.

![image](assets/image/section2/1.JPG)

في النهاية، يتم اعتراف بمجموعة متنوعة من المنحنيات البيضاوية كمناسبة للاستخدام التشفيري. الأكثر شهرة ربما تكون المنحنى secp256r1. ومع ذلك، اختار ساتوشي ناكاموتو منحنى آخر لبيتكوين: secp256k1.

يتم تعريف هذا المنحنى بواسطة المعاملات a=0 و b=7، ومعادلته هي y² = x³ + 7 بالنسبة للمودولو n، حيث يمثل n العدد الأولي الذي يحدد ترتيب المنحنى.

![image](assets/image/section2/2.JPG)

الصورة الأولى تمثل المنحنى secp256k1 على مجال الأعداد الحقيقية ومعادلته. 
الصورة الثانية هي تمثيل للمنحنى secp256k1 على مجال ZP، مجال الأعداد الطبيعية والموجبة، مودولو p حيث p هو عدد أولي. يشبه هذا الشكل سحابة من النقاط. نستخدم هذا المجال لتجنب التقريبات.
p هو عدد أولي، وهو ترتيب المنحنى المستخدم.
أخيرًا ، المعادلة المستخدمة في بروتوكول بيتكوين هي:
$$
y^2 = (x^3 + 7) mod(p)
$$
معادلة المنحنى البيضاوي في بيتكوين تتوافق مع المعادلة الأخيرة في الصورة السابقة.

في القسم التالي من هذه الدورة ، سنستخدم منحنيات موجودة في مجال الأعداد الحقيقية فقط لتسهيل الفهم.

### حساب المفتاح العام من المفتاح الخاص

![Calculer la clé publique depuis la clé privée](https://youtu.be/NJENwFU889Y)

لنبدأ ، دعونا نغوص في عالم خوارزمية توقيع المنحنى البيضاوي الرقمي (ECDSA). يستخدم بيتكوين هذا الخوارزمية لربط المفاتيح الخاصة والعامة. في هذا النظام ، المفتاح الخاص هو عدد عشوائي أو شبه عشوائي مكون من 256 بت. إجمالي عدد الاحتمالات للمفتاح الخاص هو نظرياً 2^256 ، ولكنه أقل بقليل في الواقع. لكي تكون صالحة لبيتكوين ، يجب أن يكون المفتاح الخاص بين 1 و n-1 ، حيث n هو ترتيب المنحنى البيضاوي. هذا يعني أن إجمالي عدد الاحتمالات للمفتاح الخاص في بيتكوين يكاد يكون مساويًا لـ 1.158 × 10^77. لوضع هذا في السياق ، فإنه يقريبًا نفس عدد الذرات الموجودة في الكون المرئي.

المفتاح الخاص الفريد ، المشار إليه بـ k ، يُستخدم بعد ذلك لتحديد المفتاح العام.

المفتاح العام ، المشار إليه بـ K ، هو نقطة على المنحنى البيضاوي المشتقة من المفتاح الخاص باستخدام خوارزميات لا يمكن عكسها مثل ECDSA. عندما نعرف المفتاح الخاص ، فإنه من السهل جدًا استعادة المفتاح العام ، ولكن عندما نمتلك فقط المفتاح العام ، فمن المستحيل استعادة المفتاح الخاص. هذا اللاعكسية هو الأساس الأساسي لأمان محفظة بيتكوين.

يتكون المفتاح العام من 512 بت لأنه يتوافق مع نقطة على المنحنى بإحداثيات x بطول 256 بت وإحداثيات y بطول 256 بت. ومع ذلك ، يمكن ضغطه إلى عدد من 264 بت.

نقطة المولد (G) هي النقطة على المنحنى التي يتم إنشاء جميع المفاتيح العامة منها في بروتوكول بيتكوين. لها إحداثيات x و y محددة ، عادة ما تكون ممثلة بالنظام الست عشري. بالنسبة لـ secp256k1 ، فإن إحداثيات G هي ، بالنظام الست عشري:

- `Gx = 79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798`
- `Gy = 483ADA77 26A3C465 5DA4FBFC 0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8`
هذه النقطة مفيدة لاستنتاج جميع المفاتيح العامة. لحساب المفتاح العام K، يكفي ضرب النقطة G بالمفتاح الخاص k، كما يلي: K = k.G

سندرس الآن كيفية جمع وضرب النقاط على المنحنيات البيضوية.

#### جمع وضرب النقاط على المنحنيات البيضوية

##### جمع نقطتين M + L

إحدى الخصائص المميزة للمنحنيات البيضوية هي أن خطًا غير عمودي يقاطع المنحنى في نقطتين سيقاطعه أيضًا في نقطة ثالثة، تسمى النقطة O في مثالنا. يتم استخدام هذه الخاصية لتحديد النقطة U، وهي النقطة المعاكسة للنقطة O.

M + L = U

![image](assets/image/section2/5.JPG)

##### جمع نقطة بنفسه = ضعف النقطة

يتم جمع النقطة G بنفسها عن طريق رسم خط مماس للمنحنى عند هذه النقطة. ووفقًا لخصائص المنحنيات البيضوية، سيتقاطع هذا المماس المنحنى بنقطة ثانية فريدة -J. النقطة المعاكسة لهذه النقطة، J، هي نتيجة جمع النقطة G بنفسها.
G + G = J

بالمناسبة، تعتبر النقطة G نقطة البداية لحساب جميع المفاتيح العامة لمستخدمي نظام بيتكوين.

![image](assets/image/section2/6.JPG)

#### الضرب النقطي على المنحنيات البيضوية

ضرب نقطة بـ n يعني إضافة هذه النقطة إلى نفسها n مرة.

بنفس الطريقة التي يتم فيها ضعف النقطة، يتم ضرب النقطة G بنقطة n عن طريق رسم خط مماس للمنحنى عند النقطة G. ووفقًا لخصائص المنحنيات البيضوية، سيتقاطع هذا المماس المنحنى بنقطة ثانية فريدة -2G. النقطة المعاكسة لهذه النقطة، 2G، هي نتيجة جمع النقطة G بنفسها.

إذا كانت n = 4، فسيتم تكرار العملية حتى الوصول إلى 4G.

![image](assets/image/section2/7.JPG)

فيما يلي مثال على حساب 3G:

![image](assets/image/section2/8.JPG)

هذه العمليات على نقاط المنحنى البيضوي هي أساس حساب المفاتيح العامة. إن استنتاج المفتاح العام عند معرفة المفتاح الخاص أمر سهل جدًا.
المفتاح العام هو نقطة على المنحنى البيضوي، وهو نتيجة جمع وضعف النقطة G k مرة. حيث k هو المفتاح الخاص.

في هذا المثال:

- المفتاح الخاص k = 4
- المفتاح العام K = kG = 4G

![image](assets/image/section2/9.JPG)
باستخدام المفتاح الخاص k، يمكن بسهولة حساب المفتاح العام K. ومن الصعب جدًا استعادة المفتاح الخاص بناءً على المفتاح العام. هل هذا نتيجة لعملية جمع أم ضعف النقطة؟
في الدرس القادم، سنستكشف كيفية إجراء توقيع رقمي باستخدام خوارزمية ECDSA بمفتاح خاص لإنفاق البيتكوين.

## التوقيع باستخدام المفتاح الخاص

![Signer avec la clé privée](https://youtu.be/h2hIyGgPqkM)

عملية التوقيع الرقمي هي طريقة رئيسية لإثبات أنك حامل لمفتاح خاص دون الحاجة إلى الكشف عنه. يتم ذلك باستخدام خوارزمية ECDSA، والتي تشمل تحديد nonce فريد، وحساب رقم محدد V، وإنشاء توقيع رقمي مكون من جزأين، S1 و S2.
من المهم دائمًا استخدام nonce فريد لتجنب هجمات الأمان. مثال شهير على ما يمكن أن يحدث عند عدم احترام هذا القاعدة هو قضية اختراق جهاز PlayStation 3، الذي تم اختراقه بسبب إعادة استخدام nonce.

![](assets/image/section2/10.JPG)

الخطوات:

- تحديد nonce v، أي عدد فريد عشوائي.
  Nonce = Number Only Use Once.
  يتم تحديده من قبل الشخص الذي يقوم بالتوقيع.
- حساب النقطة V عن طريق جمع وضعف النقطة على المنحنى البيضاوي من النقطة G، وهي موضع V على المنحنى البيضاوي.
  مثل V = v.G
  x و y هما إحداثيات V على المستوى.
- حساب S1.
  S1 = x mod n حيث n هو ترتيب المنحنى و x إحداثية V على المستوى.
  ملاحظة: عدد إمكانيات المفتاح العام أكبر من عدد النقاط على المنحنى البيضاوي في الجسم النهائي للأعداد الصحيحة المستخدم في بيتكوين.
  ترتيب المنحنى يتوافق فقط مع الإمكانيات التي يمكن أن يأخذها المفتاح العام على المنحنى.
- حساب S2.
  H(Tx) = هاش للمعاملة
  k = المفتاح الخاص
- حساب التوقيع: اتحاد S1 + S2.
- حساب P، عملية التحقق من التوقيع.
  K = المفتاح العام

على سبيل المثال، للحصول على المفتاح العام 3G، يتم رسم مماس للنقطة G، وحساب العكس -G للحصول على 2G، ثم جمع G و 2G. لإجراء عملية تحويل، يجب عليك إثبات أنك تعرف العدد 3 عن طريق فتح البيتكوين المرتبطة بالمفتاح العام 3G.
لإنشاء توقيع رقمي وإثبات أنك تعرف المفتاح الخاص المرتبط بالمفتاح العام 3G، يتعين عليك أولاً حساب قيمة عشوائية غير متكررة (nonce)، ثم حساب النقطة V المرتبطة بهذه القيمة (في المثال المعطى، هي 4G). بعد ذلك، يتعين عليك حساب النقطة T عن طريق جمع المفتاح العام 3G والنقطة V، مما يعطي 7G.
![image](assets/image/section2/11.JPG)

لنبسط عملية التوقيع الرقمي.
في الصورة السابقة، المفتاح الخاص k = 3.
يمكننا بسهولة حساب المفتاح العام K المرتبط بهذا المفتاح الخاص: K = 3G
ثم، نقوم بتوليد قيمة عشوائية غير متكررة: v = 4.
من هذه القيمة، يمكن حساب النقطة V كالتالي: V = v.G = 4G.

من هذه النقطة V، نحسب النقطة T كالتالي:
T = t.G = 7G (حيث t = 7).

حان الوقت للقيام بالتحقق من التوقيع الرقمي.

التحقق من التوقيع الرقمي هو خطوة حاسمة في استخدام خوارزمية ECDSA، والتي تسمح بتأكيد صحة رسالة موقعة دون الحاجة إلى المفتاح الخاص للمرسل. هنا كيف يتم ذلك بالتفصيل:

في مثالنا، لدينا قيمتان مهمتان: t و V.
t هو قيمة رقمية (7 في هذا المثال)، و V هو نقطة على المنحنى البيضاوي (ممثلة بـ 4G هنا). تم إنتاج هذه القيم عند إنشاء التوقيع الرقمي ومن ثم يتم إرسالها مع الرسالة للسماح بالتحقق.

عندما يستلم المحقق الرسالة، سيتلقى أيضًا هاتين القيمتين، t و V.

فيما يلي الخطوات التي سيراها المحقق للتحقق من التوقيع:

1. سيقوم أولاً بحساب تجزئة الرسالة، والتي سنسميها H.
2. ثم، سيقوم بحساب u1 و u2. للقيام بذلك، سيستخدم الصيغ التالية:
   - u1 = H * (S2)^-1 mod n
   - u2 = T * (S2)^-1 mod n
     حيث S2 هو الجزء الثاني من التوقيع الرقمي، و n هو ترتيب المنحنى البيضاوي، و (S2)^-1 هو العكس المضاعف لـ S2 mod n.
3. سيقوم المحقق بحساب نقطة P' على المنحنى البيضاوي باستخدام الصيغة: P' = u1 * G + u2 * K
   - G هو نقطة توليد المنحنى
   - K هو المفتاح العام للمرسل
4. سيقوم المحقق بحساب I'، وهو ببساطة إحداثي x للنقطة P' بالمودولو n.
5. أخيرًا، سيقوم المحقق بتأكيد أن I' يساوي t. إذا كان الأمر كذلك، يعتبر التوقيع صالحًا. إذا لم يكن الأمر كذلك، فإن التوقيع غير صالح.
تضمن هذه الإجراءات أنه يمكن للشخص الذي يمتلك المفتاح الخاص المقابل فقط أن ينتج توقيعًا يمر بهذه العملية التحقق.
![صورة](assets/image/section2/12.JPG)

لنبسط الأمور:
الشخص الذي ينتج التوقيع سيقدم للشخص الذي يتحقق منه العدد t (في مثالنا ، t = 7) والنقطة V.

من المستحيل تحديد المفتاح العام أو المفتاح الخاص من العدد 7 والعدد V.

خطوات التحقق من التوقيع الرقمي هي كما يلي:

- على المنحنى ، يضيف النقطة من المفتاح العام إلى النقطة V لاستعادة النقطة T'.
- يحسب العدد t.G
- يتحقق مما إذا كانت نتيجة t.G تساوي العدد T'

في الختام ، يعد التحقق من التوقيع الرقمي إجراءً أساسيًا في معاملات بيتكوين. يضمن أن الرسالة الموقعة لم يتم تعديلها أثناء الإرسال وأن المرسل هو حامل المفتاح الخاص. تعتمد هذه التقنية على مبادئ رياضيات معقدة ، بما في ذلك حساب المنحنى البيضاوي ، مع الحفاظ على سرية المفتاح الخاص. إنها توفر أساسًا قويًا للأمان في المعاملات المشفرة.

ومع ذلك ، إدارة هذه المفاتيح ، وإنشاؤها ، هي مسألة أساسية أخرى في بيتكوين. كيفية إنشاء زوج جديد من المفاتيح؟ كيفية تنظيم العديد من المفاتيح بطريقة آمنة وفعالة؟ كيفية استعادتها إذا لزم الأمر؟

للإجابة على هذه الأسئلة وتعميق فهمك لأمان التشفير ، سيتركز الدرس القادم على مفهوم المحفظة التسلسلية المحددة (HD wallets) واستخدام العبارات المذكرة. توفر هذه الآليات وسائل أنيقة لإدارة مفاتيح العملات المشفرة بكفاءة مع تعزيز الأمان.

# العبارة المذكرة

## تطور محافظ بيتكوين

![تطور محافظ بيتكوين](https://youtu.be/6tmu1R9cXyk)

تلعب المحفظة التسلسلية المحددة الهرمية ، أو ما يعرف بالمحفظة HD بشكل شائع ، دورًا مهمًا في نظام العملات المشفرة. قد يبدو مصطلح "المحفظة" مضللاً بالنسبة للمبتدئين في هذا المجال ، حيث لا يتضمن حيازة أموال أو عملات. بل يشير بدلاً من ذلك إلى مجموعة من المفاتيح الخاصة المشفرة.

كانت المحافظ الأولى برامج تجمع بين المفاتيح الخاصة التي تم تحديدها بطريقة شبه عشوائية ولكن ليس لها أي صلة بينها. يُطلق على هذه المحافظ اسم "Just a Bunch Of Keys" (JBOK).

نظرًا لعدم وجود صلة بين المفاتيح ، يجب على المستخدم إجراء نسخة احتياطية جديدة لكل زوج مفاتيح جديد يتم إنشاؤه.
هناك خياران للمستخدم: إما أن يستخدم نفس زوج المفتاح طوال الوقت ويفقد السرية، أو أن يقوم بتوليد زوج جديد من المفاتيح بشكل عشوائي وبالتالي يجب عليه إجراء نسخة احتياطية جديدة لهذه المفاتيح.
![صورة](assets/image/section3/0.JPG)

ومع ذلك، يتم تعويض تعقيد إدارة هذه المفاتيح من خلال مجموعة من البروتوكولات المعروفة باسم اقتراحات تحسين بيتكوين (BIP). هذه الاقتراحات للترقية هي جوهر وظيفة وأمان المحافظ HD. على سبيل المثال، ثورة [BIP32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki) التي تم إطلاقها في عام 2012 في طريقة توليد وتخزين هذه المفاتيح، من خلال إدخال مفهوم المفاتيح المشتقة بشكل محدد وهرمي. الفكرة هي تشتق جميع المفاتيح بشكل محدد وهرمي من معلومة واحدة: البذرة. بالتالي، يتم تبسيط عملية نسخ احتياطي هذه المفاتيح بشكل كبير، مع الحفاظ على مستوى أمانها.

![صورة](assets/image/section3/1.JPG)

ثم، قدم [BIP39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) ابتكارًا ملحوظًا: عبارة تذكرية مكونة من 24 كلمة. سمح هذا النظام بتحويل سلسلة من الأرقام المعقدة والصعبة للتذكر إلى سلسلة من الكلمات العادية، وهو أسهل بكثير للتذكر والتخزين. بالإضافة إلى ذلك، قدم [BIP38](https://github.com/bitcoin/bips/blob/master/bip-0038.mediawiki) فكرة إضافة عبارة سرية إضافية لتعزيز أمان المفاتيح الفردية. أدت هذه التحسينات المتتالية إلى معايير BIP43 و BIP44، التي قامت بتوحيد هيكل وتسلسل المحافظ HD، مما جعل هذه المحافظ أكثر إمكانية الوصول وسهولة الاستخدام للجمهور العام.

في الأقسام التالية، سنتعمق أكثر في كيفية عمل المحافظ HD. سنناقش مبادئ تشتيت المفاتيح وسنستعرض المفاهيم الأساسية للانحراف وتوليد الأرقام العشوائية، والتي تعد أساسية لضمان أمان محفظتك HD.

لتلخيص الأمر، من الضروري التأكيد على الدور المركزي لـ BIP32 و BIP39 في تصميم وتأمين المحافظ HD. تتيح هذه البروتوكولات توليد العديد من المفاتيح من بذرة واحدة، والتي يفترض أن تكون عشوائية أو شبه عشوائية. اليوم، يتم اعتماد هذه المعايير من قبل غالبية محافظ العملات المشفرة، سواء كانت مخصصة لعملة واحدة أو تدعم أنواعًا متعددة من العملات.
أهمية أمان المفاتيح الخاصة في بيئة البيتكوين لا يمكن إنكارها. فهي في الواقع الأساس الذي يضمن أمان عمليات البيتكوين. لتجنب أي ضعف مرتبط بالتنبؤية، يجب أن تتم إنشاء هذه المفاتيح بطريقة حقًا عشوائية، وهو ما يمكن أن يكون مهمة صعبة بسرعة. المشكلة هي أنه في مجال الحوسبة، من المستحيل إنشاء عدد حقًا عشوائي لأنه ينبع بالضرورة من عملية محددة مسبقًا؛ وهو رمز. لذلك، من الضروري الاطلاع على مولدات الأرقام العشوائية المختلفة. تتفاوت أنواع مولدات الأرقام العشوائية، بدءًا من مولدات الأرقام العشوائية شبه العشوائية (PRNG) إلى مولدات الأرقام العشوائية الحقيقية (TRNG)، بالإضافة إلى PRNG التي تدمج مصدر الفوضى.

الفوضى تشير إلى "فوضى" النظام. باستخدام فوضى خارجية، أي مصدر معلومات خارجي، يمكن استخدام مولد الأرقام العشوائية للحصول على عدد عشوائي.

دعونا نتعرف معًا على كيفية عمل مولد الأرقام العشوائية شبه العشوائية (PRNG).

يأخذ المولد البذرة كإدخال، وهي معلومة تتوافق مع الحالة الداخلية 0.
يتم تطبيق وظيفة التحويل على هذه الحالة الداخلية، والنتيجة هي عدد شبه عشوائي يتوافق مع الحالة الداخلية 1.
يتم تطبيق وظيفة التحويل على هذه الحالة الداخلية 1 مرة أخرى، مما يؤدي إلى حصول عدد عشوائي جديد = الحالة الداخلية 2.
وهكذا.

العيب الرئيسي هو أن أي بذرة متطابقة ستعطي نفس النتيجة دائمًا. وأيضًا، إذا كنا نعرف نتائج وظائف التحويل من البداية، فسنكون قادرين على استعادة العدد العشوائي في نهاية العملية.

مثال على وظيفة التحويل هو وظيفة PBKDF2.

**لتلخيص الأمر، يجب أن يكون PRNG آمنًا تشفيريًا على النحو التالي:**

- أن يكون عشوائيًا إحصائيًا
- أن يكون غير قابل للتنبؤ
- أن يكون مقاومًا حتى إذا تم الكشف عن النتائج
- أن يكون لديه فترة كافية

في حالة البيتكوين، يتم إنشاء المفاتيح الخاصة من معلومة واحدة فقط في أساس المحفظة. تسمح هذه المعلومة بتشتيت محدد وتسلسلي لأزواج المفاتيح الفرعية. الفوضى هي أساس كل محفظة HD، على الرغم من عدم وجود معيار لتوليد هذا العدد العشوائي. وبالتالي، فإن إنشاء أرقام عشوائية هو قضية رئيسية لتأمين عمليات البيتكوين.

## العبارة المذكرة

![La phrase mnémonique](https://youtu.be/uJERqH9Xp7I)

أمان محفظة البيتكوين هو قلق رئيسي لجميع مستخدميها. واحدة من الطرق الأساسية لضمان حماية المحفظة هي إنشاء عبارة ذاكرية مستندة إلى الانتروبيا والتحقق من الصحة.

لتحويل الانتروبيا إلى عبارة ذاكرية، يكفي حساب التحقق من الانتروبيا ودمج الانتروبيا والتحقق منها.

بمجرد إنشاء الانتروبيا، نستخدم وظيفة SHA256 على الانتروبيا لإنشاء هاش. نسترد 8 بت الأولى من الهاش وهي التحقق من الصحة.
العبارة الذاكرية هي نتيجة جمع الانتروبيا والتحقق من الصحة.

يضمن التحقق من الصحة التحقق من صحة عبارة الاسترداد. بدون هذا التحقق من الصحة، يمكن أن يؤدي خطأ في العبارة إلى إنشاء محفظة مختلفة وبالتالي فقدان الأموال. يتم الحصول على التحقق من الصحة عن طريق تمرير الانتروبيا عبر وظيفة SHA256 واسترداد 8 بت الأولى من الهاش.

هناك معايير مختلفة للعبارة الذاكرية اعتمادًا على حجم الانتروبيا. الاعتيار الأكثر شيوعًا لعبارة الاسترداد المكونة من 24 كلمة هو انتروبيا بحجم 256 بت. يتم تحديد حجم التحقق من الصحة عن طريق قسمة حجم الانتروبيا على 32.

على سبيل المثال، تنتج انتروبيا بحجم 256 بت تحققًا من 8 بت. يؤدي دمج الانتروبيا والتحقق من الصحة إلى أحجام بالتوالي تبلغ 128 بت و 160 بت وما إلى ذلك. اعتمادًا على حجم الانتروبيا، ستحتوي عبارة الاسترداد على 12 كلمة لـ 128 بت، و 15 كلمة لـ 160 بت، و 24 كلمة لـ 256 بت.

**ترميز العبارة الذاكرية:**

آخر 8 بت تمثل التحقق من الصحة.
يتم تحويل كل قطاع من 11 بت إلى عشري.
يتوافق كل عدد عشري مع كلمة من قائمة تحتوي على 2048 كلمة في BIP39. من المهم أن نلاحظ أنه لا يوجد كلمة تحتوي على نفس الحروف الأربعة الأولى بنفس الترتيب.

من الضروري حفظ عبارة الاسترداد المكونة من 24 كلمة للحفاظ على سلامة محفظة البيتكوين. يعتمد المعيار الأكثر شيوعًا على انتروبيا بحجم 128 أو 256 بت ودمج 12 أو 24 كلمة. إضافة عبارة سرية تشكل خيارًا إضافيًا لتعزيز أمان المحفظة.

في الختام، إن إنشاء عبارة ذاكرية لتأمين محفظة البيتكوين هو عملية حاسمة. من المهم احترام معايير العبارة الذاكرية وفقًا لحجم الانتروبيا. يعتبر حفظ عبارة الاسترداد المكونة من 24 كلمة أمرًا ضروريًا لتجنب أي فقدان للأموال. 

## العبارة السرية

![La passphrase](https://youtu.be/dZkOYO7MXwc)

العبارة السرية هي كلمة مرور إضافية يمكن دمجها في محفظة بيتكوين لزيادة أمانها. استخدامها اختياري ويعود لتقدير المستخدم. من خلال إضافة معلومات تعسفية تساهم مع عبارة الذاكرة في حساب بذرة المحفظة، تعزز العبارة السرية أمان المحفظة.

العبارة السرية هي ملح تشفير اختياري بحجم يتم اختياره من قبل المستخدم. تساهم في تعزيز أمان محفظة HD من خلال إضافة معلومة تعسفية تجمع مع عبارة الذاكرة لحساب البذرة.

عندما يتم إنشاء محفظة، يجب تحديد العبارة السرية لاستخراج جميع مفاتيح المحفظة. يتم استخدام وظيفة pbkdf2 لتوليد البذرة من العبارة السرية. تسمح هذه البذرة باستخراج جميع أزواج المفاتيح الفرعية للمحفظة. إذا تم تغيير العبارة السرية، فإن محفظة بيتكوين تصبح مختلفة تمامًا.

العبارة السرية هي أداة أساسية لتعزيز أمان محافظ بيتكوين. يمكن أن تسمح بتطبيق استراتيجيات أمان مختلفة. على سبيل المثال، يمكن استخدامها لإنشاء نسخ احتياطية وتسهيل حفظ عبارة الذاكرة. يمكن أيضًا تحسين أمان المحفظة عن طريق التقليل من المخاطر المرتبطة بتوليد عبارة الذاكرة عشوائيًا.

يجب أن تكون العبارة السرية فعالة طويلة (20 إلى 40 حرفًا) ومتنوعة (تستخدم الأحرف الكبيرة والصغيرة والأرقام والرموز). يجب ألا تكون مرتبطة مباشرة بالمستخدم أو ببيئته. من الأفضل استخدام تسلسل عشوائي من الأحرف بدلاً من كلمة بسيطة كعبارة سرية.

العبارة السرية أكثر أمانًا من كلمة مرور بسيطة. العبارة السرية المثالية طويلة ومتنوعة وعشوائية. يمكن أن تعزز أمان محفظة أو برنامج ساخن. يمكن أيضًا استخدامها لإنشاء نسخ احتياطية متكررة وآمنة.

من الضروري العناية بنسخ العبارة السرية لتجنب فقدان الوصول إلى المحفظة. العبارة السرية هي خيار لمحفظة HD. يمكن إنشاؤها عشوائيًا باستخدام النرد أو مولد أرقام شبه عشوائي. من غير المستحسن تذكر العبارة السرية أو عبارة الذاكرة.

في الدورة التدريبية القادمة، سنتناول بالتفصيل عملية استخراج البذرة وأول زوج مفاتيح يتم إنشاؤه منها. لا تتردد في متابعة هذه الدورة لمواصلة تعلمك. نحن نتطلع إلى رؤيتك قريبًا جدًا.

# إنشاء محافظ بيتكوين

## إنشاء البذرة والمفتاح الرئيسي
إنشاء البذرة والمفتاح الرئيسي

في هذا الجزء من الدورة، سنستكشف خطوات استنباط محفظة HD (Hierarchical Deterministic Wallet)، التي تسمح بإنشاء وإدارة المفاتيح الخاصة والعامة بطريقة تسلسلية ومحددة.

أساس محفظة HD يعتمد على عنصرين أساسيين: العبارة المذكرة والعبارة السرية (كلمة مرور اختيارية إضافية). معًا، يشكلان البذرة، وهي سلسلة أبجدية رقمية تتكون من 512 بت وتستخدم كأساس لاستنباط مفاتيح المحفظة. باستخدام هذه البذرة، يمكن استنباط جميع أزواج المفاتيح الفرعية لمحفظة بيتكوين. البذرة هي المفتاح الذي يمكن الوصول به إلى جميع بيتكوين المرتبطة بالمحفظة، سواء كنت تستخدم عبارة سرية أم لا.

للحصول على البذرة، يتم استخدام وظيفة pbkdf2 (Password-Based Key Derivation Function 2) مع العبارة المذكرة والعبارة السرية. نتيجة pbkdf2 هي بذرة بطول 512 بت.

من البذرة، يمكن تحديد المفتاح الخاص الرئيسي ورمز السلسلة باستخدام خوارزمية HMAC SHA-512 (Hash-based Message Authentication Code Secure Hash Algorithm 512). هذا الخوارزمية تحتاج إلى رسالة ومفتاح كإدخال لإنتاج نتيجة. يتم حساب المفتاح الخاص الرئيسي من البذرة والعبارة "Bitcoin SEED". هذه العبارة متطابقة لجميع استنباطات جميع محافظ HD، مما يضمن التوافق بين المحافظ.

في البداية، لم يتم تنفيذ وظيفة SHA-512 في بروتوكول بيتكوين، ولهذا السبب نستخدم HMAC SHA-512. استخدام HMAC SHA-512 مع العبارة "Bitcoin SEED" يجبر المستخدم على إنشاء محفظة محددة لبيتكوين. نتيجة HMAC SHA-512 هي عدد بطول 512 بت، ينقسم إلى جزئين: الـ 256 بت الأيسر تمثل المفتاح الخاص الرئيسي، بينما الـ 256 بت الأيمن تمثل رمز السلسلة الرئيسي.

المفتاح الخاص الرئيسي هو المفتاح الأصل لجميع المفاتيح المستقبلية للمحفظة، بينما يتدخل رمز السلسلة الرئيسي في استنباط المفاتيح الفرعية. من المهم أن نلاحظ أنه من غير الممكن استنباط زوج مفاتيح فرعية بدون معرفة رمز السلسلة المقابل للزوج الأصلي.

يتضمن زوج المفاتيح في المحفظة مفتاحًا خاصًا ومفتاحًا عامًا ورمز سلسلة. يسمح رمز السلسلة بإدخال عنصر عشوائي في استنباط المفاتيح الفرعية وعزل كل زوج مفاتيح لتجنب تسرب المعلومات.
من المهم أن نشير إلى أن المفتاح الخاص الرئيسي هو أول مفتاح خاص يتم استخراجه من البذرة ولا يرتبط بأي صلة بالمفاتيح الموسعة في المحفظة.
في الدرس القادم، سنستكشف بالتفصيل المفاتيح الموسعة مثل xPub و xPRV و zPub وسنفهم لماذا يتم استخدامها وكيفية بنائها.

## المفاتيح الموسعة

![المفاتيح الموسعة](https://youtu.be/TRz760E_zUY)

في هذا الجزء من الدرس، سندرس المفاتيح الموسعة (xPub و zPub و yPub) وبادئاتها، التي تلعب دورًا مهمًا في استنتاج المفاتيح الفرعية في محفظة HD (محفظة التحديد التسلسلي الهرمية).

![صورة](assets/image/section4/3.JPG)

تتميز المفاتيح الموسعة عن المفاتيح الرئيسية. تقوم محفظة HD بإنشاء عبارة تذكرية وبذرة للحصول على المفتاح الرئيسي ورمز سلسلة الأكواد. تُستخدم المفاتيح الموسعة لاستنتاج المفاتيح الفرعية وتتطلب كل من المفتاح الأصلي ورمز سلسلة مطابق. تجمع المفتاح الموسع هاتين المعلومتين معًا لتبسيط عملية الاستنتاج.

![صورة](assets/image/section4/4.JPG)

لا يمكن استنتاج المفاتيح العمومية الموسعة إلا من المفاتيح العمومية الفرعية العادية، بينما تسمح المفاتيح الخاصة الموسعة بإستنتاج المفاتيح العمومية والخاصة الفرعية، سواء كان ذلك في الاستنتاج العادي أو الاستنتاج المحصور.
الاستنتاج المحصور هو الاستنتاج من المفتاح الخاص الأصلي. الاستنتاج العادي يتوافق مع الاستنتاج من المفتاح العام الأصلي.

استخدام المفاتيح الموسعة مع بادئة XPUB يسمح بإنشاء عناوين جديدة دون العودة إلى المفاتيح الخاصة المقابلة، مما يوفر أمانًا أفضل. توفر البيانات الوصفية المرتبطة بالمفاتيح الموسعة معلومات مهمة حول دورها وموقعها في تسلسل المفاتيح.

تتم تعريف المفاتيح الموسعة بواسطة بادئات محددة (XPRV و XPUB و YPUB و ZPUB) تشير إلى ما إذا كانت مفتاحًا موسعًا خاصًا أم عامًا، بالإضافة إلى هدفها المحدد. تشمل البيانات الوصفية المرتبطة بالمفتاح الموسع الإصدار (البادئة) والعمق وبصمة المفتاح العام والفهرس والحمولة (رمز السلسلة والمفتاح الأصلي).

![صورة](assets/image/section4/5.JPG)

الإصدار يتوافق مع نوع المفتاح: xpub ، xprv ، ...

العمق يتوافق مع عدد الاستنتاجات بين المفتاح الأصلي والفرعي منذ المفتاح الرئيسي.

بصمة الأصل هي أول 4 بايت من هاش 160 للمفتاح الأصلي.
الفهرس هو رقم الزوج الذي يستخدم لتوليد المفتاح الموسع بين أقرانه. (الأقران = المفاتيح في نفس العمق) مثال: إذا كنا نرغب في استنتاج xpub لحسابنا الثالث ، فإن فهرسه سيكون 2 (لأن الفهرس يبدأ من 0).

يتكون الحمولة من سلسلة الرمز (32 بايت) والمفتاح الأصلي (33 بايت).

تتكون المفاتيح العامة المضغوطة من 33 بايتًا ، بينما تتكون المفاتيح العامة الخام من 512 بت. تحتفظ المفاتيح العامة المضغوطة بنفس المعلومات الموجودة في المفاتيح الخام ، ولكن بحجم أصغر. تتكون المفاتيح الموسعة من 82 بايتًا ويتم تمثيل بادئتها في القاعدة 58 من خلال تحويلها إلى النظام الست عشري. يتم حساب الفحص باستخدام وظيفة التجزئة HASH256.

![صورة](assets/image/section4/6.JPG)

تبدأ الاشتقاقات المعززة من الفهارس التي هي أسس للعدد 2 (2^31). من المثير للاهتمام أن البادئات الأكثر استخدامًا هي xpub و zpub ، والتي تتوافق على التوالي مع المعايير القديمة و segwit v1 و segwit v0.

في الدرس القادم ، سنتناول استنتاج أزواج المفاتيح الفرعية باستخدام المعرفة المكتسبة حول المفاتيح الموسعة والمفتاح الرئيسي للمحفظة.

## استنتاج أزواج المفاتيح الفرعية

![استنتاج أزواج المفاتيح الفرعية](https://youtu.be/FXhI-GmE9Aw)

كما تذكرنا ، تناولنا حساب البذرة والمفتاح الرئيسي ، واللذان يشكلان العناصر الأولى الأساسية لتسلسل واستنتاج محفظة HD (Hierarchical Deterministic Wallet). يتم إنشاء البذرة ، التي تتراوح طولها بين 128 و 256 بت ، بشكل عشوائي أو من عبارة سرية. إنها تلعب دورًا حاسمًا في استنتاج جميع المفاتيح الأخرى. المفتاح الرئيسي هو أول مفتاح يتم استنتاجه من البذرة ، ويتيح استنتاج جميع أزواج المفاتيح الفرعية الأخرى.

يلعب رمز السلسلة الرئيسي دورًا هامًا في استعادة المحفظة من البذرة. يجب ملاحظة أن جميع المفاتيح المستنتجة من نفس البذرة ستحتوي على نفس رمز السلسلة الرئيسي.

![صورة](assets/image/section4/7.JPG)

توفر تسلسل واستنتاج محفظة HD إدارة أكثر كفاءة للمفاتيح وهياكل المحفظة. تتيح المفاتيح الموسعة استنتاج زوج مفاتيح فرعي من زوج أصلي باستخدام الحسابات الرياضية والخوارزميات المحددة.
هناك أنواع مختلفة من أزواج المفاتيح الفرعية، بما في ذلك المفاتيح المعززة والمفاتيح العادية. تسمح المفتاح العام الموسع فقط بتشتيت المفاتيح العامة الفرعية العادية، بينما يسمح المفتاح الخاص الموسع بتشتيت جميع المفاتيح الفرعية، سواء كانت عامة أو خاصة، سواء كانت في الوضع العادي أو المعزز. تحتوي كل زوج من المفاتيح على مؤشر يسمح بتمييزها عن بعضها البعض.
![صورة](assets/image/section4/8.JPG)

يستخدم تشتيت المفاتيح الفرعية وظيفة HMAC-SHA512 باستخدام المفتاح الأصلي المرتبط بالمؤشر ورمز السلسلة المرتبط بزوج المفاتيح. تتراوح مؤشرات المفاتيح الفرعية العادية بين 0 و 2 في الأس 31 ناقص 1، بينما تتراوح مؤشرات المفاتيح الفرعية المعززة بين 2 في الأس 31 و 2 في الأس 32 ناقص 1.

![صورة](assets/image/section4/9.JPG)

![صورة](assets/image/section4/10.JPG)

هناك نوعان من أزواج المفاتيح الفرعية: المفاتيح المعززة والمفاتيح العادية. يستخدم عملية تشتيت المفاتيح الفرعية المفاتيح العامة لإنشاء شروط الإنفاق، بينما تستخدم المفاتيح الخاصة للتوقيع. تسمح المفتاح العام الموسع فقط بتشتيت المفاتيح العامة الفرعية العادية، بينما يسمح المفتاح الخاص الموسع بتشتيت جميع المفاتيح الفرعية، سواء كانت عامة أو خاصة، سواء كانت في الوضع العادي أو المعزز.

![صورة](assets/image/section4/11.JPG)
![صورة](assets/image/section4/12.JPG)

يستخدم التشتيت المعزز المفتاح الخاص الأصلي، بينما يستخدم التشتيت العادي المفتاح العام الأصلي. يتم استخدام وظيفة HMAC-SHA512 للتشتيت المعزز، بينما يستخدم التشتيت العادي مجموعة تجزئة بطول 512 بت. يتم الحصول على المفتاح العام الفرعي عن طريق ضرب المفتاح الخاص الفرعي بمولد المنحنى البيضاوي.

![صورة](assets/image/section4/13.JPG)
![صورة](assets/image/section4/14.JPG)

تسمح التسلسلية والتشتيت المحدد لعدد كبير من أزواج المفاتيح بإنشاء نمط شجري للتشتيت الهرمي. في الدورة التدريبية التالية، سندرس هيكل المحفظة الهرمية بالإضافة إلى مسارات التشتيت، مع التركيز بشكل خاص على توضيح تعابير مسارات التشتيت.

## هيكل المحفظة ومسارات التشتيت

![هيكل المحفظة ومسارات التشتيت](https://youtu.be/etO9UxwyE2I)
في هذا الفصل، سندرس هيكل شجرة الاشتقاق في محفظة HD (المحفظة التفاضلية الهرمية). لقد استكشفنا بالفعل حساب البذرة والمفتاح الرئيسي واشتقاق أزواج المفاتيح الفرعية. الآن، سنركز على تنظيم المفاتيح داخل المحفظة.
تستخدم المحفظة HD طبقات العمق لتنظيم المفاتيح. يتوافق كل اشتقاق من زوج أصلي إلى زوج فرعي مع طبقة عمق.

- العمق 0 يتوافق مع المفتاح الرئيسي ورمز سلسلة المفاتيح.

- يتم استخدام العمق 1 لاشتقاق المفاتيح الفرعية وفقًا لهدف محدد، والذي يتم تحديده بواسطة الفهرس. تتوافق الأهداف مع معايير BIP 84 و Segwit v0/v1.

- يتيح العمق 2 تمييز الحسابات لعملات مشفرة أو شبكات مختلفة. يتيح ذلك تنظيم المحفظة وفقًا لمصادر الأموال المختلفة. بالنسبة لبيتكوين، سيكون الفهرس 0.

- يتم استخدام العمق 3 لتنظيم المحفظة في حسابات مختلفة، مما يوفر هيكلًا أكثر وضوحًا وتنظيمًا.

- يتوافق العمق 4 مع السلاسل الداخلية والخارجية، والتي تستخدم لعناوين يتم تبادلها علنيًا. يتم ربط الفهرس 0 بالسلسلة الخارجية، بينما يتم ربط الفهرس 1 بالسلسلة الداخلية. يحتوي كل حساب على سلسلتين: السلسلة الخارجية (0) والسلسلة الداخلية (1). يتم أيضًا استخدام العمق 4 لإدارة أنواع البرامج النصية في حالة المحافظ متعددة التوقيعات.

- يتم استخدام العمق 5 لعناوين الاستلام في محفظة كلاسيكية. في القسم التالي، سنناقش بالتفصيل أكثر اشتقاق أزواج المفاتيح الفرعية.

لكل طبقة عمق، نستخدم فهارس لتمييز أزواج المفاتيح الفرعية.

الفهرس بدون علامة تناظرية يتوافق مع الفهرس الفعلي المستخدم، بينما الفهرس مع علامة تناظرية يتوافق مع الفهرس الفعلي + 2^31. يستخدم الاشتقاق المعزز فهارس من 2^31 إلى 2^32-1. على سبيل المثال، يتوافق الفهرس 44' مع الفهرس الفعلي 2^31 + 44.

لتوليد عنوان استلام محدد، نشتق زوجًا من المفاتيح الفرعية من المفتاح الرئيسي ورمز سلسلة المفاتيح. ثم نستخدم الفهرس لتمييز أزواج المفاتيح الفرعية المختلفة في نفس العمق.
المفاتيح الموسعة مثل XPUB تسمح لك بمشاركة محفظتك مع عدة أشخاص. يتم استخدام سلسلة الاشتقاق للتمييز بين السلسلة الخارجية (عناوين مقصودة للتواصل) والسلسلة الداخلية (عناوين التغيير).
في الفصل القادم، سندرس عناوين الاستلام وفوائدها وخطوات بنائها.

# ما هو عنوان بيتكوين؟

## عناوين بيتكوين

![عناوين بيتكوين](https://youtu.be/nqGBMjPtFNI)

في هذا الفصل، سنستكشف عناوين الاستلام التي تلعب دورًا حاسمًا في نظام بيتكوين. تسمح بتلقي الأموال على قطعة وتتم إنشاؤها من أزواج المفاتيح الخاصة والعامة. على الرغم من وجود نوع من البرنامج النصي يُسمى Pay2PublicKey والذي يسمح بقفل بيتكوين على مفتاح عام، يفضل المستخدمون عادة استخدام عناوين الاستلام بدلاً من هذا البرنامج النصي.

![صورة](assets/image/section5/0.JPG)

عندما يرغب المستلم في استلام بيتكوين، يقدم عنوان استلام للمرسل بدلاً من المفتاح العام. يكون العنوان في الواقع هاش للمفتاح العام، بتنسيق محدد. يتم استنتاج المفتاح العام من المفتاح الخاص الابن باستخدام عمليات رياضية مثل الجمع وتضاعف النقاط على المنحنيات البيضاوية.

![صورة](assets/image/section5/1.JPG)

من المهم أن نلاحظ أنه لا يمكن العودة من العنوان إلى المفتاح العام، ولا من المفتاح العام إلى المفتاح الخاص. استخدام العنوان يساعد في تقليل حجم معلومات المفتاح العام، والتي تبلغ في الأصل 512 بت.

تم تقليل حجم عناوين بيتكوين لتسهيل استخدامها. تحتوي على تحقق الصحة، مما يسمح بكشف أخطاء الكتابة وتقليل مخاطر فقدان البيتكوين. ومع ذلك، لا يحتوي المفاتيح العامة على تحقق الصحة، مما يعني أن أخطاء الكتابة يمكن أن تؤدي إلى فقدان الأموال المقابلة.

توفر العناوين أيضًا طبقة ثانية من الأمان بين المعلومات العامة والخاصة، مما يجعل من الصعب السيطرة على المفتاح الخاص.

من الضروري أن يكون لكل عنوان استخدام فريد. إعادة استخدام نفس العنوان يشكل مشاكل في الخصوصية ويجب تجنبه.

تستخدم عناوين بيتكوين بادئات مختلفة. على سبيل المثال، BC1Q يتوافق مع عنوان Segwit V0، BC1P يتوافق مع عنوان Taproot/Segwit V1، والبادئات 1 و 3 مرتبطة بعناوين Pay2PublicKeyH/Pay2ScriptH (التقليدية). في الدورة القادمة، سنشرح خطوة بخطوة كيفية استنتاج عنوان من المفتاح العام.

## كيفية إنشاء عنوان بيتكوين؟

كيفية إنشاء عنوان بيتكوين؟

في هذا الفصل، سنتناول إنشاء عنوان استقبال لعمليات بيتكوين. يعد عنوان الاستقبال تمثيلًا للمفتاح العام المضغوط بواسطة أحرف أبجدية رقمية. يتم تحويل المفتاح العام إلى عنوان استقبال من خلال عدة خطوات.

الخطوة 1: ضغط المفتاح العام

يتم استنتاج العنوان من مفتاح عام فرعي.

المفتاح العام هو نقطة على المنحنى البيضاوي. بفضل تماثل المنحنى البيضاوي، ستكون لنقطة على المنحنى البيضاوي إحداثيات x فقط مرتبطة بقيمتين محتملتين لـ y: إيجابية أو سلبية.
ومع ذلك، في بروتوكول بيتكوين، نعمل مع مجموعة من الأعداد الصحيحة المحدودة بدلاً من الأعداد الحقيقية. للتمييز بين القيمتين المحتملتين لـ y، يكفي إشارة ما إذا كانت y زوجية أم فردية.

ضغط المفتاح العام يسمح بتقليل حجمه من 520 بت إلى 264 بت.

نستخدم البادئة 0x02 لـ y زوجية و 0x03 لـ y فردية. هذا هو الشكل المضغوط للمفتاح العام.

الخطوة 2: تجزئة المفتاح العام المضغوط

يتم تجزئة المفتاح العام المضغوط باستخدام وظيفة SHA256. ثم يتم تطبيق وظيفة RIPEMD160 على القيمة المجزأة.

الخطوة 3: الحمولة = حمولة العنوان

يتيح القيمة المجزأة بتكوين مجموعات من 5 بت. يتم تحويل كل مجموعة إلى القاعدة 16 (السداسي عشرية) و / أو القاعدة 10.

الخطوة 4: إضافة البيانات الوصفية لحساب الفحص باستخدام برنامج BCH

في حالة العناوين التقليدية، نستخدم تجزئة SHA256 المزدوجة لإنشاء مجموعة التحقق من العنوان. ومع ذلك، في حالة عناوين Segwit V0 و V1، نستخدم تقنية فحص BCH لضمان اكتشاف الأخطاء. يمكن لبرنامج BCH أن يقترح ويصحح الأخطاء بإحتمالية خطأ ضئيلة جدًا. حاليًا، يتم استخدام برنامج BCH لاكتشاف واقتراح التعديلات المطلوبة، ولكنه لا يقوم بها تلقائيًا بدلاً من المستخدم.
يتطلب برنامج BCH العديد من المعلومات كمدخلات، بما في ذلك HRP (جزء قابل للقراءة بواسطة الإنسان) الذي يجب توسيعه. توسيع HRP يتضمن ترميز كل حرف في القاعدة 2 وفقًا لرمز ASCII الخاص به. ثم، عن طريق أخذ 3 بتات الأولى لكل حرف وتحويلها إلى القاعدة 10 (مشار إليها باللون الأزرق في الصورة). قم بإدراج فاصل 0. ثم قم بدمج 5 بتات الأخيرة لكل حرف تم تحويلها مسبقًا إلى القاعدة 10 (مشار إليها باللون الأصفر في الصورة).
توسيع HRP في القاعدة 10 يسمح بعزل الخمس بتات الأخيرة لكل حرف، مما يعزز الفحص التشفيري.

تُمثل النسخة Segwit V0 بالرمز 00 ويتم تمثيل "الحمولة" باللون الأسود، في القاعدة 10. يتبع ذلك ستة أحرف محجوزة للفحص التشفيري.

### الخطوة 5: حساب مجموعة التحقق باستخدام برنامج BCH

![صورة](assets/image/section5/6.JPG)

يتم إدخال المدخلات التي تحتوي على البيانات الوصفية إلى برنامج BCH للحصول على مجموعة التحقق في القاعدة 10.

هنا لدينا مجموعة التحقق.

### الخطوة 6: بناء العنوان وتحويله إلى Bech32

![صورة](assets/image/section5/7.JPG)

يتم بناء العنوان عن طريق دمج النسخة والحمولة ومجموعة التحقق. يتم تحويل الأحرف في القاعدة 10 إلى أحرف Bech32 باستخدام جدول مطابقة. يتضمن أبجدية Bech32 جميع الأحرف الأبجدية والرقمية، باستثناء 1 و b و i و o، لتجنب الارتباك.

### الخطوة 7: إضافة HRP والفاصل

![صورة](assets/image/section5/8.JPG)

باللون الوردي مجموعة التحقق.
باللون الأسود، الحمولة = هاش المفتاح العام.
باللون الأزرق، النسخة.

يتم تحويل الكل إلى Bech32، ثم يتم إضافة 'bc' لبيتكوين و '1' كفاصل وها هو العنوان.

# اذهب أبعد

## إنشاء بذرة من خلال إلقاء النرد 128 مرة!

![إنشاء بذرة من خلال إلقاء النرد 128 مرة!](https://youtu.be/lUw-1kk75Ok)

إن إنشاء عبارة تذكرية هو خطوة حاسمة لتأمين محفظتك الرقمية. هناك عدة طرق لإنشاء عبارة تذكرية، ومع ذلك، سنركز على طريقة الإنشاء اليدوي باستخدام النرد. من المهم أن نشير إلى أن هذه الطريقة غير مناسبة لمحفظة ذات قيمة عالية. يُنصح باستخدام برنامج مفتوح المصدر أو محفظة مادية لإنشاء عبارة تذكرية. لإنشاء عبارة تذكرية، سنستخدم النرد لإنشاء معلومات ثنائية. الهدف هو فهم عملية إنشاء العبارة التذكرية.

**الخطوة 1 - التحضير:**
تأكد من وجود توزيعة لينكس ذات طابع النسيان، مثل نظام تايلز، مثبتة على محرك أقراص USB لزيادة الأمان. يجب ملاحظة أنه لا ينبغي استخدام هذا البرنامج التعليمي لإنشاء محفظة رئيسية.
**الخطوة 2 - إنشاء رقم ثنائي عشوائي:**
سنستخدم النرد لإنشاء معلومات ثنائية. قم بإلقاء النرد 128 مرة وقم بتسجيل كل نتيجة (1 للأعداد الفردية و 0 للأعداد الزوجية).

**الخطوة 3 - تنظيم الأرقام الثنائية:**
قم بتنظيم الأرقام الثنائية التي تم الحصول عليها في صفوف من 11 رقمًا لتسهيل الحسابات اللاحقة. يجب أن يحتوي السطر الثاني عشر على 7 أرقام فقط.

**الخطوة 4 - حساب الفحص:**
تتوافق الأرقام الأربعة الأخيرة للسطر الثاني عشر مع الفحص. لحساب هذا الفحص، نحتاج إلى استخدام وحدة نمطية من توزيعة لينكس. من المستحسن استخدام [تايلز](https://tails.boum.org/index.fr.html) وهي توزيعة بدون ذاكرة يمكن تشغيلها من محرك أقراص USB. بمجرد الوصول إلى الوحدة النمطية الخاصة بك، أدخل الأمر `echo <binary number> | shasum -a 254 -0`. استبدل `<binary number>` بقائمة الأصفار والواحدات الخاصة بك. الناتج هو تجزئة بصيغة ست عشرية. احتفظ بالحرف الأول من هذه التجزئة وقم بتحويله إلى ثنائي. يمكنك الاستعانة بالجدول [هنا](https://www.educative.io/answers/decimal-binary-and-hex-conversion-table). أضف الفحص الثنائي (4 أرقام) إلى السطر الثاني عشر في ورقتك.

**الخطوة 5 - التحويل إلى عشري:**
للعثور على الكلمات المرتبطة بكل سطر، يجب عليك أولاً تحويل كل سلسلة من 11 بت إلى عشري. هنا لا يمكنك استخدام محول عبر الإنترنت لأن هذه البتات تمثل عبارة ذاكرية. لذا ستحتاج إلى التحويل باستخدام آلة حاسبة وحيلة هنا: يتم تعيين كل بت لقوة 2، لذا من اليسار إلى اليمين لدينا 11 مرتبة تتوافق على التوالي مع 1024 و 512 و 256 و 128 و 64 و 32 و 16 و 8 و 4 و 2 و 1. لتحويل سلسلة البت الخاصة بك إلى عشري، يكفي أن تضيف فقط المراتب التي تحتوي على 1. على سبيل المثال، للسلسلة 00110111011، يتوافق ذلك مع الجمع التالي: 256 + 128 + 32 + 16 + 8 + 2 + 1 = 443. يمكنك الآن تحويل كل سطر إلى عشري. وقبل الانتقال إلى الترميز بالكلمات، يجب إضافة +1 إلى جميع الأسطر لأن فهرس قائمة كلمات BIP39 يبدأ من 1 وليس 0.

**الخطوة 8 - إنشاء العبارة الذاكرية:**
ابدأ بطباعة [قائمة الكلمات 2048](https://seedxor.com/files/wordlist.pdf) لتحويل الأرقام العشرية الخاصة بك إلى كلمات BIP39. يتميز هذا القاموس بأنه لا يحتوي على أي كلمة تشترك في أول 4 أحرف مع جميع الكلمات الأخرى في هذا القاموس. ثم ابحث عن الكلمات المرتبطة بكل سطر من الأرقام العشرية الخاصة بك.
**الخطوة 9 - اختبار العبارة المذكورة بالذاكرة:**
قم بتجربة العبارة المذكورة بالذاكرة على محفظة Sparrow Wallet عن طريق إنشاء محفظة منها. إذا حصلت على خطأ في التحقق من الصحة، فمن المحتمل أنك قمت بخطأ في الحساب. قم بتصحيح هذا الخطأ بالعودة إلى الخطوة 4 وقم بالاختبار مرة أخرى على محفظة Sparrow. هنا! لقد قمت بإنشاء محفظة بيتكوين جديدة من خلال 128 رمية للنرد.

إن إنشاء عبارة مذكورة بالذاكرة هو عملية مهمة لتأمين محفظتك للعملات الرقمية. يُوصى باستخدام طرق أكثر أمانًا مثل استخدام برامج مفتوحة المصدر أو محافظ الأجهزة لإنشاء العبارة المذكورة بالذاكرة. ومع ذلك، فإن إجراء هذه الورشة يساعد على فهم أفضل لكيفية إنشاء محفظة بيتكوين من رقم عشوائي.

## مكافأة: مقابلة مع ثيو بانتاميس

طريقة توقيع الأرقام الرقمية هي طريقة تشفيرية أخرى تستخدم بشكل كبير في بروتوكول بيتكوين.

## الاستنتاج والختام

### الشكر واستمر في استكشاف جحر الأرنب

نود أن نشكركم بصدق على متابعتكم للدورة التدريبية Crypto 301. نأمل أن تكون هذه التجربة مثمرة وتعليمية بالنسبة لكم. لقد تناولنا العديد من المواضيع المثيرة، بدءًا من الرياضيات وصولاً إلى علم التشفير وكيفية عمل بروتوكول بيتكوين.

إذا كنت ترغب في المزيد من التفاصيل، لدينا مصدر إضافي لنقدمه لكم. أجرينا مقابلة حصرية مع ثيو بانتاميس ولويك موريل، اثنين من الخبراء المشهورين في مجال التشفير. تستكشف هذه المقابلة بعمق مختلف جوانب الموضوع وتقدم آراء مثيرة للاهتمام.

لا تتردد في مشاهدة هذه المقابلة للاستمرار في استكشاف مجال التشفير الرائع. نأمل أن يكون ذلك مفيدًا وملهمًا في رحلتكم. مرة أخرى، شكرًا لمشاركتكم والتزامكم طوال هذه الدورة التدريبية.

### ادعمنا

تم تقديم هذه الدورة التدريبية، بالإضافة إلى جميع المحتوى المتاح في هذه الجامعة، مجانًا من قبل مجتمعنا. لدعمنا، يمكنك مشاركتها مع الآخرين، وأن تصبح عضوًا في الجامعة، وحتى المساهمة في تطويرها عبر GitHub. باسم الفريق بأكمله، شكرًا لكم!

### قيم الدورة التدريبية

سيتم قريبًا إضافة نظام تقييم للدورة التدريبية إلى هذه المنصة الجديدة للتعلم الإلكتروني! في الوقت الحالي، شكرًا جزيلاً لمتابعتكم للدورة التدريبية وإذا كنتم قد استمتعتم بها، فكر في مشاركتها مع الآخرين.