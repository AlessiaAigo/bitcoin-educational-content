---
term: P2TR
---

P2TR означает *Pay to Taproot*, что является стандартной моделью скрипта, используемой для установления условий расходования UTXO (Unspent Transaction Output - Непотраченный Выход Транзакции). Эта модель была введена с реализацией Taproot в ноябре 2021 года. P2TR использует протокол Шнорра для агрегирования криптографических ключей, а также деревья Меркла для альтернативных скриптов, известных как MAST (*Merkelized Alternative Script Tree* - Мерклизированное Альтернативное Дерево Скриптов). В отличие от традиционных транзакций, где условия расходования публично раскрыты (иногда в момент получения, иногда в момент расходования), P2TR позволяет скрывать сложные скрипты за одним видимым публичным ключом.

Технически скрипт P2TR блокирует биткойны на уникальном публичном ключе Шнорра, обозначаемом как $K$. Однако этот ключ $K$ на самом деле является агрегатом публичного ключа $P$ и публичного ключа $M$, последний из которых рассчитывается из корня Меркла списка `scriptPubKey`. Биткойны, заблокированные с помощью скрипта P2TR, могут быть потрачены двумя различными способами: либо путем публикации подписи для публичного ключа $P$, либо путем удовлетворения одного из скриптов, содержащихся в дереве Меркла. Первый вариант называется "*путь ключа*" и второй "*путь скрипта*".

Таким образом, P2TR позволяет пользователям отправлять биткойны либо на публичный ключ, либо на несколько скриптов по их выбору. Еще одно преимущество этого скрипта заключается в том, что, хотя существует несколько способов потратить выход P2TR, только используемый вариант должен быть раскрыт в момент расходования, что позволяет неиспользованным альтернативам оставаться приватными. P2TR является выходом SegWit версии 1, что означает, что подписи для входов P2TR хранятся в свидетельстве транзакции, а не в `scriptSig`. Адреса P2TR используют кодировку `Bech32m` и начинаются с `bc1p`.