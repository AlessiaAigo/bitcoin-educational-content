---
术语：静默支付
---

一种使用静态比特币地址接收支付的方法，无需地址重用、无需交互，且不会在不同支付和静态地址之间留下可见的链上链接。这项技术消除了为每笔交易生成新的、未使用的接收地址的需求，从而避免了比特币中常见的交互，即接收方必须向支付方提供一个新地址。

在静默支付中，支付方使用接收方的公钥（消费公钥和扫描公钥）以及他们自己的私钥之和作为输入，为每笔支付生成一个新的地址。只有持有私钥的接收方，才能计算出与此支付地址对应的私钥。使用ECDH（*椭圆曲线迪菲-赫尔曼*）密码密钥交换算法来建立一个共享秘密，然后用它来派生接收地址和私钥（仅在接收方一侧）。为了识别针对他们的静默支付，接收方必须扫描区块链并检查每笔符合协议标准的交易。与使用通知交易来建立支付通道的BIP47不同，静默支付省略了这一步，节省了一笔交易。然而，妥协之处在于接收方必须扫描所有潜在的交易，通过应用ECDH来确定这些交易是否是发给他们的。

例如，Bob的静态地址$B$代表他的扫描公钥和他的消费公钥的连接：

$$ B = B_{\text{scan}} \text{ ‖ } B_{\text{spend}} $$

这些键简单地从以下路径派生：

```text
scan : m / 352' / 0' / 0' / 1' / 0
spend : m / 352' / 0' / 0' / 0' / 0
```

Bob发布了这个静态地址。Alice检索它以对Bob进行静默支付。她这样计算Bob的支付地址$P_0$：

$$  P_0 = B_{\text{spend}} + \text{hash}(\text{inputHash} \cdot a \cdot B_{\text{scan}} \text{ ‖ } 0) \cdot G  $$

其中：

$$  \text{inputHash} = \text{hash}(\text{outpoint}_L \text{ ‖ } A)  $$

带有：
* $B_{\text{scan}}$：Bob的扫描公钥（静态地址）；
* $B_{\text{spend}}$：Bob的消费公钥（静态地址）；
* $A$：输入中公钥的总和（调整值）；
* $a$：调整值的私钥，即在Alice的交易中作为输入消耗的UTXOs的`scriptPubKey`中所有密钥对的总和；
* $\text{outpoint}_L$：Alice的交易中用作输入的最小UTXO（按字典顺序）；
* $\text{ ‖ }$：连接（将操作数端对端连接的操作）；
* $G$：椭圆曲线`secp256k1`的生成点；
* $\text{hash}$：带有`BIP0352/SharedSecret`标签的SHA256哈希函数；
* $P_0$：支付给Bob的第一个公钥/唯一支付地址；
* $0$：用于生成多个唯一支付地址的整数。

Bob通过以下方式在区块链上找到他的静默支付：
$$  P_0 = B_{\text{spend}} + \text{hash}(\text{inputHash} \cdot b_{\text{scan}} \cdot A \text{ ‖ } 0) \cdot G  $$
其中：
* $b_{\text{scan}}$：Bob的私有扫描密钥。

如果他发现$P_0$是一个包含向他发送的静默支付的地址，他计算$p_0$，即允许他花费Alice发送到$P_0$的资金的私钥：

$$ p_0 = (b_{\text{spend}} + \text{hash}(\text{inputHash} \cdot b_{\text{scan}} \cdot A \text{ ‖ } 0)) \mod n $$

其中：
* $b_{\text{spend}}$：Bob的私有消费密钥；
* $n$：椭圆曲线`secp256k1`的阶。

除了这个基础版本外，还可以使用标签从同一个基础静态地址生成几个不同的静态地址，目的是在不不合理增加扫描所需工作量的情况下，分隔多个用途。