---
termine: FEE SNIPING
---

Uno scenario di attacco in cui i minatori cercano di riscrivere un blocco recentemente confermato al fine di rivendicare le commissioni sulle transazioni che contiene, aggiungendo nel frattempo transazioni ad alta commissione che sono arrivate nel mempool. L'obiettivo finale di questo attacco per il minatore è aumentare la propria redditività. Il fee sniping può diventare sempre più redditizio man mano che la ricompensa per blocco diminuisce e le commissioni sulle transazioni rappresentano una parte maggiore dei ricavi dei minatori. Può anche essere vantaggioso quando le commissioni contenute nel blocco precedente sono significativamente più alte di quelle nel prossimo blocco candidato migliore. Per semplificare, il minatore è di fronte a questa scelta in termini di incentivi:
* Minare in modo normale seguendo l'ultimo blocco, con alta probabilità di vincere una ricompensa bassa;
* Tentare di minare un blocco precedente (fee sniping), con bassa probabilità di vincere una ricompensa alta.

Questo attacco rappresenta un rischio per il sistema Bitcoin, poiché più minatori lo adottano, più altri minatori, inizialmente onesti, sono incentivati a fare lo stesso. Infatti, ogni volta che un nuovo minatore si unisce a coloro che tentano il fee sniping, la probabilità che uno dei minatori attaccanti abbia successo aumenta, e la probabilità che uno dei minatori onesti estenda la catena diminuisce in cambio. Se questo attacco viene portato avanti massicciamente e sostenuto nel tempo, le conferme dei blocchi non sarebbero più un indicatore affidabile dell'immutabilità di una transazione Bitcoin. Questo potrebbe potenzialmente rendere il sistema inutilizzabile.

Per contrastare questo rischio, la maggior parte dei software di portafoglio riempie automaticamente il campo `nLocktime` in modo tale che condizioni la validazione della transazione all'inclusione nell'altezza del blocco successivo. Così, diventa impossibile includere la transazione in una riscrittura del blocco precedente. Se l'uso diffuso di `nLocktime` viene adottato dagli utenti Bitcoin, riduce significativamente gli incentivi per il fee sniping. Infatti, incoraggia il progresso della blockchain piuttosto che la sua riscrittura riducendo i potenziali profitti da essa. Per le transazioni Taproot, il BIP326 propone di utilizzare il campo `nSequence` in modo simile per ottenere l'effetto equivalente del campo `nLocktime` per altri tipi di transazioni. Questo uso ucciderebbe due piccioni con una fava migliorando anche la privacy dei protocolli di secondo livello che utilizzano lo stesso campo.