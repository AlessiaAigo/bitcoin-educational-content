---
term: FEE SNIPING
---

Сценарий атаки, при котором майнеры стремятся переписать недавно подтвержденный блок, чтобы заявить права на комиссионные сборы, содержащиеся в нем, добавляя при этом транзакции с высокими комиссиями, которые поступили в мемпул в промежутке времени. Конечная цель этой атаки для майнера - увеличить свою прибыльность. Fee sniping может становиться всё более выгодным по мере уменьшения вознаграждения за блок и увеличения доли комиссионных сборов в доходах майнеров. Это также может быть выгодно, когда комиссии, содержащиеся в предыдущем блоке, значительно выше, чем в следующем лучшем кандидате блока. Упрощенно, перед майнером стоит выбор с точки зрения стимулов:
* Добывать в обычном режиме, следуя за последним блоком, с высокой вероятностью получения низкого вознаграждения;
* Попытаться добыть предыдущий блок (fee sniping), с низкой вероятностью получения высокого вознаграждения.

Эта атака представляет риск для системы Bitcoin, поскольку чем больше майнеров ее применяют, тем больше другие майнеры, изначально честные, мотивированы делать то же самое. Действительно, каждый раз, когда новый майнер присоединяется к тем, кто пытается осуществить fee sniping, вероятность успеха одного из атакующих майнеров увеличивается, а вероятность того, что один из честных майнеров продолжит цепочку, уменьшается в ответ. Если эта атака будет проводиться массово и на протяжении длительного времени, подтверждения блоков больше не будут надежным индикатором неизменности транзакции в Bitcoin. Это может потенциально сделать систему непригодной для использования.

Для противодействия этому риску большинство программного обеспечения для кошельков автоматически заполняет поле `nLocktime`, так что оно условливает проверку транзакции включением в следующую высоту блока. Таким образом, становится невозможным включить транзакцию в переписанный предыдущий блок. Если широкое использование `nLocktime` будет принято пользователями Bitcoin, это значительно снижает стимулы для fee sniping. Действительно, это поощряет продвижение блокчейна, а не его переписывание, уменьшая потенциальную прибыль от этого. Для транзакций Taproot BIP326 предлагает использовать поле `nSequence` аналогичным образом для достижения эквивалентного эффекта поля `nLocktime` для других типов транзакций. Это использование убивает двух зайцев одним выстрелом, также улучшая конфиденциальность второго уровня протоколов, использующих то же поле.