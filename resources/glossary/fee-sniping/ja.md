---
term: FEE SNIPING
---

マイナーが最近確認されたブロックを書き換えてその中の取引手数料を主張し、その間にmempoolに到着した高手数料の取引を追加しようとする攻撃シナリオです。この攻撃の最終目標は、マイナーの利益を増やすことです。ブロック報酬が減少し、取引手数料がマイナーの収入の大きな部分を占めるようになると、Fee Snipingはますます利益を上げやすくなります。前のブロックに含まれる手数料が次の最良の候補ブロックのそれよりも著しく高い場合にも有利です。簡単に言うと、マイナーはインセンティブの観点から次の選択に直面します：
* 最後のブロックに従って通常通りにマイニングし、低報酬を得る高い確率；
* 前のブロックをマイニングしようとする（Fee Sniping）、高報酬を得る低い確率。

この攻撃はBitcoinシステムにリスクをもたらします。なぜなら、より多くのマイナーがこれを採用するほど、当初は正直だった他のマイナーも同じことをするように動機付けられるからです。実際、新しいマイナーがFee Snipingを試みる者に加わるたびに、攻撃するマイナーのうちの一人が成功する確率が増加し、正直なマイナーがチェーンを延長する確率がそれに応じて減少します。この攻撃が大規模に、そして長期にわたって行われた場合、ブロックの確認はもはやBitcoin取引の不変性の信頼できる指標ではなくなります。これにより、システムが使用不能になる可能性があります。

このリスクに対抗するため、ほとんどのウォレットソフトウェアは自動的に`nLocktime`フィールドを記入して、取引の検証を次のブロック高さへの含まれることに条件付けします。これにより、取引を前のブロックの書き換えに含めることが不可能になります。`nLocktime`の広範な使用がBitcoinユーザーによって採用される場合、Fee Snipingのインセンティブは大幅に減少します。実際、これはブロックチェーンの進行を促進し、それからの潜在的な利益を減らすことによって、その書き換えを減少させることを奨励します。Taproot取引については、BIP326は`nSequence`フィールドを同様の方法で使用し、他のタイプの取引に対する`nLocktime`フィールドと同等の効果を達成することを提案しています。この使用法は、同じフィールドを使用する第二層プロトコルのプライバシーを改善することによって、一石二鳥を達成します。