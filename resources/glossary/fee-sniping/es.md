---
term: FEE SNIPING
---

Un escenario de ataque en el cual los mineros buscan reescribir un bloque recientemente confirmado con el fin de reclamar las tarifas de transacción que contiene, mientras agregan transacciones con altas tarifas que han llegado mientras tanto al mempool. El objetivo final de este ataque para el minero es aumentar su rentabilidad. El fee sniping puede volverse cada vez más rentable a medida que la recompensa por bloque disminuye y las tarifas de transacción representan una parte mayor de los ingresos de los mineros. También puede ser ventajoso cuando las tarifas contenidas en el bloque anterior son significativamente más altas que las del siguiente mejor bloque candidato. Para simplificar, el minero se enfrenta a esta elección en términos de incentivos:
* Minar de manera normal siguiendo el último bloque, con una alta probabilidad de ganar una recompensa baja;
* Intentar minar un bloque anterior (fee sniping), con una baja probabilidad de ganar una recompensa alta.

Este ataque representa un riesgo para el sistema Bitcoin, ya que cuanto más mineros lo adopten, más otros mineros, inicialmente honestos, se ven incentivados a hacer lo mismo. De hecho, cada vez que un nuevo minero se une a aquellos que intentan el fee sniping, la probabilidad de que uno de los mineros atacantes tenga éxito aumenta, y la probabilidad de que uno de los mineros honestos extienda la cadena disminuye en retorno. Si este ataque se lleva a cabo de manera masiva y sostenida en el tiempo, las confirmaciones de bloques ya no serían un indicador confiable de la inmutabilidad de una transacción Bitcoin. Esto podría potencialmente volver al sistema inutilizable.

Para contrarrestar este riesgo, la mayoría del software de billeteras llena automáticamente el campo `nLocktime` de modo que condiciona la validación de la transacción a la inclusión en la siguiente altura de bloque. Así, se vuelve imposible incluir la transacción en una reescritura del bloque anterior. Si el uso generalizado de `nLocktime` es adoptado por los usuarios de Bitcoin, reduce significativamente los incentivos para el fee sniping. De hecho, fomenta la progresión de la blockchain en lugar de su reescritura al reducir los beneficios potenciales de ello. Para las transacciones Taproot, BIP326 propone usar el campo `nSequence` de manera similar para lograr el efecto equivalente del campo `nLocktime` para otros tipos de transacciones. Este uso mataría dos pájaros de un tiro al mejorar también la privacidad de los protocolos de segunda capa que usan el mismo campo.