---
termo: ATAQUE DE DUPLA DESPESA (DOUBLE SPENDING)
---

Um ataque onde um usuário malicioso tenta usar o mesmo UTXO (*Unspent Transaction Output* - Saída de Transação Não Gasta) mais de uma vez para se enriquecer às custas das partes envolvidas nas transações. Em princípio, uma vez que uma transação é confirmada em um bloco e adicionada à blockchain, o uso desses bitcoins é permanentemente registrado, impedindo qualquer gasto adicional dos mesmos bitcoins. Prevenir a dupla despesa é até mesmo a principal utilidade da blockchain.

No contexto de um ataque de dupla despesa, o atacante primeiro realiza uma transação legítima com um comerciante, depois cria uma segunda transação concorrente gastando as mesmas moedas, seja enviando-as de volta para si mesmo para recuperar o montante ou usando-as para comprar outro bem ou serviço de um comerciante diferente.

Existem dois cenários principais que podem possibilitar esse ataque. O primeiro, e mais simples para o atacante, envolve executar a transação fraudulenta antes que a transação legítima seja incluída em um bloco. Para garantir que sua transação fraudulenta seja confirmada primeiro, o atacante associa taxas de transação significativamente mais altas a ela do que à transação legítima. Isso é uma espécie de RBF fraudulento. Esse cenário só é possível se o comerciante concordar em finalizar a venda em "zeroconf", ou seja, sem nenhuma confirmação para a transação de pagamento. É por isso que é fortemente recomendado esperar por várias confirmações antes de considerar uma transação como imutável. O segundo cenário, muito mais complexo, é o de um ataque de 51%. Se o atacante controlar uma parte significativa do poder computacional da rede, ele pode minerar uma cadeia concorrente à que contém a transação legítima, mas incluindo sua transação fraudulenta. Quando o comerciante aceitou a venda e o atacante conseguiu criar uma cadeia mais longa (com mais trabalho acumulado) do que a cadeia legítima, eles podem então transmitir sua cadeia fraudulenta, que será reconhecida pelos nós da rede como a válida.