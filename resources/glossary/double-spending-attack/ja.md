---
term: DOUBLE SPENDING (ATTACK)
---

二重支払い（攻撃）は、悪意のあるユーザーが同じUTXO（*未使用トランザクションアウトプット*）を複数回使用しようと試み、取引に関与する当事者の費用をかけて自分自身を豊かにしようとする攻撃です。原則として、トランザクションがブロックに確認され、ブロックチェーンに追加されると、そのビットコインの使用は永久に記録され、同じビットコインのさらなる支払いを防ぎます。二重支払いを防ぐことは、ブロックチェーンの主要な利用価値でさえあります。

二重支払い攻撃の文脈では、攻撃者はまず商人と合法的な取引を行い、次に同じコインを使って二番目の競合する取引を作成します。これは、自分自身にコインを送り返して金額を回収するか、別の商人から別の商品やサービスを購入するために使用するかのどちらかです。

この攻撃を可能にする主なシナリオは2つあります。最初のシナリオは、攻撃者にとって最も簡単で、合法的な取引がブロックに含まれる前に詐欺取引を実行することです。攻撃者は、合法的な取引よりもはるかに高い取引手数料を詐欺取引に関連付けることで、詐欺取引が最初に確認されるようにします。これは詐欺的なRBFの一種です。このシナリオは、商人が支払い取引の確認なしに「zeroconf」で販売を確定することに同意した場合にのみ可能です。これが、取引を不変と見なす前に複数の確認を待つことが強く推奨される理由です。二番目のシナリオ、はるかに複雑なのは、51%攻撃です。攻撃者がネットワークの計算能力の大部分を制御している場合、彼らは合法的な取引を含むチェーンに対抗するが、詐欺取引を含む競合するチェーンを採掘することができます。商人が販売を受け入れ、攻撃者が合法的なチェーンよりも長いチェーン（より多くの累積作業を含む）を作成することに成功した場合、彼らは詐欺的なチェーンを放送することができ、それはネットワークノードによって有効なものとして認識されます。