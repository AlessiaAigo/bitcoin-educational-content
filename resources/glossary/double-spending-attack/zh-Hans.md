---
term: 双重支付（攻击）
---

一种攻击，恶意用户试图将同一个UTXO（*未花费交易输出*）使用不止一次，以牺牲交易中涉及的各方为代价来丰富自己。原则上，一旦交易在区块中得到确认并添加到区块链上，这些比特币的使用就会被永久记录下来，防止同样的比特币被进一步花费。防止双重支付甚至是区块链的主要用途。

在双重支付攻击的上下文中，攻击者首先与商家进行合法交易，然后创建第二个竞争交易，使用相同的硬币，要么将它们发送回自己以恢复金额，要么使用它们从另一个商家购买另一种商品或服务。

有两种主要的情景可以使这种攻击成为可能。第一种，对攻击者来说最简单的情景，涉及在合法交易被包含在区块之前执行欺诈性交易。为了确保他们的欺诈性交易首先被确认，攻击者会为其关联显著更高的交易费用，而不是合法交易。这是一种欺诈性的RBF。只有当商家同意在“零确认”下完成销售时，即不对支付交易进行任何确认时，这种情景才可能发生。这就是为什么强烈建议在将交易视为不可更改之前等待多次确认的原因。第二种情景，更为复杂，是51%攻击。如果攻击者控制了网络大部分的计算能力，他们可以挖掘一个与包含合法交易的链竞争的链，但包括他们的欺诈性交易。当商家已接受销售并且攻击者成功创建了一个比合法链更长（具有更多累积工作量）的链时，他们就可以广播他们的欺诈性链，该链将被网络节点识别为有效链。