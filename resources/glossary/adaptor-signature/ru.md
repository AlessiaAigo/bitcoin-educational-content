---
term: ADAPTOR SIGNATURE
---

Криптографический метод, позволяющий сочетать подлинную подпись с дополнительной подписью (называемой "адапторной подписью"), чтобы раскрыть секретный элемент данных. Этот метод работает таким образом, что знание двух элементов среди действительной подписи, адапторной подписи и секрета позволяет вывести отсутствующий третий элемент. Одной из интересных особенностей этого метода является то, что если мы знаем адапторную подпись нашего контрагента и конкретную точку на эллиптической кривой, связанную с секретом, использованным для расчета этой адапторной подписи, мы можем затем вывести нашу собственную адапторную подпись, которая будет соответствовать тому же секрету, никогда не имея прямого доступа к самому секрету. В обмене между двумя сторонами, которые не доверяют друг другу, эта техника позволяет одновременно раскрыть два чувствительных элемента информации между участниками. Этот процесс устраняет необходимость в доверии при мгновенных транзакциях, таких как Coin Swap или Atomic Swap. Давайте рассмотрим пример для лучшего понимания. Алиса и Боб хотят отправить друг другу 1 BTC, но они не доверяют друг другу. Поэтому они будут использовать адапторные подписи, чтобы исключить необходимость в доверии к другой стороне в этом обмене (таким образом делая его "атомарным" обменом). Они действуют следующим образом:
* Алиса инициирует этот атомарный обмен. Она создает транзакцию $m_A$, которая отправляет 1 BTC Бобу. Она создает подпись $s_A$, которая подтверждает эту транзакцию, используя свой приватный ключ $p_A$ ($P_A = p_A \cdot G$), и используя nonce $n_A$ и секрет $t$ ($N_A = n_A \cdot G$ и $T = t \cdot G$): 
$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$
&nbsp;
* Алиса рассчитывает адапторную подпись $s_A'$ из секрета $t$ и своей реальной подписи $s_A$:  
$$s_A' = s_A - t$$
&nbsp;
* Алиса отправляет Бобу свою адапторную подпись $s_A'$, ее неподписанную транзакцию $m_A$, точку, соответствующую секрету $T$, и точку, соответствующую nonce $N_A$. Мы называем эти элементы информации "адаптором". Заметим, что только с этой информацией Боб не может восстановить BTC Алисы.
* Однако Боб может проверить, что Алиса его не обманывает. Для этого он проверяет, соответствует ли адапторная подпись Алисы обещанной транзакции $m_A$. Если следующее уравнение верно, то он убежден, что адапторная подпись Алисы действительна: 
$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
&nbsp;
* Эта проверка дает Бобу уверенность от Алисы, так что он может продолжить процесс атомарного свопа с душевным спокойствием. Затем он создаст свою собственную транзакцию $m_B$, отправляющую 1 BTC Алисе, и свою собственную адапторную подпись $s_B'$, которая будет связана с тем же секретом $t$, который пока знает только Алиса (Боб не знает этого значения $t$, но только его соответствующую точку $T$, которую Алиса ему предоставила): $$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$
&nbsp;
* Боб отправляет Алисе свою адаптерную подпись $s_B'$, его неподписанную транзакцию $m_B$, точку, соответствующую секрету $T$, и точку, соответствующую nonce $N_B$. Теперь Алиса может соединить адаптерную подпись Боба $s_B'$ с секретом $t$, который известен только ей, чтобы вычислить действительную подпись $s_B$ для транзакции $m_B$, которая отправляет ей BTC Боба: $$s_B = s_B' + t$$
&nbsp;
$$(s_B' + t) \cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B) \cdot P_B$$
&nbsp;
* Алиса транслирует эту подписанную транзакцию $m_B$ в блокчейне Bitcoin, чтобы восстановить BTC, которые Боб ей обещал. Боб узнает об этой транзакции в блокчейне. Таким образом, он может извлечь подпись $s_B = s_B' + t$. Из этой информации Боб может выделить знаменитый секрет $t$, который ему нужен был:
$$t = (s_B' + t) - s_B' = s_B - s_B'$$
&nbsp;
* Однако этот секрет $t$ был единственной недостающей информацией для Боба, чтобы произвести действительную подпись $s_A$, из адаптерной подписи Алисы $s_A'$, которая позволит ему подтвердить транзакцию $m_A$, отправляющую BTC от Алисы к Бобу. Затем он вычисляет $s_A$ и в свою очередь транслирует транзакцию $m_A$: $$s_A = s_A' + t$$
&nbsp;
$$(s_A' + t) \cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$