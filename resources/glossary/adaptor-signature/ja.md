---
term: アダプターシグネチャ
---

暗号学的手法で、正規の署名と追加の署名（「アダプターシグネチャ」と呼ばれる）を組み合わせて、秘密のデータ片を明らかにすることができます。この方法は、有効な署名、アダプターシグネチャ、秘密のうち2つを知っていることで、欠けている第3の要素を推測できるように動作します。この方法の興味深い特性の一つは、相手のアダプターシグネチャと、このアダプターシグネチャを計算するために使用された秘密に関連する楕円曲線上の特定の点を知っている場合、直接秘密自体にアクセスすることなく、同じ秘密に一致する自分自身のアダプターシグネチャを導出できることです。互いに信頼していない2つの関係者間の交換では、この技術により、参加者間で2つの機密情報を同時に明らかにすることができます。このプロセスは、コインスワップやアトミックスワップなどの即時取引における信頼の必要性を排除します。より良く理解するために例を挙げましょう。アリスとボブは互いに1BTCを送りたいと思っていますが、互いを信頼していません。したがって、彼らはアダプターシグネチャを使用して、この交換における他方への信頼の必要性を否定します（これにより、「アトミック」交換になります）。彼らは次のように進めます：
* アリスはこのアトミック交換を開始します。彼女は1BTCをボブに送るトランザクション$m_A$を作成します。彼女は自分の秘密鍵$p_A$（$P_A = p_A \cdot G$）、ノンス$n_A$、秘密$t$（$N_A = n_A \cdot G$および$T = t \cdot G$）を使用して、このトランザクションを検証する署名$s_A$を作成します：
$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$
&nbsp;
* アリスは秘密$t$と彼女の実際の署名$s_A$からアダプターシグネチャ$s_A'$を計算します：
$$s_A' = s_A - t$$
&nbsp;
* アリスはボブに彼女のアダプターシグネチャ$s_A'$、署名されていないトランザクション$m_A$、秘密$T$に対応する点、およびノンス$N_A$に対応する点を送ります。これらの情報を「アダプター」と呼びます。この情報だけでは、ボブはアリスのBTCを回復することができません。
* しかし、ボブはアリスが彼を欺いていないことを確認できます。これを行うために、彼はアリスのアダプターシグネチャ$s_A'$が約束されたトランザクション$m_A$と一致するかどうかを確認します。次の方程式が正しい場合、彼はアリスのアダプターシグネチャが有効であると確信します：
$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
&nbsp;
* この検証により、ボブはアリスから保証を得るため、安心してアトミックスワッププロセスを続けることができます。彼は次に、自分自身のトランザクション$m_B$を作成し、1BTCをアリスに送り、同じ秘密$t$にリンクされた自分自身のアダプターシグネチャ$s_B'$を作成します。この秘密$t$は今のところアリスだけが知っています（ボブはこの値$t$を知りませんが、アリスが彼に提供したその対応する点$T$のみを知っています）：$$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$
&nbsp;
* Bobは、彼のアダプターシグネチャ $s_B'$、署名されていないトランザクション $m_B$、秘密 $T$ に対応するポイント、およびノンス $N_B$ に対応するポイントをAliceに送ります。Aliceは今、Bobのアダプターシグネチャ $s_B'$ と、彼女だけが知っている秘密 $t$ を組み合わせて、BobのBTCを彼女に送るトランザクション $m_B$ に対する有効なシグネチャ $s_B$ を計算できます：$$s_B = s_B' + t$$
&nbsp;
$$(s_B' + t) \cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B) \cdot P_B$$
&nbsp;
* Aliceは、この署名されたトランザクション $m_B$ をBitcoinブロックチェーンにブロードキャストして、Bobが彼女に約束したBTCを回収します。Bobはブロックチェーン上のこのトランザクションを知り、シグネチャ $s_B = s_B' + t$ を抽出することができます。この情報から、Bobは彼に必要だった有名な秘密 $t$ を分離できます：
$$t = (s_B' + t) - s_B' = s_B - s_B'$$
&nbsp;
* しかし、この秘密 $t$ は、Aliceのアダプターシグネチャ $s_A'$ から有効なシグネチャ $s_A$ を生成するためにBobが欠けていた唯一の情報でした。これにより、彼はAliceからBobへのBTCを送るトランザクション $m_A$ を検証できます。彼は次に $s_A$ を計算し、トランザクション $m_A$ を順番にブロードキャストします：$$s_A = s_A' + t$$
&nbsp;
$$(s_A' + t) \cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$