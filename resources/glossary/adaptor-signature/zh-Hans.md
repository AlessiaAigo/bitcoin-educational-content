---
term: 适配器签名
---

加密方法，允许将一个真实的签名与一个额外的签名（称为“适配器签名”）结合起来，以揭示一个秘密数据片段。这种方法的工作方式是，如果知道有效签名、适配器签名和秘密中的两个元素，就可以推导出缺失的第三个元素。这种方法的一个有趣特性是，如果我们知道对方的适配器签名和与用于计算这个适配器签名的秘密相关的椭圆曲线上的特定点，我们就可以推导出自己的适配器签名，这个签名将与同一个秘密匹配，而无需直接访问到秘密本身。在两个不信任对方的利益相关者之间的交换中，这种技术允许参与者之间同时揭示两个敏感信息片段。这个过程消除了像币币交换或原子交换这样的即时交易中对信任的需求。让我们通过一个例子来更好地理解它。Alice和Bob想要相互发送1 BTC，但他们不信任对方。因此，他们将使用适配器签名来消除在这次交换中对另一方的信任需求（从而使其成为一个“原子”交换）。他们按照以下步骤进行：
* Alice启动这个原子交换。她创建了一个交易$m_A$，将1 BTC发送给Bob。她使用她的私钥$p_A$（$P_A = p_A \cdot G$），以及一个随机数$n_A$和一个秘密$t$（$N_A = n_A \cdot G$ 和 $T = t \cdot G$）创建了一个签名$s_A$，以验证这个交易：
$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$
&nbsp;
* Alice从秘密$t$和她的真实签名$s_A$计算出适配器签名$s_A'$：
$$s_A' = s_A - t$$
&nbsp;
* Alice向Bob发送她的适配器签名$s_A'$、未签名的交易$m_A$、对应于秘密$T$的点，以及对应于随机数$N_A$的点。我们称这些信息为“适配器”。注意，仅凭这些信息，Bob无法恢复Alice的BTC。
* 然而，Bob可以验证Alice没有欺骗他。为此，他检查Alice的适配器签名$s_A'$是否与承诺的交易$m_A$匹配。如果以下等式正确，那么他就相信Alice的适配器签名是有效的：
$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
&nbsp;
* 这种验证为Bob提供了来自Alice的保证，以便他可以放心地继续原子交换过程。他将创建自己的交易$m_B$，将1 BTC发送给Alice，以及他自己的适配器签名$s_B'$，这将与只有Alice目前知道的同一个秘密$t$相关联（Bob不知道这个值$t$，但只知道Alice提供给他的对应点$T$）：$$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$
&nbsp;
* 鲍勃向爱丽丝发送了他的适配器签名 $s_B'$、他的未签名交易 $m_B$、对应于秘密 $T$ 的点，以及对应于随机数 $N_B$ 的点。爱丽丝现在可以将鲍勃的适配器签名 $s_B'$ 与只有她知道的秘密 $t$ 结合起来，计算出有效的签名 $s_B$ 用于交易 $m_B$，该交易将鲍勃的比特币发送给她：$$s_B = s_B' + t$$
&nbsp;
$$(s_B' + t) \cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B) \cdot P_B$$
&nbsp;
* 爱丽丝在比特币区块链上广播这个已签名的交易 $m_B$，以恢复鲍勃承诺给她的比特币。鲍勃在区块链上得知了这笔交易。因此，他能够提取签名 $s_B = s_B' + t$。有了这个信息，鲍勃可以分离出他所需要的著名的秘密 $t$：
$$t = (s_B' + t) - s_B' = s_B - s_B'$$
&nbsp;
* 然而，这个秘密 $t$ 是鲍勃产生有效签名 $s_A$ 的唯一缺失信息，来自爱丽丝的适配器签名 $s_A'$，这将允许他验证交易 $m_A$，将一个比特币从爱丽丝发送给鲍勃。然后他计算 $s_A$ 并依次广播交易 $m_A$：$$s_A = s_A' + t$$
&nbsp;
$$(s_A' + t) \cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$