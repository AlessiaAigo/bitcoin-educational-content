---
term: ХЕШ-ФУНКЦИЯ
---

Математическая функция, которая принимает на вход данные переменной длины (называемые сообщением) и выдает результат фиксированной длины (называемый хешем, хешированием, дайджестом или отпечатком). Хеш-функции широко используются в криптографии как основные элементы. Они обладают специфическими свойствами, делающими их подходящими для использования в безопасных контекстах:
* Устойчивость к нахождению прообраза: должно быть очень сложно найти сообщение, которое производит определенный хеш, т.е. найти прообраз $m$ для хеша $h$ так, чтобы $h = H(m)$, где $H$ — это хеш-функция;
* Устойчивость ко второму прообразу: имея сообщение $m_1$, должно быть очень сложно найти другое сообщение $m_2$ (отличное от $m_1$), так чтобы $H(m_1) = H(m_2)$;
* Устойчивость к коллизиям: должно быть очень сложно найти два различных сообщения $m_1$ и $m_2$, так чтобы $H(m_1) = H(m_2)$;
* Устойчивость к изменениям: небольшие изменения во входных данных должны вызывать значительные и непредсказуемые изменения в выходных данных.

В контексте Bitcoin хеш-функции используются для нескольких целей, включая механизм доказательства работы (*Proof-of-Work*), идентификаторы транзакций, генерацию адресов, расчет контрольных сумм и создание таких структур данных, как деревья Меркла. На уровне протокола Bitcoin исключительно использует функцию `SHA256d`, также называемую `HASH256`, которая состоит из двойного хеширования `SHA256`. `HASH256` также используется при расчете определенных контрольных сумм, в частности для расширенных ключей (`xpub`, `xprv`...). На стороне кошелька также используются:
* Простой `SHA256` для контрольных сумм мнемонических фраз;
* `SHA512` в рамках алгоритмов `HMAC` и `PBKDF2`, используемых в процессе получения детерминированных и иерархических кошельков;
* `HASH160`, который описывает последовательное использование `SHA256` и `RIPEMD160`. `HASH160` используется в процессе генерации адресов для получения (за исключением P2PK и P2TR) и при расчете отпечатков родительских ключей для расширенных ключей.

> ► *На английском это называется "hash function".*