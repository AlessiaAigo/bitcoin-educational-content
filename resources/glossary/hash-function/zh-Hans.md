---
term: 哈希函数
---

哈希函数是一种数学函数，它接受一个可变大小的输入（称为消息）并产生一个固定大小的输出（称为哈希、散列、摘要或指纹）。哈希函数在密码学中被广泛使用。它们展示了特定的属性，使它们适用于安全环境：
* 原像抗性：找到一个产生特定哈希的消息应该非常困难，即找到一个原像$m$对于哈希$h$使得$h = H(m)$，其中$H$是哈希函数；
* 二次原像抗性：给定一个消息$m_1$，找到另一个消息$m_2$（与$m_1$不同）使得$H(m_1) = H(m_2)$应该非常困难；
* 碰撞抗性：找到两个不同的消息$m_1$和$m_2$使得$H(m_1) = H(m_2)$应该非常困难；
* 篡改抗性：输入的小变化必须导致输出的显著和不可预测的变化。

在比特币的上下文中，哈希函数用于多个目的，包括工作量证明机制（*Proof-of-Work*）、交易标识符、地址生成、校验和计算以及如Merkle树这样的数据结构的创建。在协议层面，比特币专门使用`SHA256d`函数，也称为`HASH256`，它由双重`SHA256`哈希组成。`HASH256`也用于计算某些校验和，特别是扩展密钥（`xpub`、`xprv`...）的计算。在钱包方面，还使用以下内容：
* 简单的`SHA256`用于助记词短语的校验和；
* `SHA512`在`HMAC`和`PBKDF2`算法中使用，这些算法用于派生确定性和分层钱包的过程；
* `HASH160`，描述了`SHA256`和`RIPEMD160`的连续使用。`HASH160`用于生成接收地址的过程（除P2PK和P2TR外）以及计算扩展密钥的父密钥指纹。

> ► *用英语，它被称为"hash function"。*